;---------------------
; chapter 0 page 0
;---------------------
S000    ldx   0         
	tma             
	a9aac           
	br    S03E      
S00F    tcmiy 8         
	tcy   0         
	br    S01B      
S03E    tcmiy 0         

;
; Rotate the drum to the position targeted in 4/0
; Current position is in 0/0
;
S03D    ldx   0         
	tcy   0         
	tma             
	ldx   4         
	mnea            
	br    S033      
	retn            

S033    ldp   1         
	call  L040      
	ldx   5         
	tcy   0         
	tma             
	ldx   1         
	alem            
	br    S018      
	br    S000      
S018    mnea            
	br    S01C      
	ldx   6         
	tma             
	ldx   2         
	alem            
	br    S01C      
	br    S000      
S01C    ldx   0         
	tma             
	a9aac           
	br    S00F      
	imac            
	tam             
S01B    ldx   6         
	tma             
	amaac           
	br    S011      
	ldx   2         
	tam             
	ldx   5         
	tma             
	br    S026      
S011    ldx   2         
	tam             
	ldx   5         
	imac            
	br    S00A      
S026    amaac           
	br    S00A      
	ldx   1         
	tam             
	br    S03D      
S00A    ldx   2         
	tcmiy 14        
	ldx   1         
	tcy   0         
	tcmiy 15        
	br    S03D      
	mnea            
;---------------------
; chapter 0 page 1
;---------------------
L040    tcy   8         
	setr            
	tcy   9         
	setr            
	ldx   6         
	tcy   0         
	tcmiy 0         
	ldx   5         
	tcy   0         
	tcmiy 0         
S077    tka             
	dan             
	br    S04E      
	br    S077      
S079    ldx   6         
	tcmiy 15        
	br    S071      
S04E    tcy   5         
	tya             
	tcy   8         
S075    dyn             
	br    S075      
	dan             
	br    S075      
	ldx   6         
	tcy   0         
	imac            
	br    S04B      
	br    S078      
S04B    tam             
	ldx   5         
	imac            
	br    S079      
S078    tam             
S071    tka             
	dan             
	br    S04E      
	tcy   8         
	rstr            
	tcy   9         
	rstr            
	retn            

;
; RANDOM routine continues
;
S074    tma             ; Pick up value at 3/0, 3/1, 3/2
	ldx   4         
	amaac           ; Add 4/0, 4/1, 4/2 to it
	call  S055      ; Increment 6/0, 6/1, 6/2 if carry
	ldx   5         
	amaac           ; Add 5/0, 5/1, 5/2 to it
	call  S055      ; Increment 6/0, 6/1, 6/2 if carry
	ldx   6         
	amaac           ; Add 6/0, 6/1, 6/2 to it
	call  S055      ; Increment 6/0, 6/1, 6/2 if carry
	ldx   3         
	tamiyc          ; Store it at 3/0, 3/1, 3/2
	ynec  3         
	br    S074      
	tcy   2         
	retn            

S055    iyc             
	ldx   6         
	xma             
	iac             
	ldp   7         
	br    L1D4      ; xma, dyn, retn
;---------------------
; chapter 0 page 2
;---------------------
S080    tcy   13        
	tam             
	a8aac           
	br    S09F      
	a8aac           
S09F    tay             
	setr            
	tka             
	rstr            
	tcy   14        
	xma             
	tbit1 0         
	br    S0AE      
	tbit1 3         
	br    S09C      
	tbit1 2         
	br    S0B8      
	tbit1 1         
	br    S0B1      
	a4aac           
	tam             
L0AB    tcy   13        
	dman            
	br    S0B0      
	br    S085      
S0B0    tay             
	ynec  7         
	br    S080      
S085    tcy   14        
	tma             
	br    S0B1      
S0AE    iac             
S09C    iac             
S0B8    iac             
S0B1    tcy   15        
	xma             
	mnea            
	br    S08A      
	tay             
	ynec  12        
	br    S091      
	tcy   13        
	sbit  3         
	tcy   12        
	tbit1 0         
	br    S08A      
	br    S089      
S091    tcy   12        
	tbit1 0         
	br    S099      
S089    cla             
	dan             
	ldp   10        
	br    L2A2      
S099    tcy   13        
	tbit1 3         
	br    S0AA      
S08A    ldp   7         
	br    L1C6      
S0AA    ldp   3         
	tpc             
	ldp   1         
	call  PLYTICK      
	br    S089      

;---------------------
; chapter 0 page 3
;---------------------
;********************************************************************************
; RANDOM - Generate a random number based on the seed at 3/0-3/2,
;          replacing the seed with the generated value.
;
;          Return value in A
;
; 3/0 * 2 -> 4/0 * 2 -> 5/1
; 3/1 * 2 -> 4/1 * 2 -> 5/2
; 3/2 * 2 -> 4/2
; 3/0 + 4/0 + 5/0 + 6/0 -> 3/0 using 6/0 as carry
; 3/1 + 4/1 + 5/1 + 6/1 -> 3/1 using 6/1 as carry
; 3/2 + 4/2 + 5/2 + 6/2 -> 3/2 using 6/2 as carry
;
;********************************************************************************
RANDOM  ldx   5         
	call  S0D5      ; Clear 5/0-2
	ldx   6         
	call  S0D5      ; Clear 6/0-2
	ldx   3         
	tcy   0         
	tma             ; Pick up value at 3/0
	amaac           ; Double it
	br    S0C9      ; Branch if it overflowed
	ldx   4         
	tam             ; Save it at 4/0
S0EF    amaac           ; Double it
	br    S0E9      ; Branch if it overflowed
	ldx   5         
	tcy   1         
	tam             ; Save doubled value at 5/1
S0E7    ldx   3         
	tma             ; Pick up value at 3/1
	amaac           ; Double it
	br    S0E3      ; Branch if it overflowed
	ldx   4         
	tam             ; Save doubled value at 4/1
S0D6    amaac           ; Double it
	ldx   5         
	tcy   2         
	tam             ; Save it at 5/2
	ldx   3         
	tma             ; Pick up value at 3/2
	amaac           ; Double it
	ldx   4         
	tam             ; Save it at 4/2
	ldx   3         
	tcy   0         
	ldp   1         
	br    S074      ; Out of room here...

S0E3    ldx   4         ; 3/1 doubling caused an overflow...
	tamiyc          ; Save doubled value at 4/1
	ldx   6         
	imac            
	tamdyn          ; Add one to 6/2
	ldx   4         
	tma             ; Pick up 4/1
	br    S0D6      ; Go back and deal with the next digit
S0E9    ldx   5         
	tcy   1         
	tamiyc          
	ldx   6         
	imac            
	tamdyn          
	br    S0E7      
S0C9    ldx   4         ; 3/0 doubling caused an overflow
	tamiyc          ; Save doubled value at 4/0
	ldx   6         
	tcmiy 1         ; Store a 1 at 6/1
	tcmiy 2         ; Store a 2 at 6/2
	ldx   4         
	tcy   0         
	br    S0EF      ; Go back and deal with the next digit
S0D5    tcy   0         
	tcmiy 0         
	tcmiy 0         
	tcmiy 0         
	retn            

	mnea            
;---------------------
; chapter 0 page 4
;---------------------
;********************************************************************************
; AD2B10 - Perform Base 10 arithmetic on values in scratchpad RAM 4/1-2 and 5/1-2
;
;          Add the two-digit base 10 number encoded in 4/1 and 4/2 to
;          the two-digit base 10 number encoded in 5/1 and 5/2 giving
;          a three-digit base-10 number encoded in 5/0, 5/1 and 5/2
;
;          For example:   0 1 2
;                       4 x 1 9
;                       5 x 2 2
;
;          Returns:       0 1 2
;                       4 x 1 9
;                       5 0 4 1
;********************************************************************************
AD2B10  ldx   5         
	tcy   0         
	tcmiy 0         ; 5/0 = 0
L107    ldx   4         
	tcy   0         
	tcmiy 0         ; 4/0 = 0
SUMB10  cla             ; SUMB10 - don't initialize 100s digit
	tcy   2         ; Start at 4/2 with A=0
;
; Perform (4/Y + 5/Y) mod 10
;
S13D    ldx   4         
	amaac           
	ldx   5         
	amaac           ; A = 4/Y + 5/Y (Y=2-0)
	br    S11D      ; Overflow?
	a6aac           ; Add 6 to Accumulator - (do a MOD 10 operation; is the result >= 10?)
	br    S13A      ; Yes

	a10aac          ; Add 10 to Accumulator - (effectively back out the A6AAC operation)
	tamza           ; Save to 5/Y (Y = 2-0)
	br    S12B      
S11D    a6aac           
S13A    tamza           
	iac             
S12B    dyn             
	br    S13D      
	tcy   0         
	retn            

L130    ldp   3         
	call  RANDOM    ; Get a random number in 3/0-2
	ldx   4         
	tcy   1         
	tcmiy 0         ; 4/1 = 0
	ldx   4         
	tamdyn          ; 4/2 = ACC
	ldx   5         
	tcmiy 0         ; 5/1 = 0
	tcmiy 0         ; 5/2 = 0
	ldp   4         
	call  AD2B10    
	ldx   4         
	tcy   1         
	tcmiy 1         ; 4/1 = 1
	tcmiy 7         ; 4/2 = 7
	ldp   4         
	br    AD2B10    

L129    ldp   3         
	call  RANDOM    
	ldx   4         
	tamdyn          
	tcmiy 0         
	rbit  3         
	ldx   5         
	tcy   1         
	tcmiy 0         ; 5/1 = 0
	tcmiy 9         ; 5/2 = 9
	call  AD2B10    
	ldp   1         
	tpc             
	ldp   12        
	br    CPY5TO4   

L115    ldx   4         
	tcy   1         
	tcmiy 1         ; 4/1 = 16
	tcmiy 6         
	ldp   4         
	br    AD2B10    
;---------------------
; chapter 0 page 5
;---------------------
;********************************************************************************
; DSPRSLT - Display the results of an encounter or inventory
;           Called after encounter as well as when Repeat button is hit
;********************************************************************************
DSPRSLT ldx   4         
	tcy   13        
	tbit1 0         ; Warrior change during encounter
	br    S173      
;
; Display Warrior count
;
	tcy   1         ; Switch drum to Warrior/Food/Beast position
	ldp   8         
	call  ROTDRUM   
	ldp   1         
	tpc             
	ldp   6         
	call  CPY2TO5   ; Copy the warrior count for current player to 5/1 and 5/2
	ldp   8         
	call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2
	ldp   9         
	call  L241      ; Light top window and update display from display buffer???

S173    ldx   4         
	tcy   13        
	tbit1 1         ; Food change during encounter
	br    S157      
;
; Display Food
;
	tcy   1         ; Switch drum to Warrior/Food/Beast position
	ldp   8         
	call  ROTDRUM   
	ldp   1         
	tpc             
	ldp   12        
	call  CPY1TO5   ; Copy the gold amount for current player to 5/1 and 5/2
	ldp   8         
	call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2
	ldp   9         
	call  L25F      

S157    ldx   4         
	tcy   13        
	tbit1 3         ; Beast found during encounter
	br    S152      
;
; Display Beast
;
	ldx   1         
	tcy   3         
	tbit1 0         ; Check inventory for Beast
	br    S176      
	br    S152      
S176    tcy   1         ; Switch drum to Warrior/Food/Beast position
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITELWR   ; Light lower window

S152    ldx   4         
	tcy   14        
	tbit1 0         ; Scout found during encounter
	br    S155      
;
; Display Scout
;
	ldx   1         
	tcy   3         
	tbit1 3         ; Check inventory for Scout
	br    S14C      
	br    S155      
S14C    tcy   2         ; Switch drum to Scout/Healer/Gold position
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITETOP   ; Light top window

S155    ldx   4         
	tcy   14        
	ldp   6         
	tbit1 1         ; Healer found during encounter?
	br    L1B7      
	br    S180

;---------------------
; chapter 0 page 6
;---------------------
;
; Display Healer
;
S180    ldx   1         
	tcy   3         
	tbit1 1         ; Check inventory for Healer
	br    S19F      
	br    L1B7      
S19F    tcy   2         ; Switch drum to Scout/Healer/Gold position
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITEMID   ; Light middle window

L1B7    ldx   4         
	tcy   13        
	tbit1 2         ; Gold found during encounter?
	br    S1B0      
;
; Display Gold
;
	tcy   2         ; Switch drum to Scout/Healer/Gold position
	ldp   8         
	call  ROTDRUM   
	ldp   1         
	tpc             
	ldp   12        
	call  CPY0TO5   
	ldp   8         
	call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2
	ldp   9         
	call  L27B      ; Light bottom window and update display from display buffer???

S1B0    ldx   4         
	tcy   15        
	tbit1 0         ; Gold Key found during encounter?
	br    S1B6      
;
; Display Gold Key
;
	ldx   2         
	tcy   3         
	tbit1 3         ; Check inventory for Gold Key
	br    S1B1      
	br    S1B6      
S1B1    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITETOP   ; Light top window

S1B6    ldx   4         
	tcy   14        
	tbit1 3         ; Silver Key found during encounter?
	br    S18C      
;
; Display Silver Key
;
	ldx   2         
	tcy   3         
	tbit1 2         ; Check inventory for Silver Key
	br    S1A2      
	br    S18C      
S1A2    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITEMID   ; Light middle window

S18C    ldx   4         
	tcy   14        
	ldp   7         
	tbit1 2         ; Brass Key found during encounter?
	br    L1DF      
;
; Display Brass Key
;
	ldx   2         
	tcy   3         
	tbit1 1         ; Check inventory for Brass Key
	br    L1C0      
	br    L1DF      
	mnea            
;---------------------
; chapter 0 page 7
;---------------------
L1C0    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITELWR   ; Light lower window

L1DF    ldx   4         
	tcy   15        
	tbit1 1         ; Sword resulting from encounter?
	br    S1FA      
;
; Display Sword if in inventory
;
	ldx   1         
	tcy   3         
	tbit1 2         ; Check inventory for Sword
	br    S1F9      
	br    S1FA      
S1F9    tcy   4         ; Switch drum to Dragon/Sword/Pegasus
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITEMID   ; Light middle window
;
; Display Pegasus?
;
S1FA    ldx   4         
	tcy   15        
	tbit1 2         ; Pegasus resulting from encounter?
	br    S1C5      

	tcy   4         ; Switch drum to Dragon/Sword/Pegasus
	ldp   8         
	call  ROTDRUM   
	ldp   9         
	call  LITELWR   ; Light lower window
S1C5    retn            

;********************************************************************************
; PROMPT - Prompt user for input
;
; Update display with contents of 7/14 and 7/15, flash and wait for keypress
;
; Return key pressed in Y:
;  0 = Yes/Buy          6 = Move
;  1 = Haggle           7 = Frontier
;  2 = Tomb/Ruin        8 = No/End
;  3 = Dark Tower       9 = Clear
;  4 = Repeat          10 = Sanctuary/Citadel
;  5 = Bazaar          11 = Inventory
;********************************************************************************
PROMPT  ldx   6         
	tcy   12        
	sbit  0         
	rbit  2         
L1F8    ldx   6         
	tcy   13        
	rbit  3         
L1C6    ldp   10        
	call  L280      
	ldp   10        
	call  L280      
	ldp   10        
	call  L280      
	ldx   3         
	tcy   2         
	tma             
	a7aac           
	call  S1CA      
	tam             
	ldx   6         
	tcy   13        
	rbit  2         
	sbit  1         
	sbit  0         
	tcy   14        
	tcmiy 0         
	ldp   2         
	br    L0AB      
S1CA    tamdyn          
	imac            
	retn            

L1D4    xma             
	dyn             
	retn            

	mnea            
;---------------------
; chapter 0 page 8
;---------------------
;********************************************************************************
; ROTPLYR - Rotate the player RAM buffer so the next player is in the first
;           position
;********************************************************************************
ROTPLYR ldx   0         ; Rotate 0/1-12 left three times
	call  S230      
	call  S230      
	call  S230      
	ldx   1         ; Rotate 1/1-12 left three times
	call  S230      
	call  S230      
	call  S230      
	ldx   2         ; Rotate 2/1-12 left three times
	call  S230      
	call  S230      
	call  S230      

	ldx   3         
	tcy   11        
	tma             ; Pick up the current player from 3/11
	a12aac          ; Add 12 to generate an overflow if we're on player 4
	br    S21D      ; Overflow, it's P0 right now
	a4aac           ; Add 4 to get us back to where we should be

S21D    iac             ; Next player...
	tam             ; Update current player at 3/11
	tcy   9         
	alem            ; Check that we're not exceeding the total number of players playing
	br    S218      ; We're done
	br    ROTPLYR   ; Oops.  Do another rotation

S218    retn            

;
; Rotate the current register file words 1-12 Left
;
S230    tcy   12        ; Start at 12
	tma             ; Get a copy of what's at the current position
	dyn             ; Move pointer left
S205    xma             ; Swap
	dyn             ; Move pointer left
	ynec  0         ; Are we pointing at zero?
	br    S205      ; Nope, do it again
	tcy   12        ; Final step, copy what was at 1
	tam             ; To 12
	retn            

L223    ldp   3         
	call  RANDOM    
L20D    tcy   1         
S21B    a5aac           
	br    S234      
	dyn             
	br    S21B      
S234    tya             
	iac             
	retn            

;********************************************************************************
; BUF2DSP - Load 5/1 and 5/2 into the display buffer 7/14 and 7/15 respectively
;********************************************************************************
BUF2DSP ldx   5         
	tcy   1         
	tma             
	ldx   7         
	tcy   14        
	tam             
	ldx   5         
	tcy   2         
	tma             
	ldx   7         
	tcy   15        
	tam             
	retn            

;********************************************************************************
; ROTDRUM - Rotate the drum to the position specified in Y
;********************************************************************************
ROTDRUM tya             
	ldx   4         
	tcy   0         
	tam             
	ldp   0         
	br    S03D      
;---------------------
; chapter 0 page 9
;---------------------
LITETOP call  S25A      
L241    call  S248      
	tcy   7         
	br    S26F      

LITEMID call  S25A      
L25F    call  S248      
	tcy   6         
	br    S26F      

LITELWR call  S25A      
L27B    call  S248      
	tcy   5         

S26F    setr            
	ldp   3         
	tpc             
	ldp   13        
	call  PLYBEEP   
L267    ldx   6         
	tcy   12        
	sbit  2         
	ldx   6         
	tcy   0         
	tcmiy 15        
	tcmiy 11        
S26C    tam             
	ldp   10        
	call  L280      
	ldx   6         
	tcy   0         
	dman            
	br    S26C      
	tamiyc          
	dman            
	br    S26C      
	tdo             
	tcy   7         
	rstr            
	tcy   6         
	rstr            
	tcy   5         
	rstr            
	retn            
;
; Load blanks into display buffer (7/14-15)
;
S25A    ldx   7         
	tcy   14        
	tcmiy 15        ; 7/14 = 15 (" ")
	tcmiy 15        ; 7/15 = 15 (" ")
	retn            

S248    ldx   6         
	tcy   12        
	sbit  2         
	retn            

;********************************************************************************
; CPYBRIG - Copy the current brigand count (3/12-13) to 5/1-2 for base 10 math
;********************************************************************************
CPYBRIG ldx   3         
	tcy   12        
	tma             
	ldx   5         
	tcy   1         
	tam             
	ldx   3         
	tcy   13        
	tma             
	ldx   5         
	tcy   2         
	tam             
	retn            

	mnea            
;---------------------
; chapter 0 page 10
;---------------------
L280    ldx   6         
	tcy   12        
	tbit1 2         
	br    S2A1      
	ldx   7         
	tcy   13        
	dman            
	br    S2AB      
	tamdyn          
	dman            
	br    S2AB      
	tcmiy 1         
	ldx   6         
	tcy   12        
	tbit1 1         
	br    S2BA      
	sbit  1         
	tdo             
	br    S29A      
S2BA    rbit  1         
	br    S2A1      
S2AB    tam             
	ldx   6         
	tcy   12        
	tbit1 1         
	br    S29A      
S2A1    tma             
	tay             
	a8aac           
	br    S2AE      
	tay             
S2AE    ynea            
	tcy   12        
	tam             
	ldx   7         
	tcy   14        
	a8aac           
	br    S2B6      
	tcy   15        
S2B6    tma             
	tdo             
S29A    tcy   15        
	tya             
S2A9    dyn             
	br    S2A9      
	dan             
	br    S2A9      
	retn            

L2A2    tdo             
	ldx   6         
	tcy   15        
	tmy             
	retn            

L28C    tcy   2         
S299    ldx   5         
	tma             
	ldx   7         
	tamdyn          
	br    S299      
	retn            

S294    tcmiy 10        
	tamiyc          
	br    L280      
	br    S294      
;---------------------
; chapter 0 page 11
;---------------------
ROL5BY6 call  S2DF      
	call  S2DF      
ROL5BY4 call  S2DF      
	call  S2DF      
ROL5BY2 call  S2DF      
S2DF    ldx   5         
	tcy   8         
	tma             
S2FD    dyn             
	xma             
	ynec  1         
	br    S2FD      
	tcy   8         
	tam             
	retn            

L2F3    tcy   2         
S2E7    ldx   7         
	tma             
	ldx   5         
	tamdyn          
	br    S2E7      
	retn            

L2D6    ldx   7         
	tcy   11        
	tma             
	a11aac          
	br    S2C5      
	a5aac           
S2C5    iac             
	tamdyn          
	call  S2EE      
S2EE    tma             
	dyn             
S2F8    xma             
	dyn             
	ynec  0         
	br    S2F8      
	tcy   10        
	tam             
	retn            

;
; Called during Bazaar visit
;
L2ED    ldp   3         
;
; Generate a random number from 0-9 and add it to 17
; Results in 5/1 and 5/2
;
	call  RANDOM    ; Generate a random number in A; return with Y=2
	ldx   4         
	tamdyn          ; 4/2 = ACC
	tcmiy 0         ; 4/1 = 0
	rbit  3         ; 4/2 = 4/2 & 0b0111
	ldx   5         
	tcy   1         
	tcmiy 1         ; 5/1 = 1
	tcmiy 7         ; 5/2 = 7
	ldp   4         
	call  AD2B10    

	ldp   1         
	tpc             
	ldp   12        
	br    CPY5TO4   
L2E5    ldx   3         
	tcy   1         
	ldp   14        
S2EA    tbit1 1         
	br    L3A6      
	br    S3AA      
	tka             
	tdo             
;---------------------
; chapter 0 page 12
;---------------------
;********************************************************************************
; SU2B10 - Perform Base 10 subtraction on values in scratchpad RAM 4/1-2 and 5/1-2
;
;          Subtract the two-digit base 10 number encoded in 4/1 and 4/2 from
;          the two-digit base 10 number encoded in 5/1 and 5/2 giving
;          a two-digit base-10 number encoded in 5/1 and 5/2
;
;          For example:   1 2
;                       4 1 9
;                       5 2 2
;
;          Returns:       1 2
;                       4 1 9
;                       5 0 3
;********************************************************************************
SU2B10  ldx   5         
	tcy   0         
	tcmiy 0         ; 5/0 = 0
L307    ldx   4         
S30F    tcy   0         
	tcmiy 0         ; 4/0 = 0
L33F    cla             
	tcy   2         
S33D    ldx   4         
	amaac           
	ldx   5         
	saman           ; A = 5/Y - 4/Y (Y = 2-0)
	br    S335      ; Branch if no borrow
	a10aac          
	tamza           ; 5/Y = A + 10
	iac             
S327    dyn             
	br    S33D      
	tcy   0         
	retn            

S335    tamza           
	br    S327      

L316    ldx   4         
	tcy   4         
	tam             ; 4/4 = A
	tcy   3         
	ldp   8         
	call  ROTDRUM   
	ldx   4         
	tcy   4         
	tma             ; A = 4/4
	ldp   9         
	a14aac          ; A = A + 14
	br    LITETOP   ; On overflow
	iac             
	br    S30F      
	br    S33D      
;
; Copy 5/1 and 5/2 to 3/12 and 3/13 - Brigand count for fight
; 
L30D    ldx   5         
	tcy   1         
	tma             ; A = 5/1
	ldx   3         
	tcy   12        
	tam             ; 3/12 = A
	ldx   5         
	tcy   2         
	tma             ; A = 5/2
	ldx   3         
	tcy   13        
	tam             ; 3/13 = A
	retn            

;
; Continue setting up for Level 4
;
S309    ldx   2         
	tam             ; 2/3 = 15 - Give player all keys and ??? about the frontier
	ldx   1         
	tamiyc          ; 1/3 = 15 - Give player all items (Sword, Scout, Healer, Beast)
	iyc             
	iyc             
	ynec  15        ; Have we done all players?
	br    S309      ; Nope, go back and do the next player
	ldx   5         
	tcy   14        
	tcmiy 2         ; 5/14 = 2 - First key?  2 = Gold?
	tcmiy 1         ; 5/15 = 1 - Second key? 1 = Silver?
	ldp   13        
	br    L36C      ; Carry on with game setup

;---------------------
; chapter 0 page 13
;---------------------
L340    ldx   3         
	tcy   14        
	tam             
	ldx   5         
	tcy   2         
	tma             
	ldx   3         
	tcy   15        
	tam             
	ldp   8         
	call  L223      
	ldx   5         
	tcy   14        
	tam             
S379    ldp   8         
	call  L223      
	ldx   5         
	tcy   14        
	mnea            
	br    S36B      
	br    S379      
S36B    tcy   15        
	tam             
;
; Game setup - Select number of players
;
L36C    ldx   7         
	tcy   14        
	tcmiy 12        ; 7/14 = 12 ("P")
	tcmiy 1         ; 7/15 = 1 ("1")
S342    ldp   7         
	call  PROMPT      
	ldx   7         
	ynec  8         ; Did they hit anything other than "No/End"?
	br    S36D      ; Yes, check to see if they hit "Yes/Buy"
	tcy   15        
	tma             ; Get the current player count from the display (7/15)
	a12aac          ; Add 12 (overflow to 0 if it's 4)
	br    S34D      ; It overflowed...
	a4aac           ; It didn't overflow, add 4 to get it back to the original value
S34D    iac             ; Add one player
	tam             ; Update display
	br    S342      

S36D    ynec  0         ; Did they hit anything other than "Yes/Buy"?
	br    S342      ; Yes.  Prompt again
	tcy   15        ; They hit "Yes/Buy"
	tma             ; Pick up the player count from the display (7/15)
	ldx   3         
	tcy   9         
	tam             ; Save the player count in 3/9
	ldp   3         
	tpc             
	ldp   0         
	call  PLYTHEM      
	ldp   1         
	tpc             
	ldp   0         
	br    L417      
;
; Set the game up for Level 4 play
;
L4INIT  ldx   3         
	tcy   14        
	tcmiy 1         ; 3/14 = 1 (Dark tower brigand count 10s digit)
	tcmiy 6         ; 3/15 = 6 (Dark tower brigand count 1s digit)
	cla             
	dan             
	tcy   3         
	ldp   12        
	br    S309      
;---------------------
; chapter 0 page 14
;---------------------
;********************************************************************************
; Initialize player inventory information for new game (continued)
;********************************************************************************
L380    ldp   15        
	ynec  13        ; On to next player; done with all 4 players?
	br    L3E5      ; No, fill in the next player

	ldx   3         
	tcy   0         
	tcmiy 1         ; 3/0 = 1
	tcmiy 2         ; 3/1 = 2
	tcmiy 4         ; 3/2 = 4
	tcmiy 0         ; 3/3 = 0
	tcmiy 0         ; 3/4 = 0
	tcmiy 0         ; 3/5 = 0
	tcmiy 2         ; 3/6 = 2
	tcmiy 0         ; 3/7 = 0
	tcmiy 6         ; 3/8 = 6
	tcy   11        
	tcmiy 0         ; 3/11 = 0
;
; Handle level selection
;
	ldx   7         
	tcy   14        ; Reference display 10s digit (7/14)
	tcmiy 13        ; 7/14 = 13 ("L")
	tcmiy 1         ; 7/15 = 1 ("1")
S3B5    ldp   7         
	call  PROMPT    ; Display flashing "L1" and wait for keypress
	ldx   7         
	ynec  8         ; Did user hit "No"?
	br    S3B8      ; Nope, they hit something else.  This is the level they want to play
	tcy   15        
	tma             ; Pick up the currently selected level
	a12aac          ; Add 12 to see if there's an overflow
	br    S397      ; There was, ACC is now 0
	a4aac           ; Nope, add four more effectively doing a MOD 4
S397    iac             ; Increment ACC to select next level
	tam             ; Update 1s digit on display
	br    S3B5      
S3B8    ynec  0         ; Did the user hit "Yes"?
	br    S3B5      ; Nope, go prompt again at the same level
	tcy   15        ; Pick up the level selected
	tma             ; and store it in the Accumulator
	ldp   13        
	a12aac          ; Add 12 to accumulator (See if it's level 4)
	br    L4INIT    ; Handle Level 4 separately (special conditions--see manual page 39)
	ldp   4         
	call  L130      
	ldx   7         
	tcy   15        
	tma             
	ldp   11        
	a13aac          
	br    L2E5      
	ldp   14        
	iac             
	br    L3A6      
	br    S3AA      
L3A6    ldx   3         
	tcy   1         
	ldp   4         
	tbit1 0         
	call  L115      
	ldp   4         
	call  L115      
S3AA    ldx   5         
	tcy   1         
	tma             
	ldp   13        
	br    L340      
;---------------------
; chapter 0 page 15
;---------------------
;********************************************************************************
; INIT - Called on power-up
;********************************************************************************
INIT    tcy   0         
S3C1    ldx   0         
	tka             
	ynea            
	tdo             
	tay             
	setr            
	rstr            
	knez            
	br    S3C1      
	ldx   7         
	tcy   14        ; Reference display 10s digit
	tcmiy 14        ; 7/14 = 14 ("-")
	tcmiy 14        ; 7/15 = 14 ("-")
	ldp   7         
	call  PROMPT    ; Display flashing "--" and wait for keypress
	ldp   1         
	call  L040      

	ldx   0         
	tcy   0         
	tcmiy 8         ; 0/0 = 8 - Last display position 8=unknown?
	ldx   1         
	tcy   0         
	tcmiy 15        ; 1/0 = 15
	ldx   2         
	tcy   0         
	tcmiy 15        ; 2/0 = 15
	tcy   0         
	ldp   8         
	call  ROTDRUM   ; Cycle display to position 0 - on return, 0/0=0; 1/0=4; 2/0=12
	ldx   7         
	tcy   14        ; Reference display 10s digit
	tcmiy 8         ; 7/14 = 8 ("8")
	tcmiy 8         ; 7/15 = 8 ("8")
	ldp   9         
	call  L241      ; Display 88, light top display light and beep
	ldp   9         
	call  L25F      ; Light middle display light and beep
	ldp   9         
	call  L27B      ; Light lower display light and beep
;********************************************************************************
; Initialize player inventory information for new game
;********************************************************************************
L3ED    ldx   0         
	tcy   1         ; X = 0, Y = 1 - Player 1 Gold and ???
S3F4    tcmiy 3         ; Set Gold 10s to 3
	tcmiy 0         ; Set Gold 1s to 0
	tcmiy 2         ; Set ??? to 2
	ynec  13        ; On to next player; done with all 4 players?
	br    S3F4      ; No, fill in the next player

	ldx   1         ; X = 1, Y = 1 - Player 1 Food and inventory pt 1
	tcy   1         
S3C4    tcmiy 2         ; Set Food 10s to 2
	tcmiy 5         ; Set Food 1s to 5
	tcmiy 0         ; Set Inventory pt 1 to 0 (No Sword - 1000, Scout - 0100, Healer - 0010, Beast - 0001)
	ynec  13        ; On to next player; done with all 4 players?
	br    S3C4      ; No, fill in the next player

	ldx   2         ; X = 2, Y = 1 - Player 1 Warriors and inventory pt 2
	tcy   1         
L3E5    tcmiy 1         ; Set Warriors 10s to 1
	tcmiy 0         ; Set Warriors 1s to 0
	tcmiy 0         ; Set Inventory pt 2 to 0 (No Gold key - 1000, No Silver key - 0100, No Brass key - 0010, ??? - 0001)
	ldp   14        
	br    L380      ; Ran out of ROM in this page...
S3E8    tamiyc          
	tya             
	br    S3E8      
;---------------------
; chapter 1 page 0
;---------------------
;
; Main gameplay loop?
;
L400    ldp   3         
	tpc             
	ldp   13        
	call  PLYBEEP   
;
; Prompt for player EOT
;
S40F    ldx   3         
	tcy   11        
	tma             ; Pick up current player
	ldx   7         
	tcy   14        
	tcmiy 14        ; 7/14 = 14 ("-")
	tam             ; 7/15 = Current Player
	ldp   0         
	tpc             
	ldp   7         
	call  PROMPT    ; Update display from 7/14-15 and wait for keypress
	ynec  4         ; Did they hit Repeat (4)?
	br    S435      ; Nope...
;
; Player hit Repeat
;
	ldp   12        
	call  L709      
	br    S40F      

S435    ynec  9         ; Did they hit Clear (9)?
	br    S418      ; Nope...
;
; Player hit Clear
;
	ldp   1         
	br    L458      

S418    ynec  8         ; Did they hit No/END
	br    S40F      ; Nope, go back and prompt again
	ldp   3         
	tpc             
	ldp   3         
	call  PLAYEOT      
;
; Begin next player's turn
;
L417    ldx   4         
	tcy   12        
	rbit  0         
	ldp   0         
	tpc             
	ldp   8         
	call  ROTPLYR   
	a14aac          
	br    S426      
	ldp   14        
	call  L79B      
	ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   14        
	call  L79B      
;
; Update display with current player
;
S426    ldx   3         
	tcy   11        
	tma             ; Pick up current player from 3/11
	ldx   7         
	tcy   14        
	tcmiy 15        ; 7/14 = 15 (" ")
	ldp   1         
	br    L440      
L414    ldx   4         
	tcy   12        
	sbit  0         
	br    S426      

;---------------------
; chapter 1 page 1
;---------------------
L440    tam             
;
; Get player move
;
S441    ldp   0         
	tpc             
	ldp   7         
	call  PROMPT      
;
; Process input
;
; First, handle non-move buttons.  Either invalid keys or Clear
;
	ynec  0         ; Did they hit Yes/Buy?
	br    S47D      ; Nope
	br    S441      ; Yes - Error; prompt again

S47D    ynec  8         ; Did they hit No/End?
	br    S46F      ; Nope
	br    S441      ; Yes - Error; prompt again

S46F    ynec  4         ; Did they hit Repeat?
	br    S479      ; Nope
	br    S441      ; Yes - Error; prompt again

S479    ynec  1         ; Did they hit Haggle?
	br    S44E      ; Nope
	br    S441      ; Yes - Error; prompt again

S44E    ynec  9         ; Did they hit Clear?
	br    S444      ; Nope
	ldx   4         
	tcy   12        
	tbit1 0         
	br    L458      
	br    S441      ; Prompt again
;
; Handle player hitting Clear to clear up an illegal move
;
L458    ldx   0         
	call  S446      
	ldx   1         
	call  S446      
	ldx   2         
	call  S446      
	ldp   3         
	tpc             
	ldp   14        
	call  PLYCLR    
	ldp   0         
	br    L417      

S446    tcy   13        
	tma             
	tcy   1         
	tam             
	tcy   14        
	tma             
	tcy   2         
	tam             
	tcy   15        
	tma             
	tcy   3         
	tam             
	retn            
;
; Player has hit a button to make a move of some sort
; First, initialize the encounter results in 4/13-15 to F
S444    ldx   4         
	tcy   13        
	tcmiy 15        ; 4/13 = 0b1111
	tcmiy 15        ; 4/14 = 0b1111
	tcmiy 15        ; 4/15 = 0b1111
	ldx   0         
	tcy   3         
	ldp   2         
	tbit1 1         
	br    L4B7      

	ldx   4         
	tcy   13        
	tcmiy 10        ; 4/13 = 0b1010
	ldp   9         
	br    L66A      

;---------------------
; chapter 1 page 2
;---------------------
L480    tcy   7         
	setr            
	ldp   3         
	tpc             
	ldp   0         
	call  LC13      
	tcy   7         
	rstr            
	ldp   12        
	call  L709      
;
; Determine how much food the warriors consumed this turn
;
; 15 Warriors or less consume 1 food per turn
; 16-30 Warriors consume 2 per turn
; 31-45 Warriors consume 3 per turn, etc.
;
L4B7    ldp   6         
S4AF    call  CPY2TO5   ; Copy current player Warrior count to 5/1-2
	ldx   4         
	tcy   1         
	tcmiy 1         ; 4/1 = 1
	tcmiy 6         ; 4/2 = 6 - Start by subtracting 15
	tcmiy 2         ; 4/3 = 2 - contains the amount of food consumed
;
; Loop through, repeatedly subtracting until there's a borrow.  Basically, divide by 15 (kind of, as the first iteration was 16)
;
S48E    ldp   12        
	call  SUBB10    ; Subtract value in row 4 from Warrior count - first time 16; afterward 15
	mnez            ; Was there a borrow in the subtraction routine?  (5/0 will be 9)
	br    S48B      ; Yes.  We're done
;
; No borrow, add one food to counter and set up to subtract 15 more warriors
;
	ldx   4         
	tcy   3         
	imac            
	tam             ; Increment 4/3 - We had no borrow so add another food consumed this round
	ldx   4         
	tcy   2         
	tcmiy 5         ; 4/2 = 5 - Subtract 15 on the second and subsequent iterations
	br    S48E      ; Subtract again
;
; There was a borrow.  4/3 has how much food was consumed + 1
;
S48B    ldx   1         
	tcy   3         
	tbit1 0         ; Beast in player inventory?
	ldx   4         
	dman            ; Pick up 4/3 and subtract 1
	tam             ; Save corrected food consumed
;
; Set up to subtract food consumed from food inventory
;
	ldx   4         
	tma             ; Pick up food consumed (again?)
	tcy   1         
	tcmiy 0         ; 4/1 = 0
	tam             ; Store food consumed in 4/2
	ldp   12        
	call  CPY1TO5   ; Copy current player Food count to 5/1-2
	ldp   12        
	call  SUBB10    ; Subtract food consumed from food count
	mnez            ; Was there a borrow during subtraction?
	call  S494      ; Yep.  We're out of food; deal with it

	ldp   10        
	call  L6A4      
	ldx   5         
	tcy   0         
	ldp   3         
	mnez            
	br    L4C0      
	ldx   4         
	tcy   3         
	tma             
	tcy   1         
	tcmiy 0         
	tamdyn          
	br    S4AF      
S494    tcy   1         
	tcmiy 0         
	tcmiy 0         
	retn            

;---------------------
; chapter 1 page 3
;---------------------
L4C0    ldx   4         
	tcy   1         
	tcmiy 0         ; 4/1 = 0
	tcmiy 1         ; 4/2 = 1
	ldp   5         
	call  L540      
	ldp   3         
	tpc             
	ldp   11        
	call  PLYPLAG   
	br    S4F8      
	ldx   5         
	tcmiy 0         
	tam             
	ldp   12        
	call  ADDB10    
	ldp   12        
	call  CPY5TO4   
	ldp   12        
	call  ADDB10    
	ldp   12        
	call  CPY5TO4   
	ldp   12        
	call  CPY1TO5   
	ldp   12        
	call  SUBB10    
	mnez            
	br    S4CB      
	br    S4F8      
S4CB    ldp   3         
	tpc             
	ldp   14        
	call  PLWFOOD   
S4F8    ldx   0         ; Save current player information into save buffer
	call  S4D3      
	ldx   1         
	call  S4D3      
	ldx   2         
	call  S4D3      
	ldx   0         
	tcy   3         
	tbit1 1         
	br    S4C8      
	sbit  1         
	ldp   0         
	br    S40F      
S4C8    ldx   6         
	tcy   15        
	tmy             
	ldp   4         
	br    L500      

S4D3    tcy   1         ; Copy X/1 to X/13
	tma             
	tcy   13        
	tam             
	tcy   2         ; Copy X/2 to X/14
	tma             
	tcy   14        
	tam             
	tcy   3         ; Copy X/3 to X/15
	tma             
	tcy   15        
	tam             
	retn            

;---------------------
; chapter 1 page 4
;---------------------
L500    ynec  6         
	br    S50F      
	ldp   7         
	br    L5C0      
S50F    ynec  10        
	br    S53D      
	ldp   12        
	br    L719      
S53D    ynec  7         
	br    S523      
	ldp   3         
	tpc             
	ldp   8         
	call  PLYFRNT   
	ldx   2         
	tcy   3         
	tbit1 0         
	br    S52B      
	sbit  0         
S53A    ldp   0         
	br    S40F      
S52B    imac            
	br    S53A      
	tcy   5         
	ldp   10        
	call  ROTDRM2   
	tcy   5         
	setr            
L505    ldp   3         
	tpc             
	ldp   11        
	call  PLYFAIL   
	tcy   5         
	rstr            
	br    S53A      
S523    ynec  11        
	br    S529      
	ldx   4         
	tcy   13        
	tcmiy 0         
	tcmiy 0         
	ldp   12        
	br    L70D      
S529    tya             
	ldx   0         
	tcy   3         
	rbit  0         
	tay             
	ynec  2         
	br    S519      
	ldp   2         
	tpc             
	ldp   3         
	br    L8D9      
S519    ynec  5         
	br    S514      
	ldp   2         
	tpc             
	ldp   10        
	br    LA98      
S514    ldp   2         
	tpc             
	ldp   10        
	br    LAA7      
;---------------------
; chapter 1 page 5
;---------------------
L540    ldp   6         
	call  CPY2TO5   
	ldp   12        
	call  SUBB10    
	ldp   12        
	call  CPY5TO2   
	ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	ldp   0         
	tpc             
	ldp   12        
	call  L307      
	mnez            
	br    S56C      
S567    ldp   6         
	br    L5BB      
S55D    ldx   2         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	br    S567      
S56C    ldx   3         
	tcy   9         
	tma             
	a14aac          
	br    S55D      
	tcy   6         
	ldp   10        
	call  ROTDRM2   
	tcy   6         
	setr            
	ldp   3         
	tpc             
	ldp   11        
	call  PLYPLAG   
	tcy   6         
	rstr            
	ldx   5         
	tcy   1         
	tcmiy 0         
	tcmiy 0         
L569    ldp   0         
	tpc             
	ldp   8         
	call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2
	ldp   14        
	br    L7B2      
L544    ldp   12        
	call  CPY0TO5   
	ldp   12        
	call  SUBB10    
	mnez            
	call  S54A      
	ldp   12        
	br    CPY5TO0   
S54A    tcy   1         
	tcmiy 0         
	tcmiy 0         
	retn            

	tma             
	tdo             
	iyc             
;---------------------
; chapter 1 page 6
;---------------------
L580    ldp   12        
	call  CPY0TO5   
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   12        
	call  CPY5TO0   
L5BB    ldp   6         
	call  CPY2TO5   
	ldp   12        
	call  CPY5TO4   
	ldp   12        
	call  ADDB10    
	ldp   12        
	call  CPY5TO4   
	ldp   0         
	tpc             
	ldp   4         
	call  SUMB10    
	ldp   0         
	tpc             
	ldp   4         
	call  SUMB10    
	ldx   1         
	tcy   3         
	tbit1 0         
	br    S588      
S58B    ldx   5         
	tcy   0         
	mnez            
	br    S5A4      
	ldp   12        
	call  CPY5TO4   
	ldp   12        
	call  CPY0TO5   
	ldp   12        
	call  SUBB10    
	mnez            
	br    S5A4      
	ldp   10        
	call  CPY4TO5   
	ldp   12        
	call  CPY5TO0   
S5A4    retn            

S588    ldx   4         
	tcy   1         
	tcmiy 5         
	tcmiy 0         
	ldp   0         
	tpc             
	ldp   4         
	call  L107      
	br    S58B      

;********************************************************************************
; CPY2TO5 - Copy 2/2-0 to 5/2-0
;********************************************************************************
CPY2TO5 tcy   2         
S5A5    ldx   2         
	tma             
	ldx   5         
	tamdyn          
	br    S5A5      
	retn            

	mnea            
	mnea            
;---------------------
; chapter 1 page 7
;---------------------
L5C0    ldp   0         
	tpc             
	ldp   3         
	call  RANDOM    
	a13aac          
	br    S5C6      
	tcy   7         
	ldp   10        
	call  ROTDRM2   
	ldx   1         
	tcy   3         
	tbit1 3         
	br    S5EC      
	tcy   6         
	setr            
	ldp   3         
	tpc             
	ldp   11        
	call  PLYFAIL   
	tcy   6         
	rstr            
	ldp   0         
	br    S40F      
S5EC    ldp   0         
	tpc             
	ldp   9         
	call  LITEMID   
	tcy   2         
	ldp   10        
	call  ROTDRM2   
	ldp   0         
	tpc             
	ldp   9         
	call  LITETOP   
	ldp   0         
	br    L414      
S5C6    ldp   9         
	a14aac          
	br    L65D      
	tcy   4         
	ldp   10        
	call  ROTDRM2   
	tcy   7         
	setr            
	ldp   3         
	tpc             
	ldp   9         
	call  PLYDRGN   
	tcy   7         
	rstr            
	ldx   1         
	tcy   3         
	ldp   8         
	tbit1 2         
	br    L617      
	ldp   12        
	call  CPY0TO5   
	ldp   10        
	call  CPY4TO5   
	ldp   11        
	call  L6C0      
	ldp   8         
	br    L600      
	mnea            
;---------------------
; chapter 1 page 8
;---------------------
L600    ldp   11        
	call  L6F6      
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   11        
	call  L6F6      
	ldp   5         
	call  L544      
	ldp   6         
	call  CPY2TO5   
	ldp   10        
	call  CPY4TO5   
	ldp   11        
	call  L6C0      
	ldp   10        
	call  L680      
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   10        
	call  L680      
	ldp   5         
	call  L540      
	ldp   9         
	br    L66F      
L617    rbit  2         
	tcy   6         
	setr            
	ldp   3         
	tpc             
	ldp   9         
	call  PLYDSWD   
	tcy   6         
	rstr            
	ldx   3         
	tcy   5         
	tma             
	ldx   4         
	tcy   1         
	tam             
	ldx   3         
	tcy   6         
	tma             
	ldx   4         
	tcy   2         
	tam             
	ldp   10        
	call  L686      
	ldx   3         
	tcy   7         
	tma             
	ldx   4         
	tcy   1         
	tam             
	ldx   3         
	tcy   8         
	tma             
	ldp   9         
	br    L640      
;---------------------
; chapter 1 page 9
;---------------------
L640    ldx   4         
	tcy   2         
	tam             
	ldp   6         
	call  L580      
	ldx   3         
	tcy   5         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 6         
L66F    ldx   4         
	tcy   13        
	tcmiy 10        
L679    ldp   12        
	call  L709      
	ldp   0         
	br    S40F      
L65D    ldp   11        
	a13aac          
	br    L6E5      
	tcy   7         
	ldp   10        
	call  ROTDRM2   
	ldx   1         
	tcy   3         
	tbit1 1         
	br    S652      
	tcy   5         
	setr            
	ldp   3         
	tpc             
	ldp   11        
	call  PLYPLAG   
	tcy   5         
	rstr            
	ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 2         
	ldp   5         
	call  L540      
	ldp   10        
	br    L6B2      
S652    ldp   0         
	tpc             
	ldp   9         
	call  LITELWR   
	tcy   2         
	ldp   10        
	call  ROTDRM2   
	ldp   0         
	tpc             
	ldp   9         
	call  LITEMID   
	ldx   4         
	tcy   1         
	ldp   15        
	br    L7E5      
L66A    tcy   7         
	ldp   10        
	call  ROTDRM2   
	ldp   2         
	br    L480      
;---------------------
; chapter 1 page 10
;---------------------
L680    ldx   3         
	tcy   5         
	tma             
	ldx   5         
	tcy   1         
	xma             
	ldx   3         
	tcy   5         
	tamiyc          
	tma             
	ldx   5         
	tcy   2         
	xma             
	ldx   3         
	tcy   6         
	tam             
	retn            

L68E    ldp   12        
	call  CPY1TO5   
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   10        
	call  L6A4      
	retn            

;********************************************************************************
; CPY4TO5 - Copy 4/2-0 to 5/2-0
;********************************************************************************
CPY4TO5 ldx   4         
	tcy   2         
S68B    tma             
	ldx   5         
	xma             
	ldx   4         
	tamdyn          
	br    S68B      
	retn            

L686    ldp   6         
	call  CPY2TO5   
	ldp   12        
	call  ADDB10    
	ldp   14        
	mnez            
	call  L7B1      
	ldp   12        
	br    CPY5TO2   
L6A4    tcy   2         
S688    ldx   5         
	tma             
	ldx   1         
	tamdyn          
	ynec  0         
	br    S688      
	retn            

L68C    ldp   10        
	call  L686      
L6B2    ldx   4         
	tcy   13        
	rbit  0         
	ldp   9         
	br    L679      

ROTDRM2 ldp   0         
	tpc             
	ldp   8         
	br    ROTDRUM   
;---------------------
; chapter 1 page 11
;---------------------
L6C0    ldx   4         
	tcy   2         
	tma             
	sbit  0         
	sbit  1         
	tbit1 2         
	br    S6FD      
	rbit  0         
S6FD    tbit1 3         
	br    S6EF      
	rbit  1         
S6EF    rbit  2         
	rbit  3         
	tcy   1         
	tbit1 0         
	br    S6F1      
S6E7    tbit1 1         
	br    S6CB      
S6DD    sbit  0         
	sbit  1         
	tbit1 2         
	br    S6EC      
	rbit  0         
S6EC    tbit1 3         
	br    S6E1      
	rbit  1         
S6E1    rbit  2         
	rbit  3         
	retn            

S6CB    tcy   2         
	tma             
	a5aac           
	tamdyn          
	br    S6DD      
S6F1    tcy   2         
	tma             
	a2aac           
	tamdyn          
	br    S6E7      
L6F6    ldx   3         
	tcy   7         
	tma             
	ldx   5         
	tcy   1         
	xma             
	ldx   3         
	tcy   7         
	tamiyc          
	tma             
	ldx   5         
	tcy   2         
	xma             
	ldx   3         
	tcy   8         
	tam             
	retn            

L6E5    ldp   0         
	a13aac          
	br    L400      
	ldp   2         
	tpc             
	ldp   4         
	br    L937      
	mnea            
;---------------------
; chapter 1 page 12
;---------------------
;********************************************************************************
; CPY5TO2 - Copy 5/2-0 to 2/2-0
;********************************************************************************
CPY5TO2 tcy   2         
S701    ldx   5         
	tma             
	ldx   2         
S70F    tamdyn          
	ynec  0         
	br    S701      
	retn            

;********************************************************************************
; CPY5TO0 - Copy 5/2-0 to 0/2-0
;********************************************************************************
CPY5TO0 tcy   2         
S73B    ldx   5         
	tma             
	ldx   0         
	tamdyn          
	ynec  0         
	br    S73B      
	retn            

;********************************************************************************
; CPY5TO4 - Copy 5/2-0 to 4/2-0
;********************************************************************************
CPY5TO4 tcy   2         
S70E    ldx   5         
	tma             
	ldx   4         
	tamdyn          
	br    S70E      
	retn            

;********************************************************************************
; CPY1TO5 - Copy 1/2-0 to 5/2-0
;********************************************************************************
CPY1TO5 tcy   2         
S718    ldx   1         
	tma             
	ldx   5         
	tamdyn          
	br    S718      
	retn            

;********************************************************************************
; CPY0TO5 - Copy 0/2-0 to 5/2-0
;********************************************************************************
CPY0TO5 tcy   2         
S72E    ldx   0         
	tma             
	ldx   5         
	tamdyn          
	br    S72E      
	retn            

;********************************************************************************
; 
;********************************************************************************
L70D    tcmiy 12        
	ldp   12        
	call  L709      
	ldp   0         
	br    S40F      

;********************************************************************************
; ADDB10 - Call the actual Add Base 10 routine (AD2B10)
;********************************************************************************
ADDB10  ldp   0         
	tpc             
	ldp   4         
	br    AD2B10    

;********************************************************************************
; SUBB10 - Call the actual Subtract Base 10 routine (SU2B10)
;********************************************************************************
SUBB10  ldp   0         
	tpc             
	ldp   12        
	br    SU2B10    

;********************************************************************************
; 
;********************************************************************************
L709    ldp   0         
	tpc             
	ldp   5         
	br    DSPRSLT   

L719    ldp   3         
	tpc             
	ldp   5         
	call  PLYSANC      
	ldx   2         
	tcy   3         
	ldp   13        
	imac            
	br    L740      
	br    L74F      
;---------------------
; chapter 1 page 13
;---------------------
L740    ldx   0         
	tbit1 0         
	br    S759      
	sbit  0         
L74F    ldp   6         
	call  CPY2TO5   
	ldx   4         
	tcy   1         
	tcmiy 9         
	tcmiy 5         
	ldp   12        
	call  ADDB10    
	mnez            
	br    S757      
	ldp   0         
	tpc             
	ldp   3         
	call  RANDOM    
	ldx   4         
	tamdyn          
	tcmiy 0         
	rbit  3         
	rbit  2         
	ldx   5         
	tcy   1         
	tcmiy 0         
	tcmiy 5         
	ldp   12        
	call  ADDB10    
	br    S751      
S757    ldp   6         
	call  CPY2TO5   
	ldx   4         
	tcy   1         
	tcmiy 7         
	tcmiy 5         
	ldp   12        
	call  ADDB10    
	mnez            
	br    S759      
	ldx   2         
	tcy   3         
	imac            
	br    S764      
	br    S759      
S764    ldp   6         
	call  CPY2TO5   
S751    ldp   12        
	call  CPY5TO4   
	ldp   10        
	call  L686      
	ldx   4         
	tcy   13        
	rbit  0         
S759    ldp   12        
	call  CPY0TO5   
	ldx   4         
	tcy   1         
	tcmiy 9         
	tcmiy 2         
	ldp   14        
	br    L780      
	mnea            
	mnea            
;---------------------
; chapter 1 page 14
;---------------------
L780    ldp   12        
	call  ADDB10    
	mnez            
	br    S7B7      
	call  S797      
	ldp   6         
	call  L580      
	ldx   4         
	tcy   13        
	rbit  2         
S7B7    ldp   12        
	call  CPY1TO5   
	ldx   4         
	tcy   1         
	tcmiy 9         
	tcmiy 4         
	ldp   12        
	call  ADDB10    
	mnez            
	br    S7A1      
	call  S797      
	ldp   10        
	call  L68E      
	ldx   4         
	tcy   13        
	rbit  1         
S7A1    ldp   12        
	call  L709      
	ldp   0         
	br    S40F      
S797    ldp   0         
	tpc             
	ldp   4         
	br    L129      
L7B1    tcy   1         
	tcmiy 9         
	tcmiy 9         
	retn            
;
; Swap 5/1 and 3/3; swap 5/2 and 3/4
;
L79B    ldx   3         
	tcy   3         
	tma             
	ldx   5         
	tcy   1         
	xma             
	ldx   3         
	tcy   3         
	tamiyc
	tma             
	ldx   5         
	tcy   2         
	xma             
	ldx   3         
	tcy   4         
	tam
	retn            

L7B2    ldp   0         
	tpc             
	ldp   7         
	call  PROMPT      
	ldp   15        
	br    L7D4      
	setr            
	rstr            
	iyc             
;---------------------
; chapter 1 page 15
;---------------------
L7C0    ldx   6         
	tcy   0         
	tcmiy 0         
	tcmiy 2         
S7CF    call  S7CB      
	a3aac           
	br    S7FD      
	br    S7EF      
S7FD    tamiyc          
	imac            
	br    S7F2      
S7EF    tam             
	br    S7CF      
L7FC    ldx   6         
	tcy   0         
	tcmiy 15        
	tcmiy 15        
S7CE    call  S7CB      
	a13aac          
	br    S7C2      
	tamiyc          
	dman            
	tam             
	a13aac          
	br    S7CE      
	ldp   0         
	br    S40F      
S7C2    tam             
	br    S7CE      
S7CB    tcy   10        
	setr            
	ynea            
	ynea            
	ynea            
	ynea            
	ldx   6         
	rstr            
	tcy   0         
	tma             
	iyc             
	tmy             
	ldx   7         
S7F4    tam             
	cla             
	a9aac           
S7E4    dan             
	br    S7E4      
	tma             
	dan             
	br    S7F4      
	dyn             
	br    S7F4      
	ldx   6         
	tcy   0         
	tma             
S7F2    retn            

L7E5    tcmiy 0         
	tcmiy 2         
	ldp   10        
	br    L68C      
L7D4    ldp   0         
	tpc             
	ldp   15        
	br    L3ED      
;---------------------
; chapter 2 page 0
;---------------------
L800    ldp   15        
	call  LBE6      
	ldp   15        
	call  LBE5      
	ldx   4         
	tcy   1         
	tcmiy 0         
	tam             
	ldp   15        
	call  LBD4      
	ldx   3         
	tcy   1         
	tbit1 3         
	br    S816      
	ldp   4         
	call  L92A      
	ldp   1         
	tpc             
	ldp   14        
	mnez            
	call  L7B1      
	br    S80D      
S816    ldp   0         
	tpc             
	ldp   12        
	call  SU2B10    
	mnez            
	br    S831      
	tcy   1         
	mnez            
	br    S80D      
	tcy   2         
	mnez            
	br    S80D      
S831    tcy   1         
	tcmiy 0         
	tcmiy 1         
S80D    ldp   4         
	call  L913      
L836    ldp   3         
	tpc             
	ldp   7         
	call  PLYBUGL   
	ldp   2         
	call  LCPBRIG   ; Copy Brigand count to 5/1-2 for calculations
	ldp   3         
	call  L8F4      
	tcy   6         
	ldp   9         
	call  ROTDRM3   
	ldp   0         
	tpc             
	ldp   9         
	call  L27B      
	ldx   7         
	tcy   14        
	tcmiy 15        
	tcmiy 15        
	ldp   0         
	tpc             
	ldp   9         
	call  L267      
	ldp   1         
	br    L840      
;---------------------
; chapter 2 page 1
;---------------------
L840    ldx   3         
	tcy   12        
	tma             
	tcy   13        
	amaac           
	br    S87B      
	dan             
	br    S87B      
	retn            

S87B    ldx   6         
	tcy   12        
	rbit  0         
	ldx   7         
	tcy   14        
	tcmiy 15        
	tcmiy 15        
	ldx   3         
	tcy   9         
	tma             
	a14aac          
	br    S85B      
S86B    ldp   0         
	tpc             
	ldp   7         
	call  L1F8      
	ynec  8         
	br    S851      
S842    call  S855      
	tcy   6         
	setr            
	ldp   3         
	tpc             
	ldp   11        
	call  PLYPLAG   
	tcy   6         
	rstr            
	cla             
	retn            

S85B    ldx   2         
	tcy   1         
	mnez            
	br    S86B      
	tcy   2         
	tma             
	a13aac          
	br    S86B      
	br    S842      
S851    ldp   15        
	call  LBE6      
	ldx   5         
	tcy   3         
	tam             
	rbit  3         
	rbit  2         
	ldp   15        
	call  LBE6      
	ldp   2         
	br    L880      
S855    ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	ldp   7         
	br    L9D3      
;---------------------
; chapter 2 page 2
;---------------------
L880    ldx   5         
	tcy   11        
	tam             
	rbit  3         
	rbit  2         
	ldp   15        
	call  LBD4      
	tcy   0         
	tcmiy 0         
	call  LCP5TO4   
	br    S8B9      
S8AF    tam             
	ldp   2         
	call  LSUMB10  
S8B9    ldx   5         
	tcy   3         
	dman            
	br    S8AF      
	call  LCP5TO4   
	call  LCPBRIG   ; Copy Brigand count to 5/1-2 for calculations
	tcy   0         
	tcmiy 0         
	call  LCP4TO5   
	tcy   4         
S898    tam             
	ldp   0         
	tpc             
	ldp   12        
	call  L33F      
	ldp   3         
	dan             
	br    L8FE      
	tcy   11        
	ldp   2         
	dman            
	br    S898      
	tam             
	call  LCP4TO5   
	call  LCP5TO4   
	call  LSUMB10  
	call  LCP4TO5   
	call  LSUMB10  
	call  LSUMB10  
	tma             
	ldp   3         
	br    L8C0      

LCP4TO5 ldp   1         
	tpc             
	ldp   10        
	br    CPY4TO5   

LSUMB10 ldp   0         
	tpc             
	ldp   4         
	br    SUMB10    

LCP5TO4 ldp   1         
	tpc             
	ldp   12        
	br    CPY5TO4   

LCPBRIG ldp   0         
	tpc             
	ldp   9         
	br    CPYBRIG   ; Copy Brigand count to 5/1-2 for calculations

	mnea            
	mnea            
;---------------------
; chapter 2 page 3
;---------------------
L8C0    tcy   1         
	xma             
	tcy   2         
	tam             
	ldp   4         
	call  L913      
	br    S8FB      
L8FE    ldp   1         
	call  S855      
S8FB    tcy   6         
	setr            
	call  S8C9      
	ldp   15        
	call  LBD4      
	call  L8F4      
	call  S8C8      
	tcy   6         
	rstr            
	tcy   5         
	setr            
	call  S8C9      
	ldp   2         
	call  LCPBRIG   ; Copy Brigand count to 5/1-2 for calculations
	call  L8F4      
	call  S8C8      
	tcy   5         
	rstr            
	ldx   5         
	tcy   11        
	imac            
	br    S8C6      
	ldp   3         
	tpc             
	ldp   8         
	call  PLYLOSR   ; Play the "lose round" sound
	br    S8ED      
S8C6    ldp   3         
	tpc             
	ldp   7         
	call  PLYWINR   ; Play the "win round" sound
S8ED    ldp   1         
	br    L840      
L8F4    ldp   0         
	tpc             
	ldp   8         
	br    BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2
S8C8    ldp   0         
	tpc             
	ldp   9         
	br    L267      
S8C9    ldp   3         
	tpc             
	ldp   14        
	br    LF80      
L8D9    ldp   1         
	tpc             
	ldp   15        
	call  L7C0      
	ldp   4         
	br    L900      
L8D4    ldp   0         
	tpc             
	ldp   12        
	br    L316      
;---------------------
; chapter 2 page 4
;---------------------
L900    ldp   15        
	call  LBE6      
	a14aac          
	br    S93D      
	ldp   1         
	tpc             
	ldp   15        
	br    L7FC      
S93D    a6aac           
	br    S91D      
L937    ldp   0         
	call  L800      
	iac             
	br    S91D      
S939    ldp   1         
	tpc             
	ldp   0         
	br    S40F      
S91D    ldp   14        
	call  LB86      
	ldp   7         
	call  L9EA      
	ldx   4         
	tcy   13        
	rbit  2         
	ldp   0         
	tpc             
	ldp   5         
	call  DSPRSLT   
	ldp   15        
	call  LBE6      
	ldp   5         
	a6aac           
	br    L97A      
	ldx   2         
	tcy   3         
	ldp   4         
	tbit1 0         
	br    S91A      
S936    ldp   4         
	br    S939      
S91A    tma             
	amaac           
	br    S936      
	tam             
	cla             
	a2aac           
	ldp   5         
	tbit1 3         
	br    L96F      
	br    L900      
L913    ldp   0         
	tpc             
	ldp   12        
	br    L30D      
L932    ldp   1         
	tpc             
	ldp   5         
	br    L569      
L92A    ldp   0         
	tpc             
	ldp   4         
	br    AD2B10    
	mnea            
;---------------------
; chapter 2 page 5
;---------------------
	dan             
	tbit1 2         
	br    S973      
	cla             
	ldx   4         
	tcy   14        
	rbit  2         
S97E    ldp   3         
	call  L8D4      
S97B    ldp   4         
	br    S939      
L96F    ldx   4         
	tcy   15        
	rbit  0         
	br    S97E      
S973    ldx   4         
	tcy   14        
	rbit  3         
	br    S97E      
L97A    a14aac          
	br    S946      
	tcy   4         
	ldp   9         
	call  ROTDRM3   
	tcy   5         
	setr            
	ldp   3         
	tpc             
	ldp   12        
	call  PLYPEGA   
	tcy   5         
	rstr            
	ldx   4         
	tcy   15        
	rbit  2         
	br    S97B      
S946    a14aac          
	br    S959      
	ldx   1         
	tcy   3         
	tbit1 2         
	br    S97B      
	sbit  2         
	tcy   4         
	ldp   9         
	call  ROTDRM3   
	ldp   0         
	tpc             
	ldp   9         
	call  LITEMID   
	ldx   4         
	tcy   15        
	rbit  1         
	br    S97B      
S959    ldx   3         
	tcy   9         
	tma             
	a14aac          
	br    S954      
	br    S97B      
S954    ldx   3         
	tcy   11        
	ldp   6         
	br    L980      
;---------------------
; chapter 2 page 6
;---------------------
L980    tma             
	ldx   4         
	tam             
	tcy   5         
	ldp   9         
	call  ROTDRM3   
	ldp   0         
	tpc             
	ldp   9         
	call  LITETOP   
S9B7    ldp   10        
	call  LA8F      
	ldx   4         
	tcy   11        
	mnea            
	br    S98E      
	br    S9B7      
S98E    ldx   3         
	tcy   11        
	tma             
	ldx   7         
	tcy   14        
	tcmiy 11        
	tam             
S998    ldp   0         
	tpc             
	ldp   7         
	call  PROMPT      
	ynec  8         
	br    S9AE      
	br    S9B7      
S9AE    ynec  9         
	br    S9A9      
S9B8    ldp   10        
	call  LA8F      
	ldx   4         
	tcy   11        
	mnea            
	br    S9B8      
	ldp   1         
	tpc             
	ldp   1         
	br    L458      
S9A9    ynec  0         
	br    S998      
	ldx   0         
	tcy   3         
	rbit  1         
	ldp   7         
	call  L9F6      
	ldp   2         
	call  LCP5TO4   
	ldp   7         
	call  L9E9      
	tcy   2         
S9B2    ldx   4         
	tma             
	ldx   6         
	tamdyn          
	br    S9B2      
	ldp   7         
	call  L9D1      
	ldp   7         
	br    L9C0      
;---------------------
; chapter 2 page 7
;---------------------
L9C0    ldp   15        
	call  LBD4      
	ldp   2         
	call  LCP5TO4   
	call  L9E9      
	ldp   2         
	call  LCP4TO5   
	ldp   10        
	call  LABD      
	ldp   2         
	call  LCP4TO5   
	call  L9D3      
	ldp   10        
	call  LA9E      
	ldp   2         
	call  LCP4TO5   
S9E7    ldp   10        
	call  LA8F      
	ldx   4         
	tcy   11        
	mnea            
	br    S9E7      
	call  S9F2      
	tcy   2         
S9D8    ldx   6         
	tma             
	ldx   4         
	tamdyn          
	br    S9D8      
	call  L9EA      
	ldx   4         
	tcy   13        
	rbit  0         
	ldp   0         
	tpc             
	ldp   5         
	call  DSPRSLT   
	ldp   4         
	br    S939      
L9F6    ldp   1         
	tpc             
	ldp   12        
	br    CPY0TO5   
L9E9    ldp   1         
	tpc             
	ldp   11        
	br    L6C0      
L9D1    ldp   1         
	tpc             
	ldp   5         
	br    L544      
L9D3    ldp   1         
	tpc             
	ldp   5         
	br    L540      
S9F2    ldp   1         
	tpc             
	ldp   10        
	br    L686      
L9EA    ldp   1         
	tpc             
	ldp   6         
	br    L580      
	mnea            
;---------------------
; chapter 2 page 8
;---------------------
LA00    imac            
	br    SA3D      
	ldp   1         
	tpc             
	ldp   4         
	iac             
	br    L505      
	br    SA2C      
SA3D    ldx   5         
	tcy   12        
	tcmiy 14        
	tcmiy 15        
LA1E    ldp   0         
	tpc             
	ldp   8         
	call  L223      
	br    SA09      
SA0E    tcy   11        
	tam             
SA3A    ldp   3         
	call  L8D4      
	ldx   5         
	tcy   12        
SA2C    tma             
	a3aac           
	ldx   7         
	tcy   14        
	tamiyc          
	tcmiy 15        
SA0B    ldp   0         
	tpc             
	ldp   7         
	call  PROMPT      
	ynec  4         
	br    SA36      
	ldx   5         
	tcy   11        
	tma             
	br    SA3A      
SA36    ynec  9         
	br    SA24      
	ldp   1         
	tpc             
	ldp   1         
	br    L458      
SA24    ynec  8         
	br    SA15      
	ldx   5         
	tcy   11        
	tma             
SA09    dan             
	br    SA0C      
	a3aac           
SA0C    ldx   5         
	tcy   13        
	mnea            
	br    SA0E      
	br    SA09      
SA15    ynec  0         
	br    SA0B      
	ldx   5         
	tcy   11        
	ldp   9         
	br    LA40      
;---------------------
; chapter 2 page 9
;---------------------
LA40    tma             
	tcy   12        
	tmy             
	mnea            
	br    SA5E      
	iyc             
	br    SA5D      
	tcy   12        
	tcmiy 15        
	tam             
	ldp   8         
	br    LA1E      
SA5E    ldp   3         
	tpc             
	ldp   11        
	call  PLYFAIL   
	ldp   4         
	br    S939      
SA5D    call  SA4C      
	ldp   0         
	call  L836      
	iac             
	br    SA70      
	ldp   4         
	br    S939      
SA70    tcy   6         
	call  ROTDRM3   
	tcy   7         
	setr            
	ldp   3         
	tpc             
	ldp   0         
	call  PLYTHEM      
	tcy   7         
	rstr            
	ldx   2         
	ldp   1         
	tpc             
	ldp   1         
	call  S446      
	call  SA4C      
	ldp   0         
	tpc             
	ldp   9         
	call  CPYBRIG  ; Copy Brigand count to 5/1-2 for calculations
	ldp   3         
	tpc             
	ldp   15        
	br    LFFF      

ROTDRM3 ldp   0         
	tpc             
	ldp   8         
	br    ROTDRUM

SA4C    ldx   3         
	tcy   15        
SA72    tma             
	dyn             
	dyn             
	tamiyc          
	ynec  13        
	br    SA72      
	retn            

	mnea            
	mnea            
;---------------------
; chapter 2 page 10
;---------------------
SA80    ldp   0         
	tpc             
	ldp   11        
	br    L2D6      
LA8F    ldp   0         
	tpc             
	ldp   8         
	br    ROTPLYR   
LABD    ldp   0         
	tpc             
	ldp   10        
	br    L28C      
LA9E    ldp   0         
	tpc             
	ldp   11        
	br    L2F3      
LAA7    ldp   3         
	tpc             
	ldp   6         
	call  PLYATTK      
	ldx   2         
	tcy   3         
	ldp   8         
	br    LA00      

LA98    ldp   3         
	tpc             
	ldp   4         
	call  LD1D      
	ldx   7         
	tcy   11        
	tcmiy 1         
	ldp   15        
	call  LBE6      
	ldx   4         
	tamdyn          
	tcmiy 0         
	rbit  3         
	rbit  2         
	ldx   5         
	tcy   1         
	tcmiy 0         
	tcmiy 5         
	ldp   4         
	call  L92A      
	call  LABD      
	call  SA80      
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	call  SA80      
SA89    ldp   0         
	tpc             
	ldp   11        
	call  L2ED      
	call  LABD      
	call  SA80      
	tcy   11        
	tmy             
	ynec  1         
	br    SA89      
LA94    call  LA9E      
	ldp   11        
	br    LAC0      
	mnea            
;---------------------
; chapter 2 page 11
;---------------------
;
; Bazaar maybe?
;
LAC0    ldp   15        
	call  LBFD      
	ldx   4         
	tcy   12        
	sbit  1         
SADF    ldp   15        
	call  LBDE      
LAFE    ldx   7         
	tcy   14        
	tcmiy 14        
	tcmiy 14        
	ldp   0         
	tpc             
SAFC    ldp   7         
	call  PROMPT      
	ynec  4         
	br    SADD      
	br    SADF      
SADD    ynec  9         
	br    SAD8      
	ldp   1         
	tpc             
	ldp   1         
	br    L458      
SAD8    ynec  8         
	br    SAC4      
SAE1    ldp   10        
	call  SA80      
	tcy   11        
	tma             
	a13aac          
	br    SAF1      
SADC    ldp   10        
	br    LA94      
SAF1    ldx   1         
	tcy   3         
	dan             
	br    SADA      
	tbit1 0         
	br    SAE1      
	br    SADC      
SADA    dan             
	br    SAC8      
	tbit1 3         
	br    SAE1      
	br    SADC      
SAC8    tbit1 1         
	br    SAE1      
	br    SADC      
SAC4    ldp   12        
	ynec  1         
	br    LB06      
	ldx   5         
	tcy   3         
	ldp   12        
	mnez            
	br    LB3C      
	tcy   4         
	tmy             
	ynec  1         
	br    LB3C      
	br    SB00      
	mnea            
	mnea            
;---------------------
; chapter 2 page 12
;---------------------
SB00    tcy   5         
	ldp   9         
	call  ROTDRM3   
	tcy   6         
	setr            
	ldp   3         
	tpc             
	ldp   11        
	call  PLYFAIL   
	tcy   6         
	rstr            
	ldp   4         
	br    S939      
LB3C    ldp   15        
	call  LBE6      
	ldx   4         
	tcy   12        
	tbit1 1         
	br    SB16      
	a8aac           
	br    SB00      
	br    SB30      
SB16    rbit  1         
	a4aac           
	br    SB00      
SB30    ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	ldp   15        
	call  LBC0      
	call  SB2A      
	ldp   15        
	call  LBFD      
	ldp   11        
	br    SADF      
LB06    ldp   11        
	ynec  0         
	br    LAFE      
	ldx   5         
	tcy   5         
	ldp   12        
SB34    tcmiy 0         
	ynec  9         
	br    SB34      
LB24    ldp   15        
	call  LBC0      
	ldp   2         
	call  LCP5TO4   
	ldp   15        
	call  LBC0      
	ldp   4         
	call  L92A      
	ldp   2         
	call  LCP5TO4   
	ldp   15        
	call  LBCF      
	ldp   13        
	br    LB40      
SB2A    ldp   0         
	tpc             
	ldp   12        
	br    SU2B10    
	mnea            
;---------------------
; chapter 2 page 13
;---------------------
LB40    ldp   7         
	call  L9F6      
	ldp   12        
	call  SB2A      
	ldp   12        
	mnez            
	br    SB00      
	ldx   7         
	tcy   11        
	tma             
	ldp   13        
	a13aac          
	br    SB53      
	ldp   15        
	call  LBFD      
	ldx   4         
	tcy   1         
	tcmiy 0         
	tcmiy 1         
	ldp   4         
	call  L92A      
	ldp   2         
	call  LCP5TO4   
	ldp   15        
	call  LBC0      
SB70    ldp   2         
	call  LCP4TO5   
	ldp   2         
	call  LCP5TO4   
	ldp   3         
	call  L8F4      
	ldp   0         
	tpc             
	ldp   7         
	call  PROMPT      
	ynec  9         
	br    SB5A      
	ldp   1         
	tpc             
	ldp   1         
	br    L458      
SB5A    ynec  0         
	br    SB64      
	ldp   12        
	br    LB24      
SB64    ldp   14        
	ynec  4         
	br    LB80      
	ldp   15        
	call  LBDE      
	br    SB70      
SB53    ldx   1         
	tcy   3         
	a14aac          
	br    SB68      
	iac             
	br    SB6A      
	sbit  0         
	br    SB50      
SB6A    sbit  3         
	br    SB50      
SB68    sbit  1         
SB50    ldp   14        
	br    LBAB      
;---------------------
; chapter 2 page 14
;---------------------
LB80    ldp   13        
	ynec  8         
	br    SB70      
	ldp   15        
	call  LBFD      
	ldp   2         
	call  LCP5TO4   
	ldp   15        
	call  LBC0      
	ldx   7         
	tcy   11        
	tma             
	a14aac          
	br    SB8E      
	ldp   7         
	call  S9F2      
	br    LBAB      
SB8E    ldp   1         
	tpc             
	ldp   10        
	call  L68E      
LBAB    ldp   15        
	call  LBCF      
	ldp   2         
	call  LCP5TO4   
	ldp   7         
	call  L9D1      
	ldx   4         
	tcy   13        
	rbit  2         
	ldp   0         
	tpc             
	ldp   5         
	call  DSPRSLT   
	ldp   4         
	br    S939      
LB86    ldp   15        
	call  LBE6      
	ldx   4         
	tamdyn          
	tcmiy 0         
	rbit  3         
	ldx   5         
	tcy   1         
	tcmiy 1         
	tcmiy 3         
	ldp   4         
	call  L92A      
	ldp   2         
	br    LCP5TO4   
LB89    dan             
	call  SB94      
	mnez            
	call  SBA5      
	ldp   4         
	br    L932      
SBA5    tcy   1         
	tcmiy 9         
	tcmiy 9         
	retn            

SB94    tcmiy 0         
	tcmiy 0         
	tcmiy 0         
	retn            

;---------------------
; chapter 2 page 15
;---------------------
LBC0    ldp   0         
	tpc             
	ldp   11        
	br    ROL5BY2   
LBCF    ldp   0         
	tpc             
	ldp   11        
	br    ROL5BY4   
;
; Called early in visit to bazaar
;
LBFD    ldp   0         
	tpc             
	ldp   11        
	br    ROL5BY6   

LBDE    call  LBC0      
	ldp   3         
	call  L8F4      
	call  LBFD      
	ldx   7         
	tcy   11        
	tma             
	a12aac          
	br    SBF6      
	tcy   1         
	ldp   9         
	call  ROTDRM3   
	ldx   7         
	tcy   11        
	tma             
	a13aac          
	br    SBE2      
	iac             
	br    SBE3      
SBEE    ldp   0         
	tpc             
	ldp   9         
	br    L241      
SBE3    ldp   0         
	tpc             
	ldp   9         
	br    L25F      
SBF6    tcy   2         
	ldp   9         
	call  ROTDRM3   
	ldx   7         
	tcy   11        
	tma             
	a11aac          
	br    SBE3      
	br    SBEE      
SBE2    ldp   0         
	tpc             
	ldp   9         
	br    L27B      
LBE6    ldp   0         
	tpc             
	ldp   3         
	br    RANDOM    
LBE5    ldp   0         
	tpc             
	ldp   8         
	br    L20D      
LBD4    ldp   1         
	tpc             
	ldp   6         
	br    CPY2TO5   
;---------------------
; chapter 3 page 0
;---------------------

;********************************************************************************
; PLAYBUF - Play the sound buffer loaded in the Scratchpad RAM region
;
; 4/Y and 5/Y have array of durations
; 6/Y and 7/Y have array of pitches
; Notes are loaded in reverse order from Y=(0-11) down to 0
;
; Called with Y regsiter pointing to last note + 1
;********************************************************************************
PLAYBUF tya             ; Transfer the Y register to the Accumulator
	dan             ; Subtract one from Accumulator to point to end of sound buffer at 4/Y
	ldx   3         
	tcy   10        
SC0F    tam             ; Save pointer into sound buffer into 3/10
	tmy             
	ldx   4         ; Check 4/Y
	mnez            
	br    SC3A      ; There's a value here, play it

	ldx   5         ; Check 5/Y
	mnez            
	br    SC3A      ; There's a value here, play it
	ldp   1         
	br    LC5F      
SC39    mnea            
	mnea            
	mnea            
	mnea            
SC1D    tam             
SC3A    tcy   10        ; Select the speaker R output
	setr            ; Toggle the speaker on
	mnea            
	mnea            
	mnea            
	mnea            
	ldx   3         
	rstr            ; Toggle the speaker off
	tmy             
	ldx   6         
	tma             
	ldx   7         
	tmy             
SC1C    dyn             
	br    SC1C      
	dan             
	br    SC1C      
	ldx   3         
	tcy   10        
	tmy             
	ldx   5         
	dman            
	br    SC39      
	tam             
	ldx   4         
	dman            
	br    SC1D      
LC08    ldx   3         
	tcy   10        
	dman            
	br    SC0F      
	retn            

LC13    ldp   8         
	br    PLYLOSR   ; Play the "lose round" sound

;********************************************************************************
; PLYTHEM - Play the theme song (start of game and victory over Dark Tower)
;********************************************************************************
PLYTHEM ldx   6         
	tcy   0         ; 6/0 - 7 1 8 0 11 0 8 1 11 1 8
	tcmiy 7         
	tcmiy 1         
	tcmiy 8         
	tcmiy 0         
	tcmiy 11        
	tcmiy 0         
	tcmiy 8         
	ldp   1         
	br    LC4D      

;---------------------
; chapter 3 page 1
;---------------------
SC40    mnea            
	mnea            
	mnea            
	mnea            
SC4F    tam             
LC5F    cla             
	dan             
SC7E    mnea            
	mnea            
	mnea            
	mnea            
	mnea            
	dan             
	br    SC7E      
	ldx   7         
	dman            
	br    SC40      
	tam             
	ldx   6         
	dman            
	br    SC4F      
	ldp   0         
	br    LC08      

;********************************************************************************
; PLYTICK - Play tick sound on keypress
;********************************************************************************
PLYTICK ldx   7         
	tcy   0         ; 7/0 - 0
	tcmiy 0         
	ldx   6         
	tcy   0         ; 6/0 - 4
	tcmiy 4         
	ldx   5         
	tcy   0         ; 5/0 - 1
	tcmiy 1         
	ldx   4         
	tcy   0         ; 4/0 - 0
	tcmiy 0         
	ldp   0         
	br    PLAYBUF   ; Play the tick sound and return to caller

;********************************************************************************
; Continue loading play buffer for part 1 of intro tune
;********************************************************************************
LC4D    tcmiy 1         
	tcmiy 11        
	tcmiy 1         
	tcmiy 8         
	ldx   7         
	tcy   0         ; 7/0 - 5 0 11 1 13 1 11 0 13 0 11
	tcmiy 5         
	tcmiy 0         
	tcmiy 11        
	tcmiy 1         
	tcmiy 13        
	tcmiy 1         
	tcmiy 11        
	tcmiy 0         
	tcmiy 13        
	tcmiy 0         
	tcmiy 11        
	ldx   4         
	tcy   0         ; 4/0 - 6 0 2 0 1 0 2 1 0 4 0 6
	tcmiy 6         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	ldp   2         
	br    LC80      
;---------------------
; chapter 3 page 2
;---------------------
LC80    tcmiy 1         
	tcmiy 0         
	tcmiy 4         
	tcmiy 0         
	tcmiy 6         
	ldx   5         
	tcy   0         ; 5/0 - 0 0 2 0 10 0 10 0 4 0 0
	tcmiy 0         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 4         
	tcmiy 0         
	tcmiy 0         
	ldp   0         
	call  PLAYBUF   ; Play part 1 of intro tune

;********************************************************************************
; Load play buffer for part 2 of intro tune
;********************************************************************************
	ldx   6         
	tcy   0         ; 6/0 - 1 5 1 7 0 8 0 7 1 8 1
	tcmiy 1         
	tcmiy 5         
	tcmiy 1         
	tcmiy 7         
	tcmiy 0         
	tcmiy 8         
	tcmiy 0         
	tcmiy 7         
	tcmiy 1         
	tcmiy 8         
	tcmiy 1         
	ldx   7         
	tcy   0         ; 7/0 - 0 10 0 3 1 11 1 5 0 11 0
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 3         
	tcmiy 1         
	tcmiy 11        
	tcmiy 1         
	tcmiy 5         
	tcmiy 0         
	tcmiy 11        
	tcmiy 0         
	ldx   4         
	tcy   0         ; 4/0 - 0 8 0 2 0 1 0 1 0 4 0
	tcmiy 0         
	tcmiy 8         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	tcmiy 4         
	tcmiy 0         
	ldx   5         
	tcy   0         ; 5/0 - 3 0 0 2 0 10 0 10 0 5 0
	tcmiy 0         
	ldp   3         
	br    LCC0      
;---------------------
; chapter 3 page 3
;---------------------
LCC0    tcmiy 0         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 5         
	tcmiy 0         
	ldp   0         
	call  PLAYBUF   ; Play part 2 of the intro tune

;********************************************************************************
; Load play buffer for part 3 of intro tune
;********************************************************************************
	ldx   6         
	tcy   0         ; 6/0 - 6 1 8 0 11 0 8 1 11
	tcmiy 6         
	tcmiy 1         
	tcmiy 8         
	tcmiy 0         
	tcmiy 11        
	tcmiy 0         
	tcmiy 8         
	tcmiy 1         
	tcmiy 11        
	ldx   7         
	tcy   0         ; 7/0 - 13 0 11 1 13 1 11 0 13
	tcmiy 13        
	tcmiy 0         
	tcmiy 11        
	tcmiy 1         
	tcmiy 13        
	tcmiy 1         
	tcmiy 11        
	tcmiy 0         
	tcmiy 13        
	ldx   4         
	tcy   0         ; 4/0 - 15 0 2 0 1 0 2 0 3
	tcmiy 15        
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 3         
	ldx   5         
	tcy   0         ; 5/0 - 15 0 2 0 10 0 2 0 4
	tcmiy 15        
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	tcmiy 2         
	tcmiy 0         
	tcmiy 4         
	ldp   0         
	br    PLAYBUF   ; Play part 3 of the intro tune and return to the caller

;********************************************************************************
; PLAYEOT - Play the end of turn sound (three tones)
;********************************************************************************
PLAYEOT ldx   6         
	tcy   0         ; 6/0 - 1 3 6
	tcmiy 1         
	tcmiy 3         
	ldp   4         
	br    LD00      
;---------------------
; chapter 3 page 4
;---------------------
LD00    tcmiy 6         
	ldx   7         
	tcy   0         ; 7/0 - 3 0 11
	tcmiy 3         
	tcmiy 0         
	tcmiy 11        
	ldx   4         
	tcy   0         ; 4/0 - 8 4 2
	tcmiy 8         
	tcmiy 4         
	tcmiy 2         
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0
	tcmiy 0         
	tcmiy 0         
	tcmiy 0         
	ldp   0         
	br    PLAYBUF   ; Play the EOT sound and return to caller

;********************************************************************************
; PLY
;********************************************************************************
LD1D    ldx   6         
	tcy   0         ; 6/0 - 6 5 6 7 6 5 6 7 9
	tcmiy 6         
	tcmiy 5         
	tcmiy 6         
	tcmiy 7         
	tcmiy 6         
	tcmiy 5         
	tcmiy 6         
	tcmiy 7         
	tcmiy 9         
	ldx   7         
	tcy   0         ; 7/0 - 3 15 3 10 3 15 3 10 7
	tcmiy 3         
	tcmiy 15        
	tcmiy 3         
	tcmiy 10        
	tcmiy 3         
	tcmiy 15        
	tcmiy 3         
	tcmiy 10        
	tcmiy 7         
	ldx   4         
	tcy   0         ; 4/0 - 10 5 5 5 5 5 5 5 5 5
	tcmiy 10        
SD29    tcmiy 5         
	ynec  9         
	br    SD29      
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0 0
SD22    tcmiy 0         
	ynec  9         
	br    SD22      
	ldp   0         
	call  PLAYBUF   ; Play part 1 of tune

LD0C    ldx   6         
	tcy   0         ; 6/0 - 15
	tcmiy 15        
	ldx   7         
	tcy   0         ; 7/0 - 15
	tcmiy 15        
	ldx   4         
	tcy   0         ; 4/0 - 0
	tcmiy 0         
	ldp   5         
	br    LD40      
;---------------------
; chapter 3 page 5
;---------------------
LD40    ldx   5         
	tcy   0         ; 5/0 - 0
	tcmiy 0         
	ldp   0         
	br    PLAYBUF   ; Play part 2 of tune and return to caller

;********************************************************************************
; PLYSANC - Play the Sanctuary / Citadel sound
;********************************************************************************
PLYSANC call  SD4E      
	call  SD4E      
	call  SD4E      
	call  SD4E      
	call  SD4E      
	call  SD69      
	call  SD69      
	call  SD69      
	call  SD69      
	call  SD69      
	ldp   4         
	br    LD0C      

;
; First half of Sanctuary / Citadel sound 
;
SD4E    ldx   6         
	tcy   0         ; 6/0 - 0 0 1 0 0 1 0 0 1 
SD7A    tcmiy 0         
	tcmiy 0         
	tcmiy 1         
	ynec  9         
	br    SD7A      
	ldx   7         
	tcy   0         ; 7/0 - 10 14 4 10 14 4 10 14 4 
SD61    tcmiy 10        
	tcmiy 14        
	tcmiy 4         
	ynec  9         
	br    SD61      
	ldx   4         
	tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1
SD78    tcmiy 1         
	ynec  9         
	br    SD78      
	ldx   5         
	tcy   0         ; 5/0 - 10 10 10 10 10 10 10 10 10
SD5B    tcmiy 10        
	ynec  9         
	br    SD5B      
	ldp   0         
	br    PLAYBUF      

;
; Second half of Sanctuary / Citadel sound
;
SD69    ldx   6         
	tcy   0         ; 6/0 - 0 0 1 0 0 1 0 0 1 
SD64    tcmiy 0         
	tcmiy 0         
	tcmiy 1         
	ynec  9         
	br    SD64      
	ldx   7         ; 7/0 - 9 15 4 9 15 4 9 15 4 
	tcy   0         
SD66    tcmiy 9         
	tcmiy 15        
	tcmiy 4         
	ynec  9         
	br    SD66      
	ldx   4         
	tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1 
SD6A    tcmiy 1         
	ynec  9         
	br    SD6A      
	ldp   6         
	br    LD80      
;---------------------
; chapter 3 page 6
;---------------------
LD80    ldx   5         
	tcy   0         ; 5/0 - 10 10 10 10 10 10 10 10 10 
SD83    tcmiy 10        
	ynec  9         
	br    SD83      
	ldp   0         
	br    PLAYBUF      

;********************************************************************************
; PLYATTK - Play the Dark Tower attack song
;********************************************************************************
PLYATTK ldx   6         
	tcy   0         
	tcmiy 2         
	tcmiy 8         
	tcmiy 2         
	tcmiy 7         
	tcmiy 2         
	tcmiy 6         
	tcmiy 2         
	tcmiy 7         
	tcmiy 2         
	tcmiy 8         
	ldx   7         
	tcy   0         
	tcmiy 1         
	tcmiy 8         
	tcmiy 1         
	tcmiy 10        
	tcmiy 1         
	tcmiy 11        
	tcmiy 1         
	tcmiy 10        
	tcmiy 1         
	tcmiy 8         
	ldx   4         
	tcy   0         
SDB8    tcmiy 0         
	tcmiy 2         
	ynec  10        
	br    SDB8      
	ldx   5         
	tcy   0         
SDB6    tcmiy 0         
	ynec  10        
	br    SDB6      
	ldp   0         
	call  PLAYBUF      

	ldx   6         
	tcy   0         
	tcmiy 8         
	tcmiy 2         
	tcmiy 8         
	tcmiy 9         
	tcmiy 6         
	tcmiy 2         
	tcmiy 7         
	ldx   7         
	tcy   0         
	tcmiy 8         
	tcmiy 1         
	tcmiy 8         
	tcmiy 2         
	tcmiy 11        
	tcmiy 1         
	tcmiy 10        
	ldp   7         
	br    LDC0      
;---------------------
; chapter 3 page 7
;---------------------
LDC0    ldx   4         
	tcy   0         
	tcmiy 11        
	tcmiy 0         
	tcmiy 5         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	tcmiy 2         
	ldx   5         
	tcy   0         
SDEF    tcmiy 0         
	ynec  4         
	br    SDEF      
	tcmiy 8         
	tcmiy 0         
	tcmiy 0         
	ldp   0         
	call  PLAYBUF      

	ldp   4         
	br    LD0C      

;********************************************************************************
; PLYBUGL - Play bugle call for brigand attack
;********************************************************************************
PLYBUGL ldx   6         
	tcy   0         ; 6/0 - 1 3 2 1 3
	tcmiy 1         
	tcmiy 3         
	tcmiy 2         
	tcmiy 1         
	tcmiy 3         
	ldx   7         
	tcy   0         ; 7/0 - 14 3 0 14 3
	tcmiy 14        
	tcmiy 3         
	tcmiy 0         
	tcmiy 14        
	tcmiy 3         
	ldx   4         
	tcy   0         ; 4/0 - 15 5 0 15 5
	tcmiy 15        
	tcmiy 5         
	tcmiy 0         
	tcmiy 15        
	tcmiy 5         
	ldx   5         
	tcy   0         ; 5/0 - 10 0 0 10 0 
	tcmiy 10        
	tcmiy 0         
	tcmiy 0         
	tcmiy 10        
	tcmiy 0         
	ldp   0         
	call  PLAYBUF      
	ldp   4         
	br    LD0C      

;********************************************************************************
; PLYWINR - Play low/high tones when player wins a round against Brigands
;********************************************************************************
PLYWINR ldx   6         
	tcy   0         ; 6/0 - 4 6
	tcmiy 4         
	tcmiy 6         
	ldx   7         
	tcy   0         ; 7/0 - 5 12
	tcmiy 5         
	tcmiy 12        
	ldx   4         
	ldp   8         
	br    LE00      
;---------------------
; chapter 3 page 8
;---------------------
LE00    tcy   0         ; 4/0 - 11 5
	tcmiy 11        
	tcmiy 5         
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0
	tcmiy 0         
	tcmiy 0         
	ldp   0         
	call  PLAYBUF      
	ldp   4         
	br    LD0C      

;********************************************************************************
; PLYLOSR - Play high/low tones when player loses a round against Brigands
;********************************************************************************
PLYLOSR ldx   6         
	tcy   0         ; 6/0 - 9 6
	tcmiy 9         
	tcmiy 6         
	ldx   7         
	tcy   0         ; 7/0 - 7 11
	tcmiy 7         
	tcmiy 11        
	ldx   4         
	tcy   0         ; 4/0 - 8 10
	tcmiy 8         
	tcmiy 10        
	ldx   5         
	tcy   0         ; 5/0 - 0 0
	tcmiy 0         
	tcmiy 0         
	ldp   0         
	call  PLAYBUF      
	ldp   4         
	br    LD0C      

;********************************************************************************
; PLYFRNT - Play the Frontier sound
;********************************************************************************
PLYFRNT call  SE23      
	call  SE23      
	ldp   4         
	br    LD0C      

SE23    ldx   6         
	tcy   0         ; 6/0 - 1 2 3 1 2 3
SE0D    tcmiy 1         
	tcmiy 2         
	tcmiy 3         
	ynec  6         
	br    SE0D      
	ldx   7         
	tcy   0         ; 7/0 - 13 10 0 13 10 0 
SE12    tcmiy 13        
	tcmiy 10        
	tcmiy 0         
	ynec  6         
	br    SE12      
	ldx   4         
	tcy   0         ; 4/0 - 3 3 3 3 3 3
SE13    tcmiy 3         
	ynec  6         
	br    SE13      
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0
SE25    tcmiy 0         
	ynec  6         
	br    SE25      
	ldp   0         
	br    PLAYBUF      

	tka             
	tam             
	iyc             
;---------------------
; chapter 3 page 9
;---------------------

;********************************************************************************
; PLYDRGN - Play the dragon siren
;********************************************************************************
PLYDRGN call  SE7E      
	call  SE7E      
	call  SE7E      
	call  SE7E      
	call  SE7E      
	call  SE7E      
	call  SE7E      

SE7E    ldx   6         
	tcy   0         ; 6/0 - 1 0 1 0 1 0 1 0 1 0
SE7B    tcmiy 1         
	tcmiy 0         
	ynec  10        
	br    SE7B      
	ldx   7         ; 7/0 - 3 5 3 5 3 5 3 5 3 5
	tcy   0         
SE73    tcmiy 3         
	tcmiy 5         
	ynec  10        
	br    SE73      
	ldx   4         ; 4/0 - 1 0 1 0 1 0 1 0 1 0
	tcy   0         
SE6B    tcmiy 1         
	tcmiy 0         
	ynec  10        
	br    SE6B      
	ldx   5         ; 5/0 - 6 8 6 8 6 8 6 8 6 8
	tcy   0         
SE42    tcmiy 6         
	tcmiy 8         
	ynec  10        
	br    SE42      
	ldp   0         
	br    PLAYBUF      

;********************************************************************************
; PLYDSWD - Sword defense against Dragon sound
;********************************************************************************
PLYDSWD ldp   10        
	call  LE80      
	ldp   10        
	call  LE9B      
;
; Sword defense part three
;
	ldx   6         
	tcy   0         ; 6/0 - 13 12 12 11 11
	tcmiy 13        
	tcmiy 12        
	tcmiy 12        
	tcmiy 11        
	tcmiy 11        
	ldx   7         
	tcy   0         ; 7/0 - 1 7 2 9 4
	tcmiy 1         
	tcmiy 7         
	tcmiy 2         
	tcmiy 9         
	tcmiy 4         
	ldx   4         
	tcy   0         ; 4/0 - 9 1 1 1 1
	tcmiy 9         
SE59    tcmiy 1         
	ynec  5         
	br    SE59      
	ldx   5         
	tcy   0         ; 5/0 - 8 8 8 8 8
SE6A    tcmiy 8         
	ynec  5         
	br    SE6A      
	ldp   0         
	br    PLAYBUF      
;---------------------
; chapter 3 page 10
;---------------------
;
; Sword defense part one
;
LE80    ldx   6         
	tcy   0         ; 6/0 - 6 5 5 4 4 3 3 3 2 2
	tcmiy 6         
	tcmiy 5         
	tcmiy 5         
	tcmiy 4         
	tcmiy 4         
	tcmiy 3         
	tcmiy 3         
	tcmiy 3         
	tcmiy 2         
	tcmiy 2         
	ldx   7         
	tcy   0         ; 7/0 - 1 13 2 14 4 15 5 0 7 2
	tcmiy 1         
	tcmiy 13        
	tcmiy 2         
	tcmiy 14        
	tcmiy 4         
	tcmiy 15        
	tcmiy 5         
	tcmiy 0         
	tcmiy 7         
	tcmiy 2         
SE98    ldx   4         
	tcy   0         ; 4/0 - 0 1 0 1 0 1 0 1 0 1
SEA1    tcmiy 0         
	tcmiy 1         
	ynec  10        
	br    SEA1      
	ldx   5         
	tcy   0         ; 5/0 - 8 6 8 6 8 6 8 6 8 6
SE9C    tcmiy 8         
	tcmiy 6         
	ynec  10        
	br    SE9C      
	ldp   0         
	br    PLAYBUF      
;
; Sword defense part two
;
LE9B    ldx   6         
	tcy   0         ; 6/0 - 10 10 9 9 8 8 7 7 6 6
	tcmiy 10        
	tcmiy 10        
	tcmiy 9         
	tcmiy 9         
	tcmiy 8         
	tcmiy 8         
	tcmiy 7         
	tcmiy 7         
	tcmiy 6         
	tcmiy 6         
	ldx   7         
	tcy   0         ; 7/0 - 10 5 12 7 13 8 15 10 15 11
	tcmiy 10        
	tcmiy 5         
	tcmiy 12        
	tcmiy 7         
	tcmiy 13        
	tcmiy 8         
	tcmiy 15        
	tcmiy 10        
	tcmiy 15        
	tcmiy 11        
	br    SE98      
	mnea            
;---------------------
; chapter 3 page 11
;---------------------

;********************************************************************************
; PLYFAIL - Play failure riff.  Bazaar Closed and Lost events
;********************************************************************************
PLYFAIL ldx   6         
	tcy   0         ; 6/0 - 10 9 8 7 6 5 4 3 2
	tcmiy 10        
	tcmiy 9         
	tcmiy 8         
	tcmiy 7         
	tcmiy 6         
	tcmiy 5         
	tcmiy 4         
	tcmiy 3         
	tcmiy 2         
	ldx   7         
	tcmiy 0         ; 7/0 - 0 0 0 0 0 0 0 0 0
SEFC    tcmiy 0         
	ynec  9         
	br    SEFC      
	ldx   4         
	tcy   0         ; 4/0 - 4 4 4 4 4 4 4 4 4
SEDD    tcmiy 4         
	ynec  9         
	br    SEDD      
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0
SEEC    tcmiy 0         
	ynec  9         
	br    SEEC      
	ldp   0         
	br    PLAYBUF      

;********************************************************************************
; PLYPLAG - Play the Plague tune (death march)
;********************************************************************************
PLYPLAG ldx   6         
	tcy   0         ; 6/0 - 0 9 0 9 0 9 0 9
SED7    tcmiy 0         
	tcmiy 9         
	ynec  8         
	br    SED7      
	ldx   7         
	tcy   0         ; 7/0 - 12 9 12 9 12 9 12 9 
SEC6    tcmiy 12        
	tcmiy 9         
	ynec  8         
	br    SEC6      
	ldx   4         
	tcy   0         ; 4/0 - 0 6 0 1 0 3 0 3
	tcmiy 0         
	tcmiy 6         
	tcmiy 0         
	tcmiy 1         
	tcmiy 0         
	tcmiy 3         
	tcmiy 0         
	tcmiy 3         
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0
SEE6    tcmiy 0         
	ynec  8         
	br    SEE6      
	ldp   0         
	call  PLAYBUF      

	ldx   6         
	tcy   0         ; 6/0 - 9 9 9 0 9 8 0 8 7
	tcmiy 9         
	tcmiy 9         
	tcmiy 9         
	ldp   12        
	br    LF00      
;---------------------
; chapter 3 page 12
;---------------------
LF00    tcmiy 0         
	tcmiy 9         
	tcmiy 8         
	tcmiy 0         
	tcmiy 8         
	tcmiy 7         
	ldx   7         
	tcy   0         ; 7/0 - 9 14 9 12 9 2 12 2 12
	tcmiy 9         
	tcmiy 14        
	tcmiy 9         
	tcmiy 12        
	tcmiy 9         
	tcmiy 2         
	tcmiy 12        
	tcmiy 2         
	tcmiy 12        
	ldx   4         
	tcy   0         ; 4/0 - 3 3 3 0 3 3 0 3 3
	tcmiy 3         
	tcmiy 3         
	tcmiy 3         
	tcmiy 0         
	tcmiy 3         
	tcmiy 3         
	tcmiy 0         
	tcmiy 3         
	tcmiy 3         
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0
SF17    tcmiy 0         
	ynec  9         
	br    SF17      
	ldp   0         
	call  PLAYBUF      

	ldp   4         
	br    LD0C      

;********************************************************************************
; PLYPEGA - Play the Pegasus found sound
;********************************************************************************
PLYPEGA ldx   6         
	tcy   0         ; 6/0 - 1 2 2 3 3 4 5 5 6 7
	tcmiy 1         
	tcmiy 2         
	tcmiy 2         
	tcmiy 3         
	tcmiy 3         
	tcmiy 4         
	tcmiy 5         
	tcmiy 5         
	tcmiy 6         
	tcmiy 7         
	ldx   7         
	tcy   0         ; 7/0 - 3 1 8 6 13 11 1 15 6 4
	tcmiy 3         
	tcmiy 1         
	tcmiy 8         
	tcmiy 6         
	tcmiy 13        
	tcmiy 11        
	tcmiy 1         
	tcmiy 15        
	tcmiy 6         
	tcmiy 4         
	ldx   4         
	ldp   13        
	br    LF40      
;---------------------
; chapter 3 page 13
;---------------------
LF40    tcy   0         ; 4/0 - 3 3 2 2 2 1 1 0 0 0
	tcmiy 3         
	tcmiy 3         
	tcmiy 2         
	tcmiy 2         
	tcmiy 2         
	tcmiy 1         
	tcmiy 1         
	tcmiy 0         
	tcmiy 0         
	tcmiy 0         
	ldx   5         
	tcy   0         ; 5/0 - 8 0 13 5 2 10 6 15 11 4
	tcmiy 8         
	tcmiy 0         
	tcmiy 13        
	tcmiy 5         
	tcmiy 2         
	tcmiy 10        
	tcmiy 6         
	tcmiy 15        
	tcmiy 11        
	tcmiy 4         
	ldp   0         
	call  PLAYBUF      

	ldx   6         
	tcy   0         ; 6/0 - 0 0 0 0
SF42    tcmiy 0         
	ynec  4         
	br    SF42      
	ldx   7         
	tcy   0         ; 7/0 - 0 2 3 13
	tcmiy 0         
	tcmiy 2         
	tcmiy 3         
	tcmiy 13        
	ldx   4         
	tcy   0         ; 4/0 - 4 4 4 3
	tcmiy 4         
	tcmiy 4         
	tcmiy 4         
	tcmiy 3         
	ldx   5         
	tcy   0         ; 5/0 - 14 7 3 12
	tcmiy 14        
	tcmiy 7         
	tcmiy 3         
	tcmiy 12        
	ldp   0         
	br    PLAYBUF      

;********************************************************************************
; PLYBEEP - Play beep when prompting user and during startup
;********************************************************************************
PLYBEEP ldx   7         
	tcy   0         
	tcmiy 0         
	ldx   6         
	tcy   0         
	tcmiy 2         
	ldx   5         
	tcy   0         
	tcmiy 0         
	ldx   4         
	tcy   0         
	tcmiy 2         
	ldp   0         
	br    PLAYBUF      

;---------------------
; chapter 3 page 14
;---------------------
LF80    ldp   13        
	br    PLYBEEP   

;********************************************************************************
; PLWFOOD - Play the Low Food notification at the beginning of a turn
;********************************************************************************
PLWFOOD call  SFBE      
	call  SFBE      
	call  SFBE      
	ldp   4         
	br    LD0C      
;
; One of the three riffs for the low food warning (called three times)
;
SFBE    ldx   6         
	tcy   0         ; 6/0 - 0 1 2 3 4 4 5 6 7 8
	tcmiy 0         
	tcmiy 1         
	tcmiy 2         
	tcmiy 3         
	tcmiy 4         
	tcmiy 4         
	tcmiy 5         
	tcmiy 6         
	tcmiy 7         
	tcmiy 8         
	ldx   7         
	tcy   0         ; 7/0 - 7 5 4 2 1 15 15 13 12 10
	tcmiy 7         
	tcmiy 5         
	tcmiy 4         
	tcmiy 2         
	tcmiy 1         
	tcmiy 15        
	tcmiy 15        
	tcmiy 13        
	tcmiy 12        
	tcmiy 10        
	ldx   4         
	tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1 1
SFB8    tcmiy 1         
	ynec  10        
	br    SFB8      
	ldx   5         
	tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0 0
SF9B    tcmiy 0         
	ynec  10        
	br    SF9B      
	ldp   0         
	br    PLAYBUF      

;********************************************************************************
; PLYCLR - Play the hi/lo siren when player presses Clear
;********************************************************************************
PLYCLR  ldx   6         
	tcy   0         ; 6/0 - 1 3 1 3 1 3 1 3
SFA4    tcmiy 1         
	tcmiy 3         
	ynec  8         
	br    SFA4      
	ldx   7         
	tcy   0         ; 7/0 - 9 15 9 15 9 15 9 15
SF93    tcmiy 9         
	tcmiy 15        
	ynec  8         
	br    SF93      
	ldx   4         
	tcy   0         ; 4/0 - 10 5 10 5 10 5 10 5
SF8A    tcmiy 10        
	tcmiy 5         
	ynec  8         
	br    SF8A      
	ldx   5         
	ldp   15        
	br    LFC0      
;---------------------
; chapter 3 page 15
;---------------------
LFC0    tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0
SFC1    tcmiy 0         
	ynec  8         
	br    SFC1      
	ldp   0         
	br    PLAYBUF      

LFFF    call  SFE5      
	ldp   1         
	tpc             
	ldp   11        
	call  L6C0      
	call  SFE6      
	ldx   4         
	tcmiy 1         
	tcmiy 7         
	tcmiy 6         
	call  SFE2      
	ldp   0         
	tpc             
	ldp   10        
	call  L28C      
	ldp   1         
	tpc             
	ldp   14        
	call  L79B      
	call  SFE5      
	ldp   1         
	tpc             
	ldp   6         
	call  CPY2TO5   ; Save current player Warrior count
	call  SFE6      ; Add 4 to 5
	call  SFE5      ; Copy 5 to 4
	call  SFE2      ; Add 4 again
	call  SFE5      ; Copy 5 to 4
	call  SFE2      ; Add 4 again
	call  SFE5      ; Copy 5 to 4
	ldp   0         
	tpc             
	ldp   11        
	call  L2F3      
	ldp   0         
	tpc             
	ldp   12        
	call  L33F      
	ldp   2         
	tpc             
	ldp   14        
	br    LB89      
SFE2    ldp   0         
	tpc             
	ldp   4         
	br    SUMB10    
SFE6    ldp   0         
	tpc             
	ldp   4         
	br    AD2B10    
SFE5    ldp   1         
	tpc             
	ldp   12        
	br    CPY5TO4   
SFD4    tcmiy 5         
	tamiyc          
	br    LFC0      
	br    SFD4      

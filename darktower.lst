                 1 	
                 2 ; *** Chapter 0 page 0	
                 3 	
                 4 ;	
                 5 ; Resynchronize barrel position storage at 0/0	
                 6 ;	
0:0:00 000:28    7 S000    ldx   0         	
0:0:01 001:21    8         tma             ; Pick up current barrel position from 0/0	
0:0:03 003:71    9         a9aac           	
0:0:07 007:BE   10         br    S03E      ; Position was invalid (>6)	
0:0:0F 00F:61   11 S00F    tcmiy 8         ; Invalidate 0/0	
0:0:1F 01F:40   12         tcy   0         	
0:0:3F 03F:9B   13         br    S01B      ; Fall through to finish this move	
0:0:3E 03E:60   14 S03E    tcmiy 0         ; Reset 0/0 (current barrel position) to 0	
                15 	
                16 ;	
                17 ; Rotate the drum to the position targeted in 4/0	
                18 ; Current position is in 0/0	
                19 ;	
0:0:3D 03D:28   20 S03D    ldx   0         	
0:0:3B 03B:40   21         tcy   0         	
0:0:37 037:21   22         tma             	
0:0:2F 02F:29   23         ldx   4         	
0:0:1E 01E:00   24         mnea            ; Check to see if we're already in the right position	
0:0:3C 03C:B3   25         br    S033      	
0:0:39 039:0F   26         retn            	
                27 	
0:0:33 033:18   28 S033    ldp   1         	
0:0:27 027:C0   29         call  ROTONE        ; Rotate tower one step	
0:0:0E 00E:2D   30         ldx   5         	
0:0:1D 01D:40   31         tcy   0         	
0:0:3A 03A:21   32         tma             ; Check rotation timer high nibble at 5/0	
0:0:35 035:2C   33         ldx   1         	
0:0:2B 02B:01   34         alem            ; against max threshold high nibble at 1/0	
0:0:16 016:98   35         br    S018      	
0:0:2C 02C:80   36         br    S000      ; Rotation exceeded threshold - this is the first (index) position on the barrel	
0:0:18 018:00   37 S018    mnea            	
0:0:30 030:9C   38         br    S01C      ; 5/0 is less than 1/0 - move was successful	
0:0:21 021:2B   39         ldx   6         	
0:0:02 002:21   40         tma             ; Check rotation timer low nibble at 6/0	
0:0:05 005:2A   41         ldx   2         	
0:0:0B 00B:01   42         alem            ; against max threshold low nibble at 2/0	
0:0:17 017:9C   43         br    S01C      ; Below threshold - move was successful	
0:0:2E 02E:80   44         br    S000      ; Highs were equal but low was greater than low threshold - this is the first position	
0:0:1C 01C:28   45 S01C    ldx   0         	
0:0:38 038:21   46         tma             ; Pick up previous barrel position from 0/0 (0-6 are valid values)	
0:0:31 031:71   47         a9aac           ; Add 9 to perform mod 7 math	
0:0:23 023:8F   48         br    S00F      ; Result is 16 or greater with an overflow (barrel wrapped around to position 0)	
0:0:06 006:3E   49         imac            ; Increment barrel position	
0:0:0D 00D:27   50         tam             ; and update 0/0	
                51 ;	
                52 ; Adjust barrel rotation timer max based on how long last movement took (accommodates battery drain)	
                53 ;	
                54 ; Barrel rotation timer is important as it allows the game to distinguish between the normal	
                55 ; index marks and the 0 index mark (which is wider).	
                56 ;	
0:0:1B 01B:2B   57 S01B    ldx   6         	
0:0:36 036:21   58         tma             	
0:0:2D 02D:06   59         amaac           	
0:0:1A 01A:91   60         br    S011      	
0:0:34 034:2A   61         ldx   2         	
0:0:29 029:27   62         tam             	
0:0:12 012:2D   63         ldx   5         	
0:0:24 024:21   64         tma             	
0:0:08 008:A6   65         br    S026      	
0:0:11 011:2A   66 S011    ldx   2         	
0:0:22 022:27   67         tam             	
0:0:04 004:2D   68         ldx   5         	
0:0:09 009:3E   69         imac            	
0:0:13 013:8A   70         br    S00A      	
0:0:26 026:06   71 S026    amaac           	
0:0:0C 00C:8A   72         br    S00A      	
0:0:19 019:2C   73         ldx   1         	
0:0:32 032:27   74         tam             	
0:0:25 025:BD   75         br    S03D      	
0:0:0A 00A:2A   76 S00A    ldx   2         	
0:0:15 015:67   77         tcmiy 14        	
0:0:2A 02A:2C   78         ldx   1         	
0:0:14 014:40   79         tcy   0         	
0:0:28 028:6F   80         tcmiy 15        	
0:0:10 010:BD   81         br    S03D      	
0:0:20 020:00   82         mnea            	
                83 	
                84 ; *** Chapter 0 page 1	
                85 	
                86 ;	
                87 ; Low-level motor control.  Move tower one step.	
                88 ;	
0:1:00 040:41   89 ROTONE  tcy   8         ; Select the Rotation Sensor	
0:1:01 041:0D   90         setr            	
0:1:03 043:49   91         tcy   9         ; Select the Motor and turn it on	
0:1:07 047:0D   92         setr            	
0:1:0F 04F:2B   93         ldx   6         	
0:1:1F 05F:40   94         tcy   0         	
0:1:3F 07F:60   95         tcmiy 0         ; Zero out Debounce counter low at 6/0	
0:1:3E 07E:2D   96         ldx   5         	
0:1:3D 07D:40   97         tcy   0         	
0:1:3B 07B:60   98         tcmiy 0         ; Zero out Debounce counter high at 5/0	
0:1:37 077:08   99 S077    tka             ; Check Rotation Sensor	
0:1:2F 06F:77  100         dan             	
0:1:1E 05E:8E  101         br    DEBOUNC      	
0:1:3C 07C:B7  102         br    S077      ; Loop until sensor triggers (next position reached)	
0:1:39 079:2B  103 S079    ldx   6         	
0:1:33 073:6F  104         tcmiy 15        ; Set Debounce counter low at 6/0 to 15 (5/0 was incremented)	
0:1:27 067:B1  105         br    S071      	
               106 ;	
               107 ; Debounce Rotation Sensor's signal to make sure it's not just noise	
               108 ;	
0:1:0E 04E:4A  109 DEBOUNC tcy   5         ; Set up for a tight loop - 40x	
0:1:1D 05D:23  110         tya             	
0:1:3A 07A:41  111         tcy   8         	
0:1:35 075:04  112 S075    dyn             	
0:1:2B 06B:B5  113         br    S075      	
0:1:16 056:77  114         dan             	
0:1:2C 06C:B5  115         br    S075      	
0:1:18 058:2B  116         ldx   6         	
0:1:30 070:40  117         tcy   0         	
0:1:21 061:3E  118         imac            ; Increment Debounce counter low at 6/0 to prevent infinite loop	
0:1:02 042:8B  119         br    S04B        ; Debounce counter low at 6/0 overflowed      	
0:1:05 045:B8  120         br    S078	
0:1:0B 04B:27  121 S04B    tam             	
0:1:17 057:2D  122         ldx   5         	
0:1:2E 06E:3E  123         imac            	
0:1:1C 05C:B9  124         br    S079      	
0:1:38 078:27  125 S078    tam             	
0:1:31 071:08  126 S071    tka             ; Wait for Rotation Sensor pulse to end	
0:1:23 063:77  127         dan             	
0:1:06 046:8E  128         br    DEBOUNC   ; Hasn't ended yet...	
0:1:0D 04D:41  129         tcy   8         ; Select Rotation Sensor and turn it off	
0:1:1B 05B:0C  130         rstr            	
0:1:36 076:49  131         tcy   9         ; Select Motor and turn it off	
0:1:2D 06D:0C  132         rstr            	
0:1:1A 05A:0F  133         retn            	
               134 	
               135 ;	
               136 ; RANDOM routine continues	
               137 ;	
0:1:34 074:21  138 S074    tma             ; Pick up value at 3/0, 3/1, 3/2	
0:1:29 069:29  139         ldx   4         	
0:1:12 052:06  140         amaac           ; Add 4/0, 4/1, 4/2 to it	
0:1:24 064:D5  141         call  S055      ; Increment 6/0, 6/1, 6/2 if carry	
0:1:08 048:2D  142         ldx   5         	
0:1:11 051:06  143         amaac           ; Add 5/0, 5/1, 5/2 to it	
0:1:22 062:D5  144         call  S055      ; Increment 6/0, 6/1, 6/2 if carry	
0:1:04 044:2B  145         ldx   6         	
0:1:09 049:06  146         amaac           ; Add 6/0, 6/1, 6/2 to it	
0:1:13 053:D5  147         call  S055      ; Increment 6/0, 6/1, 6/2 if carry	
0:1:26 066:2E  148         ldx   3         	
0:1:0C 04C:25  149         tamiyc          ; Store it at 3/0, 3/1, 3/2 then increment Y	
0:1:19 059:5C  150         ynec  3         ; We done doing 0-2?	
0:1:32 072:B4  151         br    S074      ; Nope, do the next column	
0:1:25 065:44  152         tcy   2         	
0:1:0A 04A:0F  153         retn            	
               154 	
0:1:15 055:05  155 S055    iyc             	
0:1:2A 06A:2B  156         ldx   6         	
0:1:14 054:03  157         xma             	
0:1:28 068:70  158         iac             	
0:1:10 050:1E  159         ldp   7         	
0:1:20 060:94  160         br    L1D4      ; xma, dyn, retn	
               161 	
               162 ; *** Chapter 0 page 2	
               163 	
               164 ;	
               165 ; Using the R output in A, scan the K inputs to find a key pressed	
               166 ;	
               167 ; For some reason the R output we're looking at is stored in 6/13 with the high-order bit set.	
               168 ;	
0:2:00 080:4B  169 S080    tcy   13        	
0:2:01 081:27  170         tam             ; Save the R output we're using at 6/13	
0:2:03 083:7E  171         a8aac           ; Toggle high-order bit	
0:2:07 087:9F  172         br    S09F      ; There should have been a carry due to the way it's stored	
0:2:0F 08F:7E  173         a8aac           ; Nope, add 8 again to get it back (?)	
0:2:1F 09F:20  174 S09F    tay             	
0:2:3F 0BF:0D  175         setr            ; Set R output addressed by Y	
0:2:3E 0BE:08  176         tka             ; Pick up K inputs from keyboard	
0:2:3D 0BD:0C  177         rstr            ; Reset R output addressed by Y	
0:2:3B 0BB:47  178         tcy   14        	
0:2:37 0B7:03  179         xma             ; Exchange 6/14 and results of TKA - Look at the last key read	
               180 	
0:2:2F 0AF:38  181         tbit1 0         ; Keyboard row 1 - Dark Tower/Frontier/Inventory - set? (3/7/11)	
0:2:1E 09E:AE  182         br    S0AE      ; Add 3 to accumulator	
               183 	
0:2:3C 0BC:3B  184         tbit1 3         ; Keyboard row 2 - Tomb-Ruin/Move/Sanctuary-Citadel - set? (2/6/10)	
0:2:39 0B9:9C  185         br    S09C      ; Add 2 to accumulator	
               186 	
0:2:33 0B3:39  187         tbit1 2         ; Keyboard row 3 - Haggle/Bazaar/Clear - set? (1/5/9)	
0:2:27 0A7:B8  188         br    S0B8      ; Add 1 to accumulator	
               189 	
0:2:0E 08E:3A  190         tbit1 1         ; Keyboard row 4 - Yes-Buy/Repeat/No-End - set? (0/4/8)	
0:2:1D 09D:B1  191         br    S0B1      ; Add nothing to accumulator	
               192 	
               193 ;	
               194 ; No keys were detected, fall through	
               195 ;	
0:2:3A 0BA:7C  196         a4aac           ; Nothing was read? - A = 4	
0:2:35 0B5:27  197         tam             ; Save results at 6/14	
               198 ;	
               199 ; Entry point for keyboard read routine.  Loop through the R output and scan the K inputs at S080	
               200 ;	
0:2:2B 0AB:4B  201 READKBD tcy   13        	
0:2:16 096:07  202         dman            ; Pick up the last R output we looked at and subtract one	
0:2:2C 0AC:B0  203         br    S0B0      ; We're not done scanning	
0:2:18 098:85  204         br    S085      	
0:2:30 0B0:20  205 S0B0    tay             	
0:2:21 0A1:5E  206         ynec  7         	
0:2:02 082:80  207         br    S080      ; Go back and scan the next R output	
               208 	
0:2:05 085:47  209 S085    tcy   14        	
0:2:0B 08B:21  210         tma             ; Load 6/14 (last key pressed)	
0:2:17 097:B1  211         br    S0B1      	
               212 	
0:2:2E 0AE:70  213 S0AE    iac             	
0:2:1C 09C:70  214 S09C    iac             	
0:2:38 0B8:70  215 S0B8    iac             	
0:2:31 0B1:4F  216 S0B1    tcy   15        	
0:2:23 0A3:03  217         xma             ; Swap 6/15 with results	
0:2:06 086:00  218         mnea            ; Compare this result to the last result	
0:2:0D 08D:8A  219         br    S08A      ; Go back to prompt routine if they're different	
               220 	
0:2:1B 09B:20  221         tay             	
0:2:36 0B6:53  222         ynec  12        	
0:2:2D 0AD:91  223         br    S091      	
0:2:1A 09A:4B  224         tcy   13        	
0:2:34 0B4:33  225         sbit  3         ; Set 6/13 bit 3 - a key has been pressed, prep for click sound	
0:2:29 0A9:43  226         tcy   12        	
0:2:12 092:38  227         tbit1 0         ; 6/12 bit 0 set (do not update display)?	
0:2:24 0A4:8A  228         br    S08A      ; Go back to prompt routine	
0:2:08 088:89  229         br    S089      ; Success, return?	
               230 	
0:2:11 091:43  231 S091    tcy   12        	
0:2:22 0A2:38  232         tbit1 0         ; 6/12 bit 0 set (do not update display)?	
0:2:04 084:99  233         br    S099      	
               234 	
0:2:09 089:7F  235 S089    cla             	
0:2:13 093:77  236         dan             	
0:2:26 0A6:15  237         ldp   10        	
0:2:0C 08C:A2  238         br    L2A2      ; TDO, pick up value in 6/15 to Y and return	
               239 	
0:2:19 099:4B  240 S099    tcy   13        	
0:2:32 0B2:3B  241         tbit1 3         ; 6/13 bit 3 set (keypress detected)?	
0:2:25 0A5:AA  242         br    S0AA      	
0:2:0A 08A:1E  243 S08A    ldp   7         	
0:2:15 095:86  244         br    L1C6      ; Jump back into prompt routine and refresh the LEDs some more	
               245 	
0:2:2A 0AA:1C  246 S0AA    ldp   3         	
0:2:14 094:0B  247         tpc             	
0:2:28 0A8:18  248         ldp   1         	
0:2:10 090:EC  249         call  PLYTICK   ; Make the keypress "tick" sound	
0:2:20 0A0:89  250         br    S089      	
               251 	
               252 	
               253 ; *** Chapter 0 page 3	
               254 	
               255 ;********************************************************************************	
               256 ; RANDOM 	
               257 ;	
               258 ; Generate a random number based on the seed at 3/0-2 and 4/0-2	
               259 ; 5/0-2 and 6/0-2 are overwritten.	
               260 ;	
               261 ; Return value in A (0-F); Y=2	
               262 ;	
               263 ; The formula is:	
               264 ;	
               265 ; 3/0 * 2 -> 4/0 * 2 -> 5/1	
               266 ; 3/1 * 2 -> 4/1 * 2 -> 5/2	
               267 ; 3/2 * 2 -> 4/2	
               268 ; 3/0 + 4/0 + 5/0 + 6/0 -> 3/0 using 6/0 as carry	
               269 ; 3/1 + 4/1 + 5/1 + 6/1 -> 3/1 using 6/1 as carry	
               270 ; 3/2 + 4/2 + 5/2 + 6/2 -> 3/2 using 6/2 as carry	
               271 ;	
               272 ; Example: 3/0 = 0; 3/1 = 1; 3/2 = 2	
               273 ;          4/0 = 0; 4/1 = 0	
               274 ;	
               275 ; Results:  0 1 2    Y=2; A=A	
               276 ;           -----	
               277 ;         3|0 3 A	
               278 ;         4|0 2 4	
               279 ;         5|0 0 4	
               280 ;         6|0 0 0	
               281 ;********************************************************************************	
0:3:00 0C0:2D  282 RANDOM  ldx   5         	
0:3:01 0C1:D5  283         call  S0D5      ; Clear 5/0-2	
0:3:03 0C3:2B  284         ldx   6         	
0:3:07 0C7:D5  285         call  S0D5      ; Clear 6/0-2	
0:3:0F 0CF:2E  286         ldx   3         	
0:3:1F 0DF:40  287         tcy   0         	
0:3:3F 0FF:21  288         tma             ; Pick up value at 3/0 (Starting value)	
0:3:3E 0FE:06  289         amaac           ; Double it	
0:3:3D 0FD:89  290         br    S0C9      ; Branch if it overflowed	
0:3:3B 0FB:29  291         ldx   4         	
0:3:37 0F7:27  292         tam             ; Save it at 4/0	
0:3:2F 0EF:06  293 S0EF    amaac           ; Double it	
0:3:1E 0DE:A9  294         br    S0E9      ; Branch if it overflowed	
0:3:3C 0FC:2D  295         ldx   5         	
0:3:39 0F9:48  296         tcy   1         	
0:3:33 0F3:27  297         tam             ; Save doubled value at 5/1	
0:3:27 0E7:2E  298 S0E7    ldx   3         	
0:3:0E 0CE:21  299         tma             ; Pick up value at 3/1 (Starting value)	
0:3:1D 0DD:06  300         amaac           ; Double it	
0:3:3A 0FA:A3  301         br    S0E3      ; Branch if it overflowed	
0:3:35 0F5:29  302         ldx   4         	
0:3:2B 0EB:27  303         tam             ; Save doubled value at 4/1	
0:3:16 0D6:06  304 S0D6    amaac           ; Double it	
0:3:2C 0EC:2D  305         ldx   5         	
0:3:18 0D8:44  306         tcy   2         	
0:3:30 0F0:27  307         tam             ; Save it at 5/2	
0:3:21 0E1:2E  308         ldx   3         	
0:3:02 0C2:21  309         tma             ; Pick up value at 3/2 (Starting value)	
0:3:05 0C5:06  310         amaac           ; Double it	
0:3:0B 0CB:29  311         ldx   4         	
0:3:17 0D7:27  312         tam             ; Save it at 4/2	
0:3:2E 0EE:2E  313         ldx   3         	
0:3:1C 0DC:40  314         tcy   0         	
0:3:38 0F8:18  315         ldp   1         	
0:3:31 0F1:B4  316         br    S074      ; Out of room here...	
               317 	
0:3:23 0E3:29  318 S0E3    ldx   4         ; 3/1 doubling caused an overflow...	
0:3:06 0C6:25  319         tamiyc          ; Save doubled value at 4/1	
0:3:0D 0CD:2B  320         ldx   6         	
0:3:1B 0DB:3E  321         imac            	
0:3:36 0F6:24  322         tamdyn          ; Add one to 6/2	
0:3:2D 0ED:29  323         ldx   4         	
0:3:1A 0DA:21  324         tma             ; Pick up 4/1	
0:3:34 0F4:96  325         br    S0D6      ; Go back and deal with the next digit	
0:3:29 0E9:2D  326 S0E9    ldx   5         	
0:3:12 0D2:48  327         tcy   1         	
0:3:24 0E4:25  328         tamiyc          	
0:3:08 0C8:2B  329         ldx   6         	
0:3:11 0D1:3E  330         imac            	
0:3:22 0E2:24  331         tamdyn          	
0:3:04 0C4:A7  332         br    S0E7      	
0:3:09 0C9:29  333 S0C9    ldx   4         ; 3/0 doubling caused an overflow	
0:3:13 0D3:25  334         tamiyc          ; Save doubled value at 4/0	
0:3:26 0E6:2B  335         ldx   6         	
0:3:0C 0CC:68  336         tcmiy 1         ; Store a 1 at 6/1	
0:3:19 0D9:64  337         tcmiy 2         ; Store a 2 at 6/2	
0:3:32 0F2:29  338         ldx   4         	
0:3:25 0E5:40  339         tcy   0         	
0:3:0A 0CA:AF  340         br    S0EF      ; Go back and deal with the next digit	
               341 	
0:3:15 0D5:40  342 S0D5    tcy   0         	
0:3:2A 0EA:60  343         tcmiy 0         	
0:3:14 0D4:60  344         tcmiy 0         	
0:3:28 0E8:60  345         tcmiy 0         	
0:3:10 0D0:0F  346         retn            	
               347 	
0:3:20 0E0:00  348         mnea            	
               349 	
               350 ; *** Chapter 0 page 4	
               351 	
               352 ;********************************************************************************	
               353 ; AD2B10	
               354 ;	
               355 ; Perform Base 10 arithmetic on values in scratchpad RAM 4/1-2 and 5/1-2	
               356 ;	
               357 ; Add the two-digit base 10 number encoded in 4/1 and 4/2 to the two-digit 	
               358 ; base 10 number encoded in 5/1 and 5/2 giving a three-digit base-10 number	
               359 ; encoded in 5/0-2.	
               360 ;	
               361 ; For example:   0 1 2     (x means doesn't matter--overwritten)	
               362 ;              4 x 1 9	
               363 ;              5 x 2 2	
               364 ;	
               365 ; Returns:       0 1 2	
               366 ;              4 0 1 9	
               367 ;              5 0 4 1	
               368 ;********************************************************************************	
0:4:00 100:2D  369 AD2B10  ldx   5         	
0:4:01 101:40  370         tcy   0         	
0:4:03 103:60  371         tcmiy 0         ; 5/0 = 0	
0:4:07 107:29  372 L107    ldx   4         	
0:4:0F 10F:40  373         tcy   0         	
0:4:1F 11F:60  374         tcmiy 0         ; 4/0 = 0	
0:4:3F 13F:7F  375 SUMB10  cla             ; SUMB10 - don't initialize 100s digit	
0:4:3E 13E:44  376         tcy   2         ; Start at 4/2 with A=0	
               377 ;	
               378 ; Perform (4/Y + 5/Y) mod 10	
               379 ;	
0:4:3D 13D:29  380 S13D    ldx   4         	
0:4:3B 13B:06  381         amaac           	
0:4:37 137:2D  382         ldx   5         	
0:4:2F 12F:06  383         amaac           ; A = 4/Y + 5/Y (Y = 2-0)	
0:4:1E 11E:9D  384         br    S11D      ; Overflow?	
0:4:3C 13C:7A  385         a6aac           ; Add 6 to Accumulator - (do a MOD 10 operation; is the result >= 10?)	
0:4:39 139:BA  386         br    S13A      ; Yes	
               387 	
0:4:33 133:79  388         a10aac          ; Add 10 to Accumulator - (effectively back out the A6AAC operation)	
0:4:27 127:26  389         tamza           ; Save to 5/Y (Y = 2-0)	
0:4:0E 10E:AB  390         br    S12B      	
0:4:1D 11D:7A  391 S11D    a6aac           	
0:4:3A 13A:26  392 S13A    tamza           	
0:4:35 135:70  393         iac             	
0:4:2B 12B:04  394 S12B    dyn             	
0:4:16 116:BD  395         br    S13D      	
0:4:2C 12C:40  396         tcy   0         	
0:4:18 118:0F  397         retn            	
               398 	
               399 ;	
               400 ; Generate a random number between 17 and 32 - used to give a base Brigand count	
               401 ;	
0:4:30 130:1C  402 L130    ldp   3         	
0:4:21 121:C0  403         call  RANDOM    ; Get a random number in ACC	
0:4:02 102:29  404         ldx   4         	
0:4:05 105:48  405         tcy   1         	
0:4:0B 10B:60  406         tcmiy 0         ; 4/1 = 0	
0:4:17 117:29  407         ldx   4         	
0:4:2E 12E:24  408         tamdyn          ; 4/2 = ACC	
0:4:1C 11C:2D  409         ldx   5         	
0:4:38 138:60  410         tcmiy 0         ; 5/1 = 0	
0:4:31 131:60  411         tcmiy 0         ; 5/2 = 0	
0:4:23 123:12  412         ldp   4         	
0:4:06 106:C0  413         call  AD2B10    ; Copy random number to 5/2 via addition (?!)	
0:4:0D 10D:29  414         ldx   4         	
0:4:1B 11B:48  415         tcy   1         	
0:4:36 136:68  416         tcmiy 1         ; 4/1 = 1	
0:4:2D 12D:6E  417         tcmiy 7         ; 4/2 = 7	
0:4:1A 11A:12  418         ldp   4         	
0:4:34 134:80  419         br    AD2B10    ; Add 17 and return	
               420 	
               421 ;	
               422 ; Generate a random number between 9 and 16.  Used by Santuary to calculate	
               423 ; how much food or gold to provide the player.	
               424 ;	
0:4:29 129:1C  425 L129    ldp   3         	
0:4:12 112:C0  426         call  RANDOM    	
0:4:24 124:29  427         ldx   4         	
0:4:08 108:24  428         tamdyn          ; 4/2 = ACC	
0:4:11 111:60  429         tcmiy 0         ; 4/1 = 0	
0:4:22 122:37  430         rbit  3         ; Limit 4/2 to 0-7	
0:4:04 104:2D  431         ldx   5         	
0:4:09 109:48  432         tcy   1         	
0:4:13 113:60  433         tcmiy 0         ; 5/1 = 0	
0:4:26 126:69  434         tcmiy 9         ; 5/2 = 9	
0:4:0C 10C:C0  435         call  AD2B10    	
0:4:19 119:18  436         ldp   1         	
0:4:32 132:0B  437         tpc             	
0:4:25 125:13  438         ldp   12        	
0:4:0A 10A:A7  439         br    CPY5TO4   ; Be neat about it and copy the amount up to the top of the formula	
               440 	
               441 ;	
               442 ; Add 16 to 5/1-2	
               443 ;	
0:4:15 115:29  444 ADD16   ldx   4         	
0:4:2A 12A:48  445         tcy   1         	
0:4:14 114:68  446         tcmiy 1         ; 4/1 = 16	
0:4:28 128:66  447         tcmiy 6         	
0:4:10 110:12  448         ldp   4         	
0:4:20 120:80  449         br    AD2B10    	
               450 	
               451 ; *** Chapter 0 page 5	
               452 	
               453 ;********************************************************************************	
               454 ; DSPRSLT	
               455 ;	
               456 ; Display the results of an encounter or inventory	
               457 ; Called after encounter as well as when Repeat button is hit	
               458 ;	
               459 ; Note about status flags.  The tests assume the bit being set means	
               460 ; the inventory doesn't need to be shown.  Cleared means display the	
               461 ; current status.	
               462 ;********************************************************************************	
0:5:00 140:29  463 DSPRSLT ldx   4         	
0:5:01 141:4B  464         tcy   13        	
0:5:03 143:38  465         tbit1 0         ; Warrior count change during encounter	
0:5:07 147:B3  466         br    S173      	
               467 ;	
               468 ; Display Warrior count	
               469 ;	
0:5:0F 14F:48  470         tcy   1         ; Switch drum to Warrior/Food/Beast position	
0:5:1F 15F:11  471         ldp   8         	
0:5:3F 17F:D5  472         call  ROTDRUM   	
0:5:3E 17E:18  473         ldp   1         	
0:5:3D 17D:0B  474         tpc             	
0:5:3B 17B:16  475         ldp   6         	
0:5:37 177:F2  476         call  CPY2TO5   ; Copy the warrior count for current player to 5/1 and 5/2	
0:5:2F 16F:11  477         ldp   8         	
0:5:1E 15E:E4  478         call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2	
0:5:3C 17C:19  479         ldp   9         	
0:5:39 179:C1  480         call  L241      ; Light top window and update display from display buffer???	
               481 	
0:5:33 173:29  482 S173    ldx   4         	
0:5:27 167:4B  483         tcy   13        	
0:5:0E 14E:3A  484         tbit1 1         ; Food change during encounter	
0:5:1D 15D:97  485         br    S157      	
               486 ;	
               487 ; Display Food	
               488 ;	
0:5:3A 17A:48  489         tcy   1         ; Switch drum to Warrior/Food/Beast position	
0:5:35 175:11  490         ldp   8         	
0:5:2B 16B:D5  491         call  ROTDRUM   	
0:5:16 156:18  492         ldp   1         	
0:5:2C 16C:0B  493         tpc             	
0:5:18 158:13  494         ldp   12        	
0:5:30 170:EC  495         call  CPY1TO5   ; Copy the gold amount for current player to 5/1 and 5/2	
0:5:21 161:11  496         ldp   8         	
0:5:02 142:E4  497         call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2	
0:5:05 145:19  498         ldp   9         	
0:5:0B 14B:DF  499         call  L25F      	
               500 	
0:5:17 157:29  501 S157    ldx   4         	
0:5:2E 16E:4B  502         tcy   13        	
0:5:1C 15C:3B  503         tbit1 3         ; Beast found during encounter	
0:5:38 178:92  504         br    S152      	
               505 ;	
               506 ; Display Beast	
               507 ;	
0:5:31 171:2C  508         ldx   1         	
0:5:23 163:4C  509         tcy   3         	
0:5:06 146:38  510         tbit1 0         ; Check inventory for Beast	
0:5:0D 14D:B6  511         br    S176      	
0:5:1B 15B:92  512         br    S152      	
0:5:36 176:48  513 S176    tcy   1         ; Switch drum to Warrior/Food/Beast position	
0:5:2D 16D:11  514         ldp   8         	
0:5:1A 15A:D5  515         call  ROTDRUM   	
0:5:34 174:19  516         ldp   9         	
0:5:29 169:FD  517         call  LTLWRCL   ; Light lower window	
               518 	
0:5:12 152:29  519 S152    ldx   4         	
0:5:24 164:47  520         tcy   14        	
0:5:08 148:38  521         tbit1 0         ; Scout found during encounter	
0:5:11 151:95  522         br    S155      	
               523 ;	
               524 ; Display Scout	
               525 ;	
0:5:22 162:2C  526         ldx   1         	
0:5:04 144:4C  527         tcy   3         	
0:5:09 149:3B  528         tbit1 3         ; Check inventory for Scout	
0:5:13 153:8C  529         br    S14C      	
0:5:26 166:95  530         br    S155      	
0:5:0C 14C:44  531 S14C    tcy   2         ; Switch drum to Scout/Healer/Gold position	
0:5:19 159:11  532         ldp   8         	
0:5:32 172:D5  533         call  ROTDRUM   	
0:5:25 165:19  534         ldp   9         	
0:5:0A 14A:C0  535         call  LTTOPCL   ; Light Scout and clear display	
               536 	
0:5:15 155:29  537 S155    ldx   4         	
0:5:2A 16A:47  538         tcy   14        	
0:5:14 154:16  539         ldp   6         	
0:5:28 168:3A  540         tbit1 1         ; Healer found during encounter?	
0:5:10 150:B7  541         br    L1B7      	
0:5:20 160:80  542         br    S180	
               543 	
               544 	
               545 ; *** Chapter 0 page 6	
               546 	
               547 ;	
               548 ; Display Healer	
               549 ;	
0:6:00 180:2C  550 S180    ldx   1         	
0:6:01 181:4C  551         tcy   3         	
0:6:03 183:3A  552         tbit1 1         ; Check inventory for Healer	
0:6:07 187:9F  553         br    S19F      	
0:6:0F 18F:B7  554         br    L1B7      	
0:6:1F 19F:44  555 S19F    tcy   2         ; Switch drum to Scout/Healer/Gold position	
0:6:3F 1BF:11  556         ldp   8         	
0:6:3E 1BE:D5  557         call  ROTDRUM   	
0:6:3D 1BD:19  558         ldp   9         	
0:6:3B 1BB:CF  559         call  LTMIDCL   ; Light Healer and clear display	
               560 	
0:6:37 1B7:29  561 L1B7    ldx   4         	
0:6:2F 1AF:4B  562         tcy   13        	
0:6:1E 19E:39  563         tbit1 2         ; Gold found during encounter?	
0:6:3C 1BC:B0  564         br    S1B0      	
               565 ;	
               566 ; Display Gold	
               567 ;	
0:6:39 1B9:44  568         tcy   2         ; Switch drum to Scout/Healer/Gold position	
0:6:33 1B3:11  569         ldp   8         	
0:6:27 1A7:D5  570         call  ROTDRUM   	
0:6:0E 18E:18  571         ldp   1         	
0:6:1D 19D:0B  572         tpc             	
0:6:3A 1BA:13  573         ldp   12        	
0:6:35 1B5:D7  574         call  CPY0TO5   	
0:6:2B 1AB:11  575         ldp   8         	
0:6:16 196:E4  576         call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2	
0:6:2C 1AC:19  577         ldp   9         	
0:6:18 198:FB  578         call  L27B      ; Light bottom window and update display from display buffer???	
               579 	
0:6:30 1B0:29  580 S1B0    ldx   4         	
0:6:21 1A1:4F  581         tcy   15        	
0:6:02 182:38  582         tbit1 0         ; Gold Key found during encounter?	
0:6:05 185:B6  583         br    S1B6      	
               584 ;	
               585 ; Display Gold Key	
               586 ;	
0:6:0B 18B:2A  587         ldx   2         	
0:6:17 197:4C  588         tcy   3         	
0:6:2E 1AE:3B  589         tbit1 3         ; Check inventory for Gold Key	
0:6:1C 19C:B1  590         br    S1B1      	
0:6:38 1B8:B6  591         br    S1B6      	
0:6:31 1B1:4C  592 S1B1    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key	
0:6:23 1A3:11  593         ldp   8         	
0:6:06 186:D5  594         call  ROTDRUM   	
0:6:0D 18D:19  595         ldp   9         	
0:6:1B 19B:C0  596         call  LTTOPCL   ; Light Gold Key and clear display	
               597 	
0:6:36 1B6:29  598 S1B6    ldx   4         	
0:6:2D 1AD:47  599         tcy   14        	
0:6:1A 19A:3B  600         tbit1 3         ; Silver Key found during encounter?	
0:6:34 1B4:8C  601         br    S18C      	
               602 ;	
               603 ; Display Silver Key	
               604 ;	
0:6:29 1A9:2A  605         ldx   2         	
0:6:12 192:4C  606         tcy   3         	
0:6:24 1A4:39  607         tbit1 2         ; Check inventory for Silver Key	
0:6:08 188:A2  608         br    S1A2      	
0:6:11 191:8C  609         br    S18C      	
0:6:22 1A2:4C  610 S1A2    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key	
0:6:04 184:11  611         ldp   8         	
0:6:09 189:D5  612         call  ROTDRUM   	
0:6:13 193:19  613         ldp   9         	
0:6:26 1A6:CF  614         call  LTMIDCL   ; Light Silver Key and clear display	
               615 	
0:6:0C 18C:29  616 S18C    ldx   4         	
0:6:19 199:47  617         tcy   14        	
0:6:32 1B2:1E  618         ldp   7         	
0:6:25 1A5:39  619         tbit1 2         ; Brass Key found during encounter?	
0:6:0A 18A:9F  620         br    L1DF      	
               621 ;	
               622 ; Display Brass Key	
               623 ;	
0:6:15 195:2A  624         ldx   2         	
0:6:2A 1AA:4C  625         tcy   3         	
0:6:14 194:3A  626         tbit1 1         ; Check inventory for Brass Key	
0:6:28 1A8:80  627         br    L1C0      	
0:6:10 190:9F  628         br    L1DF      	
0:6:20 1A0:00  629         mnea            	
               630 	
               631 ; *** Chapter 0 page 7	
               632 	
0:7:00 1C0:4C  633 L1C0    tcy   3         ; Switch drum to Gold Key/Silver Key/Brass Key	
0:7:01 1C1:11  634         ldp   8         	
0:7:03 1C3:D5  635         call  ROTDRUM   	
0:7:07 1C7:19  636         ldp   9         	
0:7:0F 1CF:FD  637         call  LTLWRCL   ; Light lower window	
               638 	
0:7:1F 1DF:29  639 L1DF    ldx   4         	
0:7:3F 1FF:4F  640         tcy   15        	
0:7:3E 1FE:3A  641         tbit1 1         ; Sword resulting from encounter?	
0:7:3D 1FD:BA  642         br    S1FA      	
               643 ;	
               644 ; Display Sword if in inventory	
               645 ;	
0:7:3B 1FB:2C  646         ldx   1         	
0:7:37 1F7:4C  647         tcy   3         	
0:7:2F 1EF:39  648         tbit1 2         ; Check inventory for Sword	
0:7:1E 1DE:B9  649         br    S1F9      	
0:7:3C 1FC:BA  650         br    S1FA      	
0:7:39 1F9:42  651 S1F9    tcy   4         ; Switch drum to Dragon/Sword/Pegasus	
0:7:33 1F3:11  652         ldp   8         	
0:7:27 1E7:D5  653         call  ROTDRUM   	
0:7:0E 1CE:19  654         ldp   9         	
0:7:1D 1DD:CF  655         call  LTMIDCL   ; Light Sword and clear display	
               656 ;	
               657 ; Display Pegasus?	
               658 ;	
               659 ; Note, Pegasus isn't an inventory item so there is no check for it	
               660 ;	
0:7:3A 1FA:29  661 S1FA    ldx   4         	
0:7:35 1F5:4F  662         tcy   15        	
0:7:2B 1EB:39  663         tbit1 2         ; Pegasus resulting from encounter?	
0:7:16 1D6:85  664         br    S1C5      	
               665 	
0:7:2C 1EC:42  666         tcy   4         ; Switch drum to Dragon/Sword/Pegasus	
0:7:18 1D8:11  667         ldp   8         	
0:7:30 1F0:D5  668         call  ROTDRUM   	
0:7:21 1E1:19  669         ldp   9         	
0:7:02 1C2:FD  670         call  LTLWRCL   ; Light lower window	
0:7:05 1C5:0F  671 S1C5    retn            	
               672 	
               673 ;********************************************************************************	
               674 ; PROMPT - Prompt user for input	
               675 ;	
               676 ; Update display with contents of 7/14 and 7/15, flash and wait for keypress	
               677 ;	
               678 ; Return key pressed in Y:	
               679 ;  0 = Yes/Buy          6 = Move	
               680 ;  1 = Haggle           7 = Frontier	
               681 ;  2 = Tomb/Ruin        8 = No/End	
               682 ;  3 = Dark Tower       9 = Clear	
               683 ;  4 = Repeat          10 = Sanctuary/Citadel	
               684 ;  5 = Bazaar          11 = Inventory	
               685 ;********************************************************************************	
0:7:0B 1CB:2B  686 PROMPT  ldx   6         	
0:7:17 1D7:43  687         tcy   12        	
0:7:2E 1EE:30  688         sbit  0         ; Set 6/12 bit 0 to wait for keypress (blocking)	
0:7:1C 1DC:35  689         rbit  2         ; Clear 6/12 bit 2 to set LED display to blink	
0:7:38 1F8:2B  690 L1F8    ldx   6         ; Entrypoint for non-blocking input	
0:7:31 1F1:4B  691         tcy   13        	
0:7:23 1E3:37  692         rbit  3         ; Clear 6/13 bit 3 - a key has not yet been hit	
               693 	
0:7:06 1C6:15  694 L1C6    ldp   10        	
0:7:0D 1CD:C0  695         call  REFRLED   	
0:7:1B 1DB:15  696         ldp   10        	
0:7:36 1F6:C0  697         call  REFRLED   	
0:7:2D 1ED:15  698         ldp   10        	
0:7:1A 1DA:C0  699         call  REFRLED   	
0:7:34 1F4:2E  700         ldx   3         	
0:7:29 1E9:44  701         tcy   2         	
0:7:12 1D2:21  702         tma             	
0:7:24 1E4:76  703         a7aac           	
0:7:08 1C8:CA  704         call  S1CA      	
0:7:11 1D1:27  705         tam             	
               706 ;	
               707 ; Set things up before reading the keyboard - Initialize flags at 6/13 and 6/14	
               708 ;	
0:7:22 1E2:2B  709         ldx   6         	
0:7:04 1C4:4B  710         tcy   13        	
0:7:09 1C9:35  711         rbit  2         ; Enable sound	
0:7:13 1D3:32  712         sbit  1         ; Set state to Waiting for user input	
0:7:26 1E6:30  713         sbit  0         ; Display in Raw format (not BCD)	
               714         	
0:7:0C 1CC:47  715         tcy   14        	
0:7:19 1D9:60  716         tcmiy 0         ; Clear previous key pressed	
0:7:32 1F2:14  717         ldp   2         	
0:7:25 1E5:AB  718         br    READKBD   	
               719 	
0:7:0A 1CA:24  720 S1CA    tamdyn          	
0:7:15 1D5:3E  721         imac            	
0:7:2A 1EA:0F  722         retn            	
               723 	
0:7:14 1D4:03  724 L1D4    xma             	
0:7:28 1E8:04  725         dyn             	
0:7:10 1D0:0F  726         retn            	
               727 	
0:7:20 1E0:00  728         mnea            	
               729 	
               730 ; *** Chapter 0 page 8	
               731 	
               732 ;	
               733 ; Rotate the player RAM buffer so the next player is in the first	
               734 ; position	
               735 ;	
0:8:00 200:28  736 L200    ldx   0         ; Rotate 0/1-12 left three times	
0:8:01 201:F0  737         call  S230      	
0:8:03 203:F0  738         call  S230      	
0:8:07 207:F0  739         call  S230      	
0:8:0F 20F:2C  740         ldx   1         ; Rotate 1/1-12 left three times	
0:8:1F 21F:F0  741         call  S230      	
0:8:3F 23F:F0  742         call  S230      	
0:8:3E 23E:F0  743         call  S230      	
0:8:3D 23D:2A  744         ldx   2         ; Rotate 2/1-12 left three times	
0:8:3B 23B:F0  745         call  S230      	
0:8:37 237:F0  746         call  S230      	
0:8:2F 22F:F0  747         call  S230      	
               748 	
0:8:1E 21E:2E  749         ldx   3         	
0:8:3C 23C:4D  750         tcy   11        	
0:8:39 239:21  751         tma             ; Pick up the current player from 3/11	
0:8:33 233:7D  752         a12aac          ; Add 12 to generate an overflow if we're on player 4	
0:8:27 227:9D  753         br    S21D      ; Overflow, it's P0 right now	
0:8:0E 20E:7C  754         a4aac           ; Add 4 to get us back to where we should be	
               755 	
0:8:1D 21D:70  756 S21D    iac             ; Next player...	
0:8:3A 23A:27  757         tam             ; Update current player at 3/11	
0:8:35 235:49  758         tcy   9         	
0:8:2B 22B:01  759         alem            ; Check that we're not exceeding the total number of players playing	
0:8:16 216:98  760         br    S218      ; We're done	
0:8:2C 22C:80  761         br    L200      ; Oops.  Do another rotation	
               762 	
0:8:18 218:0F  763 S218    retn            	
               764 	
               765 ;	
               766 ; Rotate the current register file words 1-12 left one word	
               767 ;	
0:8:30 230:43  768 S230    tcy   12        ; Start at 12	
0:8:21 221:21  769         tma             ; Get a copy of what's at the current position	
0:8:02 202:04  770         dyn             ; Move pointer left	
0:8:05 205:03  771 S205    xma             ; Swap	
0:8:0B 20B:04  772         dyn             ; Move pointer left	
0:8:17 217:50  773         ynec  0         ; Are we pointing at zero?	
0:8:2E 22E:85  774         br    S205      ; Nope, do it again	
0:8:1C 21C:43  775         tcy   12        ; Final step, copy what was at 1	
0:8:38 238:27  776         tam             ; To 12	
0:8:31 231:0F  777         retn            	
               778 	
               779 ;********************************************************************************	
               780 ; RND0TO2 - Return a random value from 0 to 2 in A	
               781 ;	
               782 ;        11 - 15 - A = 2	
               783 ;        6 - 10 - A = 1	
               784 ;        0 -  5 - A = 0	
               785 ;********************************************************************************	
0:8:23 223:1C  786 RND0TO2 ldp   3         	
0:8:06 206:C0  787         call  RANDOM    	
0:8:0D 20D:48  788 L20D    tcy   1         	
0:8:1B 21B:72  789 S21B    a5aac           	
0:8:36 236:B4  790         br    S234      	
0:8:2D 22D:04  791         dyn             	
0:8:1A 21A:9B  792         br    S21B      	
0:8:34 234:23  793 S234    tya             	
0:8:29 229:70  794         iac             	
0:8:12 212:0F  795         retn            	
               796 	
               797 ;********************************************************************************	
               798 ; BUF2DSP - Load 5/1 and 5/2 into the display buffer 7/14 and 7/15 respectively	
               799 ;********************************************************************************	
0:8:24 224:2D  800 BUF2DSP ldx   5         	
0:8:08 208:48  801         tcy   1         	
0:8:11 211:21  802         tma             	
0:8:22 222:2F  803         ldx   7         	
0:8:04 204:47  804         tcy   14        	
0:8:09 209:27  805         tam             	
0:8:13 213:2D  806         ldx   5         	
0:8:26 226:44  807         tcy   2         	
0:8:0C 20C:21  808         tma             	
0:8:19 219:2F  809         ldx   7         	
0:8:32 232:4F  810         tcy   15        	
0:8:25 225:27  811         tam             	
0:8:0A 20A:0F  812         retn            	
               813 	
               814 ;********************************************************************************	
               815 ; ROTDRUM - Rotate the drum to the position specified in Y	
               816 ;********************************************************************************	
0:8:15 215:23  817 ROTDRUM tya             	
0:8:2A 22A:29  818         ldx   4         	
0:8:14 214:40  819         tcy   0         	
0:8:28 228:27  820         tam             	
0:8:10 210:10  821         ldp   0         	
0:8:20 220:BD  822         br    S03D      	
               823 	
               824 ; *** Chapter 0 page 9	
               825 	
               826 ;********************************************************************************	
               827 ; LTTOPCL - Clear display and light top lamp	
               828 ;********************************************************************************	
0:9:00 240:DA  829 LTTOPCL call  S25A      ; Load blanks into 7/14-15	
0:9:01 241:C8  830 L241    call  S248      ; Set for immediate update of LEDS (6/12 bit 2 set)	
0:9:03 243:4E  831         tcy   7         ; Select upper lamp	
0:9:07 247:AF  832         br    S26F      	
               833 	
               834 ;********************************************************************************	
               835 ; LTMIDCL - Clear display and light middle lamp	
               836 ;********************************************************************************	
0:9:0F 24F:DA  837 LTMIDCL call  S25A      ; Load blanks into 7/14-15	
0:9:1F 25F:C8  838 L25F    call  S248      ; Set for immediate update of LEDS (6/12 bit 2 set)	
0:9:3F 27F:46  839         tcy   6         ; Select middle lamp	
0:9:3E 27E:AF  840         br    S26F      	
               841 	
               842 ;********************************************************************************	
               843 ; LTLWRCL - Clear display and light lower lamp	
               844 ;********************************************************************************	
0:9:3D 27D:DA  845 LTLWRCL call  S25A      ; Load blanks into 7/14-15	
0:9:3B 27B:C8  846 L27B    call  S248      ; Set for immediate update of LEDS (6/12 bit 2 set)	
0:9:37 277:4A  847         tcy   5         ; Select lower lamp	
               848 	
               849 ;	
               850 ; Light the lamp referenced in Y, beep, update the LEDs and loop over REFRLED	
               851 ;	
0:9:2F 26F:0D  852 S26F    setr            ; Light the selected lamp	
0:9:1E 25E:1C  853         ldp   3         	
0:9:3C 27C:0B  854         tpc             	
0:9:39 279:1B  855         ldp   13        	
0:9:33 273:C9  856         call  PLYBEEP   	
0:9:27 267:2B  857 L267    ldx   6         	
0:9:0E 24E:43  858         tcy   12        	
0:9:1D 25D:31  859         sbit  2         ; 6/12 bit 2 set - Immediate update of LEDs	
               860 ;	
               861 ; Call REFRLED $BF (191) times	
               862 ;	
0:9:3A 27A:2B  863         ldx   6         	
0:9:35 275:40  864         tcy   0         	
0:9:2B 26B:6F  865         tcmiy 15        ; 6/0 = 15	
0:9:16 256:6D  866         tcmiy 11        ; 6/1 = 11	
0:9:2C 26C:27  867 S26C    tam             ; 6/2 = A	
0:9:18 258:15  868         ldp   10        	
0:9:30 270:C0  869         call  REFRLED   	
0:9:21 261:2B  870         ldx   6         	
0:9:02 242:40  871         tcy   0         	
0:9:05 245:07  872         dman            ; Acc = 6/0 - 1	
0:9:0B 24B:AC  873         br    S26C      ; Update 6/0 and loop	
0:9:17 257:25  874         tamiyc          ; Acc has overflowed; update 6/0 and focus on 6/1	
0:9:2E 26E:07  875         dman            ; Decrement 6/1	
0:9:1C 25C:AC  876         br    S26C      ; Update 6/1 and loop	
               877 ;	
               878 ; We've called REFRLED enough times; turn off the lamps	
               879 ;	
0:9:38 278:0A  880         tdo             	
0:9:31 271:4E  881         tcy   7         ; Select Upper lamp	
0:9:23 263:0C  882         rstr            ; Turn it off	
0:9:06 246:46  883         tcy   6         ; Select Middle lamp	
0:9:0D 24D:0C  884         rstr            ; Turn it off	
0:9:1B 25B:4A  885         tcy   5         ; Select Lower lamp	
0:9:36 276:0C  886         rstr            ; Turn it off	
               887 	
0:9:2D 26D:0F  888         retn            	
               889 ;	
               890 ; Load blanks into display buffer (7/14-15)	
               891 ;	
0:9:1A 25A:2F  892 S25A    ldx   7         	
0:9:34 274:47  893         tcy   14        	
0:9:29 269:6F  894         tcmiy 15        ; 7/14 = 15 (" ")	
0:9:12 252:6F  895         tcmiy 15        ; 7/15 = 15 (" ")	
0:9:24 264:0F  896         retn            	
               897 ;	
               898 ; Set for immediate update of LEDs on call to REFRLED (6/12 bit 2 set)	
               899 ;	
0:9:08 248:2B  900 S248    ldx   6         	
0:9:11 251:43  901         tcy   12        	
0:9:22 262:31  902         sbit  2         	
0:9:04 244:0F  903         retn            	
               904 	
               905 ;********************************************************************************	
               906 ; CPYBRIG - Copy the current brigand count (3/12-13) to 5/1-2 for base 10 math	
               907 ;********************************************************************************	
0:9:09 249:2E  908 CPYBRIG ldx   3         	
0:9:13 253:43  909         tcy   12        	
0:9:26 266:21  910         tma             	
0:9:0C 24C:2D  911         ldx   5         	
0:9:19 259:48  912         tcy   1         	
0:9:32 272:27  913         tam             	
0:9:25 265:2E  914         ldx   3         	
0:9:0A 24A:4B  915         tcy   13        	
0:9:15 255:21  916         tma             	
0:9:2A 26A:2D  917         ldx   5         	
0:9:14 254:44  918         tcy   2         	
0:9:28 268:27  919         tam             	
0:9:10 250:0F  920         retn            	
               921 	
0:9:20 260:00  922         mnea            	
               923 	
               924 ; *** Chapter 0 page 10	
               925 	
               926 ;********************************************************************************	
               927 ; REFRLED	
               928 ;	
               929 ; Refresh the contents of the LEDs either with new data or handle flashing	
               930 ;	
               931 ;********************************************************************************	
0:A:00 280:2B  932 REFRLED ldx   6         	
0:A:01 281:43  933         tcy   12        	
0:A:03 283:39  934         tbit1 2         ; 6/12 Bit 2 - Immediate update of LEDs.  Bypass flashing.	
0:A:07 287:A1  935         br    S2A1      	
               936 ;	
               937 ; Decrement countdown timer in 7/12-13.  When it expires, it checks what's currently displayed	
               938 ; in the LED segments (6/12 Bit 1).  If it's reset, it does a TDO and clears the display.  It then	
               939 ; toggles the bit.	
               940 ;	
0:A:0F 28F:2F  941         ldx   7         	
0:A:1F 29F:4B  942         tcy   13        	
0:A:3F 2BF:07  943         dman            	
0:A:3E 2BE:AB  944         br    S2AB      	
0:A:3D 2BD:24  945         tamdyn          ; 7/13 = 7/13 - 1	
0:A:3B 2BB:07  946         dman            ; A = 7/12 - 1	
0:A:37 2B7:AB  947         br    S2AB      	
               948 ;	
               949 ; Countdown has expired.  Acc has 15 (" ") in it due to underflow.  If 6/12 bit 1 is reset, the	
               950 ; display has data in it.  Blank the display with a TDO.  In either case, toggle 6/12 bit 1.	
               951 ;	
0:A:2F 2AF:68  952         tcmiy 1         ; Reset 7/12 - $1F	
0:A:1E 29E:2B  953         ldx   6         	
0:A:3C 2BC:43  954         tcy   12        	
0:A:39 2B9:3A  955         tbit1 1         ; 6/12 Bit 1 - Display currently blank	
0:A:33 2B3:BA  956         br    S2BA      	
0:A:27 2A7:32  957         sbit  1         ; Set 6/12 Bit 1 - Display now blank	
0:A:0E 28E:0A  958         tdo             ; Transfer Accumulator to O outputs - Clear display (Load 15 [" "] into LED)	
0:A:1D 29D:9A  959         br    S29A      	
0:A:3A 2BA:36  960 S2BA    rbit  1         ; Clear 6/12 Bit 1 - Display now not blank	
0:A:35 2B5:A1  961         br    S2A1      	
               962 	
0:A:2B 2AB:27  963 S2AB    tam             	
0:A:16 296:2B  964         ldx   6         	
0:A:2C 2AC:43  965         tcy   12        	
0:A:18 298:3A  966         tbit1 1         ; Is display currently blank (6/12 Bit 1 set)?	
0:A:30 2B0:9A  967         br    S29A      ; Bit 1 is set.  Skip update and just delay	
               968 ;	
               969 ; Update the LED segments with the contents of 7/14-15	
               970 ;	
0:A:21 2A1:21  971 S2A1    tma             ; Load 6/12	
0:A:02 282:20  972         tay             ; Save it...	
0:A:05 285:7E  973         a8aac           ; Toggle 6/12 bit 3	
0:A:0B 28B:AE  974         br    S2AE      ; It's now clear; we want the Status Latch set to 1	
0:A:17 297:20  975         tay             ; It's now set; we want the Status Latch set to 0	
0:A:2E 2AE:02  976 S2AE    ynea            ; Update Status Latch to select correct LED segment based on prior steps	
0:A:1C 29C:43  977         tcy   12        	
0:A:38 2B8:27  978         tam             ; Update 6/12 with the new state of 6/12 Bit 3	
0:A:31 2B1:2F  979         ldx   7         	
0:A:23 2A3:47  980         tcy   14        ; Select 7/14	
0:A:06 286:7E  981         a8aac           ; Flip bit 3 of Accumulator BACK to test it (from the earlier work on 6/12)	
0:A:0D 28D:B6  982         br    S2B6      ; There was a carry, we have the right segment (Bit 3 was set)	
0:A:1B 29B:4F  983         tcy   15        ; Switch to 7/15 (Bit 3 was clear)	
0:A:36 2B6:21  984 S2B6    tma             ; Pick up value in the referenced LED display buffer	
0:A:2D 2AD:0A  985         tdo             ; Transfer Accumulator to O outputs - Update the LED display	
               986 	
               987 ;	
               988 ; Display has been updated; delay for 255 loops and return	
               989 ;	
0:A:1A 29A:4F  990 S29A    tcy   15        	
0:A:34 2B4:23  991         tya             	
0:A:29 2A9:04  992 S2A9    dyn             	
0:A:12 292:A9  993         br    S2A9      	
0:A:24 2A4:77  994         dan             	
0:A:08 288:A9  995         br    S2A9      	
0:A:11 291:0F  996         retn            	
               997 ;	
               998 ; Used by read keyboard routine	
               999 ;	
0:A:22 2A2:0A 1000 L2A2    tdo             	
0:A:04 284:2B 1001         ldx   6         	
0:A:09 289:4F 1002         tcy   15        	
0:A:13 293:22 1003         tmy             	
0:A:26 2A6:0F 1004         retn            	
              1005 ;	
              1006 ; Copy 5/2-0 to 7/2-0	
              1007 ;	
0:A:0C 28C:44 1008 L28C    tcy   2         	
0:A:19 299:2D 1009 S299    ldx   5         	
0:A:32 2B2:21 1010         tma             	
0:A:25 2A5:2F 1011         ldx   7         	
0:A:0A 28A:24 1012         tamdyn          	
0:A:15 295:99 1013         br    S299      	
0:A:2A 2AA:0F 1014         retn            	
              1015 ;	
              1016 ; This code looks to be unused...  Odd.  There's also a chunk of code	
              1017 ; like this at SFD4	
              1018 ;	
              1019 ; Values are 65 25 80 94	
              1020 ;	
0:A:14 294:65 1021 S294    tcmiy 10        	
0:A:28 2A8:25 1022         tamiyc          	
0:A:10 290:80 1023         br    REFRLED   	
0:A:20 2A0:94 1024         br    S294      	
              1025 	
              1026 ; *** Chapter 0 page 11	
              1027 	
              1028 ;	
              1029 ; Group of routines to rotate buffer of four two-word values at 5/8-1 by	
              1030 ; 6, 4 and 2 positions	
              1031 ;	
0:B:00 2C0:DF 1032 L2C0    call  ROL5      	
0:B:01 2C1:DF 1033         call  ROL5      	
0:B:03 2C3:DF 1034 L2C3    call  ROL5      	
0:B:07 2C7:DF 1035         call  ROL5      	
0:B:0F 2CF:DF 1036 L2CF    call  ROL5      	
              1037 	
0:B:1F 2DF:2D 1038 ROL5    ldx   5         	
0:B:3F 2FF:41 1039         tcy   8         	
0:B:3E 2FE:21 1040         tma             	
              1041 	
0:B:3D 2FD:04 1042 S2FD    dyn             	
0:B:3B 2FB:03 1043         xma             	
0:B:37 2F7:58 1044         ynec  1         	
0:B:2F 2EF:BD 1045         br    S2FD      	
0:B:1E 2DE:41 1046         tcy   8         	
0:B:3C 2FC:27 1047         tam             	
0:B:39 2F9:0F 1048         retn            	
              1049 	
0:B:33 2F3:44 1050 L2F3    tcy   2         	
0:B:27 2E7:2F 1051 S2E7    ldx   7         	
0:B:0E 2CE:21 1052         tma             	
0:B:1D 2DD:2D 1053         ldx   5         	
0:B:3A 2FA:24 1054         tamdyn          	
0:B:35 2F5:A7 1055         br    S2E7      	
0:B:2B 2EB:0F 1056         retn            	
              1057 ;	
              1058 ; Rotate the buffer of five 2-digit Base10 values left at 7/1-10.  Keep track of	
              1059 ; the position at 7/11.  Value at 7/11 is 1-5.	
              1060 ;	
0:B:16 2D6:2F 1061 L2D6    ldx   7         	
0:B:2C 2EC:4D 1062         tcy   11        	
0:B:18 2D8:21 1063         tma             ; Save the current position	
              1064 ;	
              1065 ; Limit the range of 7/11 to 0-4 (concerned someone futzed with it?)	
              1066 ;	
0:B:30 2F0:75 1067         a11aac          	
0:B:21 2E1:85 1068         br    S2C5      	
0:B:02 2C2:72 1069         a5aac           	
0:B:05 2C5:70 1070 S2C5    iac             ; Advance the position	
0:B:0B 2CB:24 1071         tamdyn          ; Save Acc at 7/11	
0:B:17 2D7:EE 1072         call  S2EE      ; Rotate all of the values in 7/10-1 left (twice)	
0:B:2E 2EE:21 1073 S2EE    tma             	
0:B:1C 2DC:04 1074         dyn             	
0:B:38 2F8:03 1075 S2F8    xma             	
0:B:31 2F1:04 1076         dyn             	
0:B:23 2E3:50 1077         ynec  0         	
0:B:06 2C6:B8 1078         br    S2F8      	
              1079 	
0:B:0D 2CD:45 1080         tcy   10        ; Finish up by copying what was in 7/1 to 7/10	
0:B:1B 2DB:27 1081         tam             	
              1082 	
0:B:36 2F6:0F 1083         retn            	
              1084 	
              1085 ;	
              1086 ; Called during Bazaar visit	
              1087 ;	
0:B:2D 2ED:1C 1088 L2ED    ldp   3         	
              1089 ;	
              1090 ; Generate a random number from 0-9 and add it to 17	
              1091 ; Results in 5/1 and 5/2	
              1092 ;	
0:B:1A 2DA:C0 1093         call  RANDOM    ; Generate a random number in A; return with Y=2	
0:B:34 2F4:29 1094         ldx   4         	
0:B:29 2E9:24 1095         tamdyn          ; 4/2 = ACC	
0:B:12 2D2:60 1096         tcmiy 0         ; 4/1 = 0	
0:B:24 2E4:37 1097         rbit  3         ; 4/2 = 4/2 & 0b0111	
0:B:08 2C8:2D 1098         ldx   5         	
0:B:11 2D1:48 1099         tcy   1         	
0:B:22 2E2:68 1100         tcmiy 1         ; 5/1 = 1	
0:B:04 2C4:6E 1101         tcmiy 7         ; 5/2 = 7	
0:B:09 2C9:12 1102         ldp   4         	
0:B:13 2D3:C0 1103         call  AD2B10    	
              1104 	
0:B:26 2E6:18 1105         ldp   1         	
0:B:0C 2CC:0B 1106         tpc             	
0:B:19 2D9:13 1107         ldp   12        	
0:B:32 2F2:A7 1108         br    CPY5TO4   	
0:B:25 2E5:2E 1109 L2E5    ldx   3         	
0:B:0A 2CA:48 1110         tcy   1         	
0:B:15 2D5:17 1111         ldp   14        	
0:B:2A 2EA:3A 1112 S2EA    tbit1 1         	
0:B:14 2D4:A6 1113         br    L2BINIT   	
0:B:28 2E8:AA 1114         br    BRGDONE      	
0:B:10 2D0:08 1115         tka             	
0:B:20 2E0:0A 1116         tdo             	
              1117 	
              1118 ; *** Chapter 0 page 12	
              1119 	
              1120 ;********************************************************************************	
              1121 ; SU2B10 - Perform Base 10 subtraction on values in scratchpad RAM 4/1-2 and 5/1-2	
              1122 ;          Return borrow flag in A	
              1123 ;	
              1124 ;          Subtract the two-digit base 10 number encoded in 4/1 and 4/2 from	
              1125 ;          the two-digit base 10 number encoded in 5/1 and 5/2 giving	
              1126 ;          a two-digit base-10 number encoded in 5/1 and 5/2	
              1127 ;	
              1128 ;          For example:   1 2	
              1129 ;                       4 1 9	
              1130 ;                       5 2 2	
              1131 ;	
              1132 ;          Returns:       1 2	
              1133 ;                       4 1 9	
              1134 ;                       5 0 3	
              1135 ;********************************************************************************	
0:C:00 300:2D 1136 SU2B10  ldx   5         	
0:C:01 301:40 1137         tcy   0         	
0:C:03 303:60 1138         tcmiy 0         ; 5/0 = 0	
0:C:07 307:29 1139 L307    ldx   4         	
0:C:0F 30F:40 1140         tcy   0         	
0:C:1F 31F:60 1141         tcmiy 0         ; 4/0 = 0	
0:C:3F 33F:7F 1142 L33F    cla             	
0:C:3E 33E:44 1143         tcy   2         	
0:C:3D 33D:29 1144 S33D    ldx   4         	
0:C:3B 33B:06 1145         amaac           	
0:C:37 337:2D 1146         ldx   5         	
0:C:2F 32F:3C 1147         saman           ; A = 5/Y - 4/Y (Y = 2-0)	
0:C:1E 31E:B5 1148         br    S335      ; Branch if no borrow	
0:C:3C 33C:79 1149         a10aac          	
0:C:39 339:26 1150         tamza           ; 5/Y = A + 10	
0:C:33 333:70 1151         iac             	
0:C:27 327:04 1152 S327    dyn             	
0:C:0E 30E:BD 1153         br    S33D      	
0:C:1D 31D:40 1154         tcy   0         	
0:C:3A 33A:0F 1155         retn            	
              1156 	
0:C:35 335:26 1157 S335    tamza           	
0:C:2B 32B:A7 1158         br    S327      	
              1159 ;	
              1160 ; Display key awarded	
              1161 ;	
0:C:16 316:29 1162 L316    ldx   4         	
0:C:2C 32C:42 1163         tcy   4         	
0:C:18 318:27 1164         tam             ; 4/4 = A	
0:C:30 330:4C 1165         tcy   3         ; Gold Key/Silver Key/Brass Key	
0:C:21 321:11 1166         ldp   8         	
0:C:02 302:D5 1167         call  ROTDRUM   	
0:C:05 305:29 1168         ldx   4         	
0:C:0B 30B:42 1169         tcy   4         	
0:C:17 317:21 1170         tma             ; A = 4/4	
0:C:2E 32E:19 1171         ldp   9         	
0:C:1C 31C:7B 1172         a14aac          ; A = A + 14	
0:C:38 338:80 1173         br    LTTOPCL   ; On overflow, light Gold Key and clear the display	
0:C:31 331:70 1174         iac             	
0:C:23 323:8F 1175         br    LTMIDCL   ; Light Silver Key and clear display	
0:C:06 306:BD 1176         br    LTLWRCL        ; Light Brass Key and clear display	
              1177 ;	
              1178 ; Copy 5/1 and 5/2 to 3/12 and 3/13 - Brigand count for fight	
              1179 ; 	
0:C:0D 30D:2D 1180 L30D    ldx   5         	
0:C:1B 31B:48 1181         tcy   1         	
0:C:36 336:21 1182         tma             ; A = 5/1	
0:C:2D 32D:2E 1183         ldx   3         	
0:C:1A 31A:43 1184         tcy   12        	
0:C:34 334:27 1185         tam             ; 3/12 = A	
0:C:29 329:2D 1186         ldx   5         	
0:C:12 312:44 1187         tcy   2         	
0:C:24 324:21 1188         tma             ; A = 5/2	
0:C:08 308:2E 1189         ldx   3         	
0:C:11 311:4B 1190         tcy   13        	
0:C:22 322:27 1191         tam             ; 3/13 = A	
0:C:04 304:0F 1192         retn            	
              1193 	
              1194 ;	
              1195 ; Continue setting up for Level 4	
              1196 ;	
0:C:09 309:2A 1197 S309    ldx   2         	
0:C:13 313:27 1198         tam             ; 2/3 = 15 - Give player all keys and ??? about the frontier	
0:C:26 326:2C 1199         ldx   1         	
0:C:0C 30C:25 1200         tamiyc          ; 1/3 = 15 - Give player all items (Sword, Scout, Healer, Beast)	
0:C:19 319:05 1201         iyc             	
0:C:32 332:05 1202         iyc             	
0:C:25 325:5F 1203         ynec  15        ; Have we done all players?	
0:C:0A 30A:89 1204         br    S309      ; Nope, go back and do the next player	
0:C:15 315:2D 1205         ldx   5         	
0:C:2A 32A:47 1206         tcy   14        	
0:C:14 314:64 1207         tcmiy 2         ; 5/14 = 2 - First key  - 2 = Gold	
0:C:28 328:68 1208         tcmiy 1         ; 5/15 = 1 - Second key - 1 = Silver	
0:C:10 310:1B 1209         ldp   13        	
0:C:20 320:AC 1210         br    L36C      ; Carry on with game setup	
              1211 	
              1212 	
              1213 ; *** Chapter 0 page 13	
              1214 	
              1215 ;	
              1216 ; Continue new game initialization	
              1217 ;	
0:D:00 340:2E 1218 L340    ldx   3         	
0:D:01 341:47 1219         tcy   14        	
0:D:03 343:27 1220         tam             ; Update Dark Tower brigand 10s digit from math	
0:D:07 347:2D 1221         ldx   5         	
0:D:0F 34F:44 1222         tcy   2         	
0:D:1F 35F:21 1223         tma             	
0:D:3F 37F:2E 1224         ldx   3         	
0:D:3E 37E:4F 1225         tcy   15        	
0:D:3D 37D:27 1226         tam             ; Update Dark Tower Brigand 1s digit from math	
0:D:3B 37B:11 1227         ldp   8         	
0:D:37 377:E3 1228         call  RND0TO2   	
0:D:2F 36F:2D 1229         ldx   5         	
0:D:1E 35E:47 1230         tcy   14        	
0:D:3C 37C:27 1231         tam             ; Set Dark Tower first key value	
0:D:39 379:11 1232 S379    ldp   8         	
0:D:33 373:E3 1233         call  RND0TO2   	
0:D:27 367:2D 1234         ldx   5         	
0:D:0E 34E:47 1235         tcy   14        	
0:D:1D 35D:00 1236         mnea            ; Make sure we didn't get the same key twice	
0:D:3A 37A:AB 1237         br    S36B      	
0:D:35 375:B9 1238         br    S379      ; We did; try again	
0:D:2B 36B:4F 1239 S36B    tcy   15        	
0:D:16 356:27 1240         tam             	
              1241 ;	
              1242 ; Game setup - Select number of players	
              1243 ;	
0:D:2C 36C:2F 1244 L36C    ldx   7         	
0:D:18 358:47 1245         tcy   14        	
0:D:30 370:63 1246         tcmiy 12        ; 7/14 = 12 ("P")	
0:D:21 361:68 1247         tcmiy 1         ; 7/15 = 1 ("1")	
0:D:02 342:1E 1248 S342    ldp   7         	
0:D:05 345:CB 1249         call  PROMPT      	
0:D:0B 34B:2F 1250         ldx   7         	
0:D:17 357:51 1251         ynec  8         ; Did they hit anything other than "No/End"?	
0:D:2E 36E:AD 1252         br    S36D      ; Yes, check to see if they hit "Yes/Buy"	
0:D:1C 35C:4F 1253         tcy   15        	
0:D:38 378:21 1254         tma             ; Get the current player count from the display (7/15)	
0:D:31 371:7D 1255         a12aac          ; Add 12 (overflow to 0 if it's 4)	
0:D:23 363:8D 1256         br    S34D      ; It overflowed...	
0:D:06 346:7C 1257         a4aac           ; It didn't overflow, add 4 to get it back to the original value	
0:D:0D 34D:70 1258 S34D    iac             ; Add one player	
0:D:1B 35B:27 1259         tam             ; Update display	
0:D:36 376:82 1260         br    S342      	
              1261 	
0:D:2D 36D:50 1262 S36D    ynec  0         ; Did they hit anything other than "Yes/Buy"?	
0:D:1A 35A:82 1263         br    S342      ; Yes.  Prompt again	
0:D:34 374:4F 1264         tcy   15        ; They hit "Yes/Buy"	
0:D:29 369:21 1265         tma             ; Pick up the player count from the display (7/15)	
0:D:12 352:2E 1266         ldx   3         	
0:D:24 364:49 1267         tcy   9         	
0:D:08 348:27 1268         tam             ; Save the player count in 3/9	
0:D:11 351:1C 1269         ldp   3         	
0:D:22 362:0B 1270         tpc             	
0:D:04 344:10 1271         ldp   0         	
0:D:09 349:CC 1272         call  PLYTHEM   ; Play the Dark Tower theme song	
0:D:13 353:18 1273         ldp   1         	
0:D:26 366:0B 1274         tpc             	
0:D:0C 34C:10 1275         ldp   0         	
0:D:19 359:97 1276         br    NEWTURN   	
              1277 ;	
              1278 ; Set the game up for Level 4 play	
              1279 ;	
0:D:32 372:2E 1280 L4INIT  ldx   3         	
0:D:25 365:47 1281         tcy   14        	
0:D:0A 34A:68 1282         tcmiy 1         ; 3/14 = 1 (Dark tower brigand count 10s digit)	
0:D:15 355:66 1283         tcmiy 6         ; 3/15 = 6 (Dark tower brigand count 1s digit)	
0:D:2A 36A:7F 1284         cla             	
0:D:14 354:77 1285         dan             	
0:D:28 368:4C 1286         tcy   3         	
0:D:10 350:13 1287         ldp   12        	
0:D:20 360:89 1288         br    S309      	
              1289 	
              1290 ; *** Chapter 0 page 14	
              1291 	
              1292 ;********************************************************************************	
              1293 ; Initialize player inventory information for new game (continued)	
              1294 ;********************************************************************************	
0:E:00 380:1F 1295 L380    ldp   15        	
0:E:01 381:5B 1296         ynec  13        ; On to next player; done with all 4 players?	
0:E:03 383:A5 1297         br    L3E5      ; No, fill in the next player	
              1298 	
0:E:07 387:2E 1299         ldx   3         	
0:E:0F 38F:40 1300         tcy   0         	
0:E:1F 39F:68 1301         tcmiy 1         ; 3/0 = 1	
0:E:3F 3BF:64 1302         tcmiy 2         ; 3/1 = 2	
0:E:3E 3BE:62 1303         tcmiy 4         ; 3/2 = 4	
0:E:3D 3BD:60 1304         tcmiy 0         ; 3/3 = 0 - Turn number 10s	
0:E:3B 3BB:60 1305         tcmiy 0         ; 3/4 = 0 - Turn number 1s	
0:E:37 3B7:60 1306         tcmiy 0         ; 3/5 = 0 - Dragon treasure Warriors 10s	
0:E:2F 3AF:64 1307         tcmiy 2         ; 3/6 = 2 - Dragon treasure Warriors 1s	
0:E:1E 39E:60 1308         tcmiy 0         ; 3/7 = 0 - Dragon treasure Gold 10s	
0:E:3C 3BC:66 1309         tcmiy 6         ; 3/8 = 6 - Dragon treasure Gold 1s	
0:E:39 3B9:4D 1310         tcy   11        	
0:E:33 3B3:60 1311         tcmiy 0         ; 3/11 = 0 - Current player	
              1312 ;	
              1313 ; Handle level selection	
              1314 ;	
0:E:27 3A7:2F 1315         ldx   7         	
0:E:0E 38E:47 1316         tcy   14        ; Reference display 10s digit (7/14)	
0:E:1D 39D:6B 1317         tcmiy 13        ; 7/14 = 13 ("L")	
0:E:3A 3BA:68 1318         tcmiy 1         ; 7/15 = 1 ("1")	
0:E:35 3B5:1E 1319 S3B5    ldp   7         	
0:E:2B 3AB:CB 1320         call  PROMPT    ; Display flashing "L1" and wait for keypress	
0:E:16 396:2F 1321         ldx   7         	
0:E:2C 3AC:51 1322         ynec  8         ; Did user hit "No"?	
0:E:18 398:B8 1323         br    S3B8      ; Nope, they hit something else.  This is the level they want to play	
0:E:30 3B0:4F 1324         tcy   15        	
0:E:21 3A1:21 1325         tma             ; Pick up the currently selected level	
0:E:02 382:7D 1326         a12aac          ; Add 12 to see if there's an overflow	
0:E:05 385:97 1327         br    S397      ; There was, ACC is now 0	
0:E:0B 38B:7C 1328         a4aac           ; Nope, add four more effectively doing a MOD 4	
0:E:17 397:70 1329 S397    iac             ; Increment ACC to select next level	
0:E:2E 3AE:27 1330         tam             ; Update 1s digit on display	
0:E:1C 39C:B5 1331         br    S3B5      	
0:E:38 3B8:50 1332 S3B8    ynec  0         ; Did the user hit "Yes"?	
0:E:31 3B1:B5 1333         br    S3B5      ; Nope, go prompt again at the same level	
0:E:23 3A3:4F 1334         tcy   15        ; Pick up the level selected	
0:E:06 386:21 1335         tma             ; and store it in the Accumulator	
0:E:0D 38D:1B 1336         ldp   13        	
0:E:1B 39B:7D 1337         a12aac          ; Add 12 to accumulator (See if it's level 4)	
0:E:36 3B6:B2 1338         br    L4INIT    ; Handle Level 4 separately (special conditions--see manual page 39)	
0:E:2D 3AD:12 1339         ldp   4         	
0:E:1A 39A:F0 1340         call  L130      ; Load 17 + a random number into 5/1 and 5/2 - Base Brigand count for Levels 1 and 4	
0:E:34 3B4:2F 1341         ldx   7         	
0:E:29 3A9:4F 1342         tcy   15        	
0:E:12 392:21 1343         tma             ; Pick up the level selected	
0:E:24 3A4:1D 1344         ldp   11        	
0:E:08 388:73 1345         a13aac          ; n = Level + 13 - Is this level 3 or 4? (n = 16 or 17)	
0:E:11 391:A5 1346         br    L2E5      ; If there was a carry, branch and deal with it	
0:E:22 3A2:17 1347         ldp   14        ; Level < 3	
0:E:04 384:70 1348         iac             ; n = n + 1 - Generate a carry if it's level 2	
0:E:09 389:A6 1349         br    L2BINIT   ; On carry, branch and deal with level 2; otherwise, set status=1	
0:E:13 393:AA 1350         br    BRGDONE   ; There wasn't a carry.  We're done calculating Brigands	
0:E:26 3A6:2E 1351 L2BINIT ldx   3         	
0:E:0C 38C:48 1352         tcy   1         	
0:E:19 399:12 1353         ldp   4         	
0:E:32 3B2:38 1354         tbit1 0         	
0:E:25 3A5:D5 1355         call  ADD16     ; Add 16 to 5/1-5/2 if bit 0 of 3/1 is set	
0:E:0A 38A:12 1356         ldp   4         	
0:E:15 395:D5 1357         call  ADD16     ; Add 16 more to 5/1-5/2	
0:E:2A 3AA:2D 1358 BRGDONE ldx   5         	
0:E:14 394:48 1359         tcy   1         	
0:E:28 3A8:21 1360         tma             	
0:E:10 390:1B 1361         ldp   13        	
0:E:20 3A0:80 1362         br    L340      	
              1363 	
              1364 ; *** Chapter 0 page 15	
              1365 	
              1366 ;********************************************************************************	
              1367 ; INIT - Called on power-up	
              1368 ;********************************************************************************	
0:F:00 3C0:40 1369 INIT    tcy   0         	
0:F:01 3C1:28 1370 S3C1    ldx   0         	
0:F:03 3C3:08 1371         tka             	
0:F:07 3C7:02 1372         ynea            	
0:F:0F 3CF:0A 1373         tdo             	
0:F:1F 3DF:20 1374         tay             	
0:F:3F 3FF:0D 1375         setr            	
0:F:3E 3FE:0C 1376         rstr            	
0:F:3D 3FD:0E 1377         knez            	
0:F:3B 3FB:81 1378         br    S3C1      	
0:F:37 3F7:2F 1379         ldx   7         	
0:F:2F 3EF:47 1380         tcy   14        ; Reference display 10s digit	
0:F:1E 3DE:67 1381         tcmiy 14        ; 7/14 = 14 ("-")	
0:F:3C 3FC:67 1382         tcmiy 14        ; 7/15 = 14 ("-")	
0:F:39 3F9:1E 1383         ldp   7         	
0:F:33 3F3:CB 1384         call  PROMPT    ; Display flashing "--" and wait for keypress	
0:F:27 3E7:18 1385         ldp   1         	
0:F:0E 3CE:C0 1386         call  ROTONE      	
              1387 	
0:F:1D 3DD:28 1388         ldx   0         	
0:F:3A 3FA:40 1389         tcy   0         	
0:F:35 3F5:61 1390         tcmiy 8         ; 0/0 = 8 - Last barrel position 8=unknown?	
0:F:2B 3EB:2C 1391         ldx   1         	
0:F:16 3D6:40 1392         tcy   0         	
0:F:2C 3EC:6F 1393         tcmiy 15        ; 1/0 = 15 - High-order barrel timer threshold	
0:F:18 3D8:2A 1394         ldx   2         	
0:F:30 3F0:40 1395         tcy   0         	
0:F:21 3E1:6F 1396         tcmiy 15        ; 2/0 = 15 - Low-order barrel timer threshold	
0:F:02 3C2:40 1397         tcy   0         	
0:F:05 3C5:11 1398         ldp   8         	
0:F:0B 3CB:D5 1399         call  ROTDRUM   ; Cycle display to position 0 - on return, 0/0=0; 1/0=4; 2/0=12	
0:F:17 3D7:2F 1400         ldx   7         	
0:F:2E 3EE:47 1401         tcy   14        ; Reference display 10s digit	
0:F:1C 3DC:61 1402         tcmiy 8         ; 7/14 = 8 ("8")	
0:F:38 3F8:61 1403         tcmiy 8         ; 7/15 = 8 ("8")	
0:F:31 3F1:19 1404         ldp   9         	
0:F:23 3E3:C1 1405         call  L241      ; Display 88, light top display light and beep	
0:F:06 3C6:19 1406         ldp   9         	
0:F:0D 3CD:DF 1407         call  L25F      ; Light middle display light and beep	
0:F:1B 3DB:19 1408         ldp   9         	
0:F:36 3F6:FB 1409         call  L27B      ; Light lower display light and beep	
              1410 ;********************************************************************************	
              1411 ; Initialize player inventory information for new game	
              1412 ;	
              1413 ; 30 Gold, 25 Food and 10 Warriors	
              1414 ;********************************************************************************	
0:F:2D 3ED:28 1415 L3ED    ldx   0         	
0:F:1A 3DA:48 1416         tcy   1         ; X = 0, Y = 1 - Player 1 Gold and ???	
0:F:34 3F4:6C 1417 S3F4    tcmiy 3         ; Set Gold 10s to 3	
0:F:29 3E9:60 1418         tcmiy 0         ; Set Gold 1s to 0	
0:F:12 3D2:64 1419         tcmiy 2         ; Set ??? to 2	
0:F:24 3E4:5B 1420         ynec  13        ; On to next player; done with all 4 players?	
0:F:08 3C8:B4 1421         br    S3F4      ; No, fill in the next player	
              1422 	
0:F:11 3D1:2C 1423         ldx   1         ; X = 1, Y = 1 - Player 1 Food and inventory pt 1	
0:F:22 3E2:48 1424         tcy   1         	
0:F:04 3C4:64 1425 S3C4    tcmiy 2         ; Set Food 10s to 2	
0:F:09 3C9:6A 1426         tcmiy 5         ; Set Food 1s to 5	
0:F:13 3D3:60 1427         tcmiy 0         ; Set Inventory pt 1 to 0 (No Scout - 1000, Sword - 0100, Healer - 0010, Beast - 0001)	
0:F:26 3E6:5B 1428         ynec  13        ; On to next player; done with all 4 players?	
0:F:0C 3CC:84 1429         br    S3C4      ; No, fill in the next player	
              1430 	
0:F:19 3D9:2A 1431         ldx   2         ; X = 2, Y = 1 - Player 1 Warriors and inventory pt 2	
0:F:32 3F2:48 1432         tcy   1         	
0:F:25 3E5:68 1433 L3E5    tcmiy 1         ; Set Warriors 10s to 1	
0:F:0A 3CA:60 1434         tcmiy 0         ; Set Warriors 1s to 0	
0:F:15 3D5:60 1435         tcmiy 0         ; Set Inventory pt 2 to 0 (No Gold key - 1000, No Silver key - 0100, No Brass key - 0010, ??? - 0001)	
0:F:2A 3EA:17 1436         ldp   14        	
0:F:14 3D4:80 1437         br    L380      ; Ran out of ROM in this page...	
0:F:28 3E8:25 1438 S3E8    tamiyc          	
0:F:10 3D0:23 1439         tya             	
0:F:20 3E0:A8 1440         br    S3E8      	
              1441 	
              1442 ; *** Chapter 1 page 0	
              1443 	
              1444 ;	
              1445 ; Main gameplay loop?	
              1446 ;	
1:0:00 400:1C 1447 L400    ldp   3         	
1:0:01 401:0B 1448         tpc             	
1:0:03 403:1B 1449         ldp   13        	
1:0:07 407:C9 1450         call  PLYBEEP   	
              1451 	
              1452 ;********************************************************************************	
              1453 ; ENDTURN - Prompt for player EOT	
              1454 ;********************************************************************************	
1:0:0F 40F:2E 1455 ENDTURN ldx   3         	
1:0:1F 41F:4D 1456         tcy   11        	
1:0:3F 43F:21 1457         tma             ; Pick up current player	
1:0:3E 43E:2F 1458         ldx   7         	
1:0:3D 43D:47 1459         tcy   14        	
1:0:3B 43B:67 1460         tcmiy 14        ; 7/14 = 14 ("-")	
1:0:37 437:27 1461         tam             ; 7/15 = Current Player	
1:0:2F 42F:10 1462         ldp   0         	
1:0:1E 41E:0B 1463         tpc             	
1:0:3C 43C:1E 1464         ldp   7         	
1:0:39 439:CB 1465         call  PROMPT    ; Update display from 7/14-15 and wait for keypress	
1:0:33 433:52 1466         ynec  4         ; Did they hit Repeat (4)?	
1:0:27 427:B5 1467         br    S435      ; Nope...	
              1468 ;	
              1469 ; Player hit Repeat	
              1470 ;	
1:0:0E 40E:13 1471         ldp   12        	
1:0:1D 41D:C9 1472         call  CALLDSP   ; Display results from last turn again	
1:0:3A 43A:8F 1473         br    ENDTURN   	
              1474 	
1:0:35 435:59 1475 S435    ynec  9         ; Did they hit Clear (9)?	
1:0:2B 42B:98 1476         br    S418      ; Nope...	
              1477 ;	
              1478 ; Player hit Clear	
              1479 ;	
1:0:16 416:18 1480         ldp   1         	
1:0:2C 42C:98 1481         br    DOCLEAR   	
              1482 	
1:0:18 418:51 1483 S418    ynec  8         ; Did they hit No/END	
1:0:30 430:8F 1484         br    ENDTURN   ; Nope, go back and prompt again	
1:0:21 421:1C 1485         ldp   3         	
1:0:02 402:0B 1486         tpc             	
1:0:05 405:1C 1487         ldp   3         	
1:0:0B 40B:D5 1488         call  PLAYEOT      	
              1489 ;	
              1490 ; Begin next player's turn	
              1491 ;	
1:0:17 417:29 1492 NEWTURN ldx   4         	
1:0:2E 42E:43 1493         tcy   12        	
1:0:1C 41C:34 1494         rbit  0         ; 4/12 Bit 0 = 0	
1:0:38 438:10 1495         ldp   0         	
1:0:31 431:0B 1496         tpc             	
1:0:23 423:11 1497         ldp   8         	
1:0:06 406:C0 1498         call  L200      ; Advance the next player's data into the active slot	
1:0:0D 40D:7B 1499         a14aac          	
1:0:1B 41B:A6 1500         br    S426      	
1:0:36 436:17 1501         ldp   14        	
1:0:2D 42D:DB 1502         call  CPYTRNC   ; Get the turn counter into 5/1-2	
1:0:1A 41A:29 1503         ldx   4         	
1:0:34 434:48 1504         tcy   1         	
1:0:29 429:60 1505         tcmiy 0         	
1:0:12 412:68 1506         tcmiy 1         	
1:0:24 424:13 1507         ldp   12        	
1:0:08 408:F4 1508         call  ADDB10    ; Add 1 to what was in 3/3-4	
1:0:11 411:17 1509         ldp   14        	
1:0:22 422:3F 1510         mnez            ; Is 5/0 non-zero (2-digit overflow?)	
1:0:04 404:F1 1511         call  LOAD99    ; 5/1 = 9; 5/2 = 9	
1:0:09 409:17 1512         ldp   14        	
1:0:13 413:DB 1513         call  CPYTRNC   ; Save the results of the math back to the turn counter at 3/3-4	
              1514 ;	
              1515 ; Update display with current player	
              1516 ;	
1:0:26 426:2E 1517 S426    ldx   3         	
1:0:0C 40C:4D 1518         tcy   11        	
1:0:19 419:21 1519         tma             ; Pick up current player from 3/11	
1:0:32 432:2F 1520         ldx   7         	
1:0:25 425:47 1521         tcy   14        	
1:0:0A 40A:6F 1522         tcmiy 15        ; 7/14 = 15 (" ")	
1:0:15 415:18 1523         ldp   1         	
1:0:2A 42A:80 1524         br    L440      	
              1525 	
1:0:14 414:29 1526 L414    ldx   4         	
1:0:28 428:43 1527         tcy   12        	
1:0:10 410:30 1528         sbit  0         ; 4/12 Bit 0 = 1.  Player was lost but had a Scout.	
1:0:20 420:A6 1529         br    S426      	
              1530 	
              1531 	
              1532 ; *** Chapter 1 page 1	
              1533 	
1:1:00 440:27 1534 L440    tam             	
              1535 ;	
              1536 ; Get player move	
              1537 ;	
1:1:01 441:10 1538 S441    ldp   0         	
1:1:03 443:0B 1539         tpc             	
1:1:07 447:1E 1540         ldp   7         	
1:1:0F 44F:CB 1541         call  PROMPT      	
              1542 ;	
              1543 ; Process input	
              1544 ;	
              1545 ; First, handle non-move buttons.  Either invalid keys or Clear	
              1546 ;	
1:1:1F 45F:50 1547         ynec  0         ; Did they hit Yes/Buy?	
1:1:3F 47F:BD 1548         br    S47D      ; Nope	
1:1:3E 47E:81 1549         br    S441      ; Yes - Error; prompt again	
              1550 	
1:1:3D 47D:51 1551 S47D    ynec  8         ; Did they hit No/End?	
1:1:3B 47B:AF 1552         br    S46F      ; Nope	
1:1:37 477:81 1553         br    S441      ; Yes - Error; prompt again	
              1554 	
1:1:2F 46F:52 1555 S46F    ynec  4         ; Did they hit Repeat?	
1:1:1E 45E:B9 1556         br    S479      ; Nope	
1:1:3C 47C:81 1557         br    S441      ; Yes - Error; prompt again	
              1558 	
1:1:39 479:58 1559 S479    ynec  1         ; Did they hit Haggle?	
1:1:33 473:8E 1560         br    S44E      ; Nope	
1:1:27 467:81 1561         br    S441      ; Yes - Error; prompt again	
              1562 	
1:1:0E 44E:59 1563 S44E    ynec  9         ; Did they hit Clear?	
1:1:1D 45D:84 1564         br    DOBUTTN   ; Nope.  Process the button pressed	
              1565 ;	
              1566 ; Player hit Clear.  Deal with it	
              1567 ;	
1:1:3A 47A:29 1568         ldx   4         	
1:1:35 475:43 1569         tcy   12        	
1:1:2B 46B:38 1570         tbit1 0         ; Check to see if this is still the beginning of their turn	
1:1:16 456:98 1571         br    DOCLEAR   ; Nope	
1:1:2C 46C:81 1572         br    S441      ; Yeah, beginning of turn--Clear does nothing	
              1573 ;	
              1574 ; Handle player hitting Clear to clear up an illegal move	
              1575 ;	
              1576 ; Restore the saved copy of the player's inventory and status from 0/13-15, 1/13-15 and 2/13-15	
              1577 ; and start the next player's turn.	
              1578 ;	
1:1:18 458:28 1579 DOCLEAR ldx   0         	
1:1:30 470:C6 1580         call  S446      	
1:1:21 461:2C 1581         ldx   1         	
1:1:02 442:C6 1582         call  S446      	
1:1:05 445:2A 1583         ldx   2         	
1:1:0B 44B:C6 1584         call  S446      	
1:1:17 457:1C 1585         ldp   3         	
1:1:2E 46E:0B 1586         tpc             	
1:1:1C 45C:17 1587         ldp   14        	
1:1:38 478:E9 1588         call  PLYCLR    	
1:1:31 471:10 1589         ldp   0         	
1:1:23 463:97 1590         br    NEWTURN   	
              1591 ;	
              1592 ; Restore saved player information to recover from illegal move	
              1593 ;	
1:1:06 446:4B 1594 S446    tcy   13        	
1:1:0D 44D:21 1595         tma             	
1:1:1B 45B:48 1596         tcy   1         	
1:1:36 476:27 1597         tam             	
1:1:2D 46D:47 1598         tcy   14        	
1:1:1A 45A:21 1599         tma             	
1:1:34 474:44 1600         tcy   2         	
1:1:29 469:27 1601         tam             	
1:1:12 452:4F 1602         tcy   15        	
1:1:24 464:21 1603         tma             	
1:1:08 448:4C 1604         tcy   3         	
1:1:11 451:27 1605         tam             	
1:1:22 462:0F 1606         retn            	
              1607 ;	
              1608 ; Player has hit a button to make a move of some sort	
              1609 ; First, initialize the encounter results 4/13-15 to "No changes"	
              1610 ; (all flags set)	
              1611 ;	
1:1:04 444:29 1612 DOBUTTN ldx   4         	
1:1:09 449:4B 1613         tcy   13        	
1:1:13 453:6F 1614         tcmiy 15        ; 4/13 = 0b1111 - Beast/Gold/Food/Warriors unchanged	
1:1:26 466:6F 1615         tcmiy 15        ; 4/14 = 0b1111 - Silver key/Brass key/Healer/Scout not found this round	
1:1:0C 44C:6F 1616         tcmiy 15        ; 4/15 = 0b1111 - ???/Pegasus/Sword/Gold key not found this round	
1:1:19 459:28 1617         ldx   0         	
1:1:32 472:4C 1618         tcy   3         	
1:1:25 465:14 1619         ldp   2         	
1:1:0A 44A:3A 1620         tbit1 1         ; Player status flag at 0/3 - bit 1 - Cursed when clear	
1:1:15 455:B7 1621         br    L4B7      	
              1622 ;	
              1623 ; Player was cursed (0/3 bit 1 is clear).  Provide status update to player.	
              1624 ;	
1:1:2A 46A:29 1625         ldx   4         	
1:1:14 454:4B 1626         tcy   13        	
1:1:28 468:65 1627         tcmiy 10        ; 4/13 = 0b1010 - Gold and Warriors have changed	
1:1:10 450:19 1628         ldp   9         	
1:1:20 460:AA 1629         br    L66A      ; Player was cursed - rotate drum to Cursed/Lost/Plague then branch back to L480	
              1630 	
              1631 	
              1632 ; *** Chapter 1 page 2	
              1633 	
              1634 ;	
              1635 ; Display Cursed!	
              1636 ;	
1:2:00 480:4E 1637 L480    tcy   7         ; Select upper lamp	
1:2:01 481:0D 1638         setr            ; Turn it on	
1:2:03 483:1C 1639         ldp   3         	
1:2:07 487:0B 1640         tpc             	
1:2:0F 48F:10 1641         ldp   0         	
1:2:1F 49F:D3 1642         call  LC13      ; Play the "lose round of battle" sound	
1:2:3F 4BF:4E 1643         tcy   7         ; Select upper lamp	
1:2:3E 4BE:0C 1644         rstr            ; Turn it off	
1:2:3D 4BD:13 1645         ldp   12        	
1:2:3B 4BB:C9 1646         call  CALLDSP   ; Display results	
              1647 ;	
              1648 ; Determine how much food the warriors consumed this turn	
              1649 ;	
              1650 ; 15 Warriors or less consume 1 food per turn	
              1651 ; 16-30 Warriors consume 2 per turn	
              1652 ; 31-45 Warriors consume 3 per turn, etc.	
              1653 ;	
1:2:37 4B7:16 1654 L4B7    ldp   6         	
1:2:2F 4AF:F2 1655         call  CPY2TO5   ; Copy current player Warrior count to 5/1-2	
1:2:1E 49E:29 1656         ldx   4         	
1:2:3C 4BC:48 1657         tcy   1         	
1:2:39 4B9:68 1658         tcmiy 1         ; 4/1 = 1	
1:2:33 4B3:66 1659         tcmiy 6         ; 4/2 = 6 - Start by subtracting 15	
1:2:27 4A7:64 1660         tcmiy 2         ; 4/3 = 2 - contains the amount of food consumed	
              1661 ;	
              1662 ; Loop through, repeatedly subtracting until there's a borrow.  Basically, divide by 15 (kind of, as the first iteration was 16)	
              1663 ; to determine how much food was consumed.	
              1664 ;	
1:2:0E 48E:13 1665 S48E    ldp   12        	
1:2:1D 49D:C8 1666         call  SUBB10    ; Subtract value in row 4 from Warrior count - first time 16; afterward 15	
1:2:3A 4BA:3F 1667         mnez            ; Was there a borrow in the subtraction routine?  (5/0 will be 9)	
1:2:35 4B5:8B 1668         br    S48B      ; Yes.  We're done	
              1669 ;	
              1670 ; No borrow, add one food to counter and set up to subtract 15 more warriors	
              1671 ;	
1:2:2B 4AB:29 1672         ldx   4         	
1:2:16 496:4C 1673         tcy   3         	
1:2:2C 4AC:3E 1674         imac            	
1:2:18 498:27 1675         tam             ; Increment 4/3 - We had no borrow so add another food consumed this round	
1:2:30 4B0:29 1676         ldx   4         	
1:2:21 4A1:44 1677         tcy   2         	
1:2:02 482:6A 1678         tcmiy 5         ; 4/2 = 5 - Subtract 15 on the second and subsequent iterations	
1:2:05 485:8E 1679         br    S48E      ; Subtract again	
              1680 ;	
              1681 ; There was a borrow; we're done with the subtract loop (aka division).  4/3 has how much food was consumed + 1	
              1682 ;	
1:2:0B 48B:2C 1683 S48B    ldx   1         	
1:2:17 497:4C 1684         tcy   3         	
1:2:2E 4AE:38 1685         tbit1 0         ; Beast in player inventory?	
1:2:1C 49C:29 1686         ldx   4         	
1:2:38 4B8:07 1687         dman            ; Pick up 4/3 and subtract 1	
1:2:31 4B1:27 1688         tam             ; Save corrected food consumed	
              1689 ;	
              1690 ; Set up to subtract food consumed from player's food inventory	
              1691 ;	
1:2:23 4A3:29 1692         ldx   4         	
1:2:06 486:21 1693         tma             ; Pick up food consumed (again?)	
1:2:0D 48D:48 1694         tcy   1         	
1:2:1B 49B:60 1695         tcmiy 0         ; 4/1 = 0	
1:2:36 4B6:27 1696         tam             ; Store food consumed in 4/2	
1:2:2D 4AD:13 1697         ldp   12        	
1:2:1A 49A:EC 1698         call  CPY1TO5   ; Copy current player Food count to 5/1-2	
1:2:34 4B4:13 1699         ldp   12        	
1:2:29 4A9:C8 1700         call  SUBB10    ; Subtract food consumed from food count	
1:2:12 492:3F 1701         mnez            ; Was there a borrow during subtraction?	
1:2:24 4A4:D4 1702         call  S494      ; Yep.  We're at negative food, set it back to 00	
1:2:08 488:15 1703         ldp   10        	
1:2:11 491:E4 1704         call  CPY5TO1   ; Update player food inventory from math results in 5/1-2	
              1705 ;	
              1706 ; Now, deal with soldiers dying from starvation if applicable	
              1707 ;	
1:2:22 4A2:2D 1708         ldx   5         	
1:2:04 484:40 1709         tcy   0         	
1:2:09 489:1C 1710         ldp   3         	
1:2:13 493:3F 1711         mnez            ; Check 5/0 for borrow	
1:2:26 4A6:80 1712         br    L4C0      ; Yep.  Warriors died; play the death march and update counts	
              1713 ;	
              1714 ; Nobody died...	
              1715 ;	
1:2:0C 48C:29 1716         ldx   4         	
1:2:19 499:4C 1717         tcy   3         	
1:2:32 4B2:21 1718         tma             ; Pick up how much food was consumed from 4/3	
1:2:25 4A5:48 1719         tcy   1         ; Prep for doing the math	
1:2:0A 48A:60 1720         tcmiy 0         ; 4/1 = 0	
1:2:15 495:24 1721         tamdyn          ; 4/2 = consumed food	
1:2:2A 4AA:AF 1722         br    L4EF      ; Check to see if the low food warning should be played	
              1723 	
1:2:14 494:48 1724 S494    tcy   1         	
1:2:28 4A8:60 1725         tcmiy 0         	
1:2:10 490:60 1726         tcmiy 0         	
1:2:20 4A0:0F 1727         retn            	
              1728 	
              1729 	
              1730 ; *** Chapter 1 page 3	
              1731 	
              1732 ;	
              1733 ; Handle warrior starvation	
              1734 ;	
1:3:00 4C0:29 1735 L4C0    ldx   4         	
1:3:01 4C1:48 1736         tcy   1         	
1:3:03 4C3:60 1737         tcmiy 0         ; 4/1 = 0	
1:3:07 4C7:68 1738         tcmiy 1         ; 4/2 = 1	
1:3:0F 4CF:1A 1739         ldp   5         	
1:3:1F 4DF:C0 1740         call  SUBWARR   	
1:3:3F 4FF:1C 1741         ldp   3         	
1:3:3E 4FE:0B 1742         tpc             	
1:3:3D 4FD:1D 1743         ldp   11        	
1:3:3B 4FB:C5 1744         call  PLYDETH   	
1:3:37 4F7:B8 1745         br    S4F8      	
              1746 ;	
              1747 ; Determine if the Low Food warning should be played by multiplying the consumed food by 4	
              1748 ; and subtracting it from the player's current inventory	
              1749 ;	
1:3:2F 4EF:2D 1750 L4EF    ldx   5         	
1:3:1E 4DE:60 1751         tcmiy 0         ; 5/1 = 0	
1:3:3C 4FC:27 1752         tam             ; 5/2 = consumed food	
1:3:39 4F9:13 1753         ldp   12        	
1:3:33 4F3:F4 1754         call  ADDB10    ; Double consumed food	
1:3:27 4E7:13 1755         ldp   12        	
1:3:0E 4CE:E7 1756         call  CPY5TO4   ; Copy total to 4/1-2	
1:3:1D 4DD:13 1757         ldp   12        	
1:3:3A 4FA:F4 1758         call  ADDB10    ; Double it again	
1:3:35 4F5:13 1759         ldp   12        	
1:3:2B 4EB:E7 1760         call  CPY5TO4   ; Copy it	
1:3:16 4D6:13 1761         ldp   12        	
1:3:2C 4EC:EC 1762         call  CPY1TO5   ; Pick up player food	
1:3:18 4D8:13 1763         ldp   12        	
1:3:30 4F0:C8 1764         call  SUBB10    ; Subtract food from total player food	
1:3:21 4E1:3F 1765         mnez            ; Check for borrow	
1:3:02 4C2:8B 1766         br    S4CB      ; Yep, play the low food warning	
1:3:05 4C5:B8 1767         br    S4F8      ; Nope carry on	
              1768 ;	
              1769 ; Play the low food warning	
              1770 ;	
1:3:0B 4CB:1C 1771 S4CB    ldp   3         	
1:3:17 4D7:0B 1772         tpc             	
1:3:2E 4EE:17 1773         ldp   14        	
1:3:1C 4DC:C3 1774         call  PLWFOOD   	
              1775 ;	
              1776 ; Save current player information into save buffer	
              1777 ;	
1:3:38 4F8:28 1778 S4F8    ldx   0         	
1:3:31 4F1:D3 1779         call  S4D3      	
1:3:23 4E3:2C 1780         ldx   1         	
1:3:06 4C6:D3 1781         call  S4D3      	
1:3:0D 4CD:2A 1782         ldx   2         	
1:3:1B 4DB:D3 1783         call  S4D3      	
              1784 ;	
              1785 ; Check to see if player was cursed.  If so, clear the curse and end their turn.	
              1786 ;	
1:3:36 4F6:28 1787         ldx   0         	
1:3:2D 4ED:4C 1788         tcy   3         	
1:3:1A 4DA:3A 1789         tbit1 1         ; Was player cursed (0/3 bit 1 clear)?	
1:3:34 4F4:88 1790         br    S4C8      ; Nope - bit 1 was set	
1:3:29 4E9:32 1791         sbit  1         ; Clear the curse and end their turn	
1:3:12 4D2:10 1792         ldp   0         	
1:3:24 4E4:8F 1793         br    ENDTURN   	
              1794 	
1:3:08 4C8:2B 1795 S4C8    ldx   6         	
1:3:11 4D1:4F 1796         tcy   15        	
1:3:22 4E2:22 1797         tmy             ; See what key was pressed	
1:3:04 4C4:12 1798         ldp   4         	
1:3:09 4C9:80 1799         br    L500      	
              1800 ;	
              1801 ; Copy current player information into save buffer	
              1802 ;	
1:3:13 4D3:48 1803 S4D3    tcy   1         ; Copy X/1 to X/13	
1:3:26 4E6:21 1804         tma             	
1:3:0C 4CC:4B 1805         tcy   13        	
1:3:19 4D9:27 1806         tam             	
1:3:32 4F2:44 1807         tcy   2         ; Copy X/2 to X/14	
1:3:25 4E5:21 1808         tma             	
1:3:0A 4CA:47 1809         tcy   14        	
1:3:15 4D5:27 1810         tam             	
1:3:2A 4EA:4C 1811         tcy   3         ; Copy X/3 to X/15	
1:3:14 4D4:21 1812         tma             	
1:3:28 4E8:4F 1813         tcy   15        	
1:3:10 4D0:27 1814         tam             	
1:3:20 4E0:0F 1815         retn            	
              1816 	
              1817 	
              1818 ; *** Chapter 1 page 4	
              1819 	
              1820 ;	
              1821 ; Handle Move being pressed	
              1822 ;	
1:4:00 500:56 1823 L500    ynec  6         	
1:4:01 501:8F 1824         br    S50F      	
1:4:03 503:1E 1825         ldp   7         	
1:4:07 507:80 1826         br    DOMOVE    	
              1827 ;	
              1828 ; Handle Sanctuary/Citadel being pressed	
              1829 ;	
1:4:0F 50F:55 1830 S50F    ynec  10        	
1:4:1F 51F:BD 1831         br    S53D      	
1:4:3F 53F:13 1832         ldp   12        	
1:4:3E 53E:99 1833         br    DOSANCT   	
              1834 ;	
              1835 ; Handle Frontier being pressed	
              1836 ;	
1:4:3D 53D:5E 1837 S53D    ynec  7         ; Did they hit the Frontier button?	
1:4:3B 53B:A3 1838         br    S523      	
1:4:37 537:1C 1839         ldp   3         	
1:4:2F 52F:0B 1840         tpc             	
1:4:1E 51E:11 1841         ldp   8         	
1:4:3C 53C:EE 1842         call  PLYFRNT   	
              1843 ;	
              1844 ; Handle determining whether they've found the key in this region or not	
              1845 ;	
              1846 ; There's no real magic to the Frontier thing.  The entirety of it is the "KeyNotFound" flag at 2/3 bit 0.  If	
              1847 ; it's set to 1, the key hasn't been found yet and you can still be awarded a key.  If it's set to 0, the key	
              1848 ; has been found and you won't be awarded a key as loot.  The Frontier button simply checks this flag; if it's	
              1849 ; set, you get a Key Missing.  If it's cleared, it gets set.	
              1850 ;	
1:4:39 539:2A 1851         ldx   2         	
1:4:33 533:4C 1852         tcy   3         	
1:4:27 527:38 1853         tbit1 0         ; If bit 0 is set the key hasn't been found yet	
1:4:0E 50E:AB 1854         br    S52B      ; It was set - Key missing	
1:4:1D 51D:30 1855         sbit  0         ; Reset Key not found (move us to a new region)	
1:4:3A 53A:10 1856 S53A    ldp   0         	
1:4:35 535:8F 1857         br    ENDTURN   ; End the turn	
1:4:2B 52B:3E 1858 S52B    imac            ; Increment key flags and load into accumulator	
1:4:16 516:BA 1859         br    S53A      ; Overflow - They have all of the keys already; they can go to any territory	
              1860 ;	
              1861 ; Handle showing Key Missing	
              1862 ;	
1:4:2C 52C:4A 1863 KEYMISS tcy   5         ; Wizard/Bazaar Closed/Key Missing	
1:4:18 518:15 1864         ldp   10        	
1:4:30 530:D4 1865         call  ROTDRM2   	
1:4:21 521:4A 1866         tcy   5         ; Select lower map	
1:4:02 502:0D 1867         setr            ; Turn it on	
1:4:05 505:1C 1868 L505    ldp   3         	
1:4:0B 50B:0B 1869         tpc             	
1:4:17 517:1D 1870         ldp   11        	
1:4:2E 52E:C0 1871         call  PLYFAIL   	
1:4:1C 51C:4A 1872         tcy   5         ; Select lower lamp	
1:4:38 538:0C 1873         rstr            ; Turn it off	
1:4:31 531:BA 1874         br    S53A      ; End their turn	
              1875 ;	
              1876 ; Handle Inventory being pressed	
              1877 ;	
1:4:23 523:5D 1878 S523    ynec  11        ; Did they hit Inventory?	
1:4:06 506:A9 1879         br    S529      ; Nope	
1:4:0D 50D:29 1880         ldx   4         	
1:4:1B 51B:4B 1881         tcy   13        	
1:4:36 536:60 1882         tcmiy 0         ; No changes for this round (4/13-14 = 0)	
1:4:2D 52D:60 1883         tcmiy 0	
1:4:1A 51A:13 1884         ldp   12        	
1:4:34 534:8D 1885         br    L70D      ; Put a 12 in 4/15 then run through the inventory	
              1886 ;	
              1887 ; Player is doing an activity that resets the "Citadel visited" flag; reset it	
              1888 ;	
1:4:29 529:23 1889 S529    tya             	
1:4:12 512:28 1890         ldx   0         	
1:4:24 524:4C 1891         tcy   3         	
1:4:08 508:34 1892         rbit  0         ; Reset 0/3 Bit 0 "Citadel visited" flag	
1:4:11 511:20 1893         tay             	
              1894 ;	
              1895 ; Handle Tomb/Ruin being pressed	
              1896 ;	
1:4:22 522:54 1897         ynec  2         ; Did they hit Tomb/Ruin?	
1:4:04 504:99 1898         br    S519      ; Nope	
1:4:09 509:14 1899         ldp   2         	
1:4:13 513:0B 1900         tpc             	
1:4:26 526:1C 1901         ldp   3         	
1:4:0C 50C:99 1902         br    L8D9      	
              1903 ;	
              1904 ; Handle Bazaar being pressed	
              1905 ;	
1:4:19 519:5A 1906 S519    ynec  5         ; Did they hit Bazaar?	
1:4:32 532:94 1907         br    S514      ; Nope	
1:4:25 525:14 1908         ldp   2         	
1:4:0A 50A:0B 1909         tpc             	
1:4:15 515:15 1910         ldp   10        	
1:4:2A 52A:98 1911         br    LA98      	
              1912 ;	
              1913 ; All that's left is Dark Tower, handle it	
              1914 ;	
1:4:14 514:14 1915 S514    ldp   2         	
1:4:28 528:0B 1916         tpc             	
1:4:10 510:15 1917         ldp   10        	
1:4:20 520:A7 1918         br    LAA7      	
              1919 	
              1920 ; *** Chapter 1 page 5	
              1921 	
              1922 ;********************************************************************************	
              1923 ; SUBWARR - Warriors have died.  Subtract count in 4/1-2 from player forces	
              1924 ;********************************************************************************	
1:5:00 540:16 1925 SUBWARR ldp   6         	
              1926 ;	
              1927 ; Copy current player's Warrior count into 5/1-2; subtract the deaths and update their count	
              1928 ;	
1:5:01 541:F2 1929         call  CPY2TO5   	
1:5:03 543:13 1930         ldp   12        	
1:5:07 547:C8 1931         call  SUBB10    	
1:5:0F 54F:13 1932         ldp   12        	
1:5:1F 55F:C0 1933         call  CPY5TO2   	
              1934 ;	
              1935 ; Subtract one more warrior and see if the count goes negative, if so, the current player	
              1936 ; is out of warriors.  Deal with the situation appropriately.	
              1937 ;	
1:5:3F 57F:29 1938         ldx   4         	
1:5:3E 57E:48 1939         tcy   1         	
1:5:3D 57D:60 1940         tcmiy 0         ; 4/1 = 0	
1:5:3B 57B:68 1941         tcmiy 1         ; 4/2 = 1	
1:5:37 577:10 1942         ldp   0         	
1:5:2F 56F:0B 1943         tpc             	
1:5:1E 55E:13 1944         ldp   12        	
1:5:3C 57C:C7 1945         call  L307      ; Do a subtraction without clearing 5/0 (borrow)	
1:5:39 579:3F 1946         mnez            ; Check borrow (negative warriors?)	
1:5:33 573:AC 1947         br    S56C      ; Yep.  Everyone died.	
              1948 	
1:5:27 567:16 1949 S567    ldp   6         	
1:5:0E 54E:BB 1950         br    L5BB      ; Go figure out how much Gold the remaining Warriors can carry	
              1951 ;	
              1952 ; Multiplayer game and player has lost all of their warriors.  Give them one.	
              1953 ;	
1:5:1D 55D:2A 1954 S55D    ldx   2         	
1:5:3A 57A:48 1955         tcy   1         	
1:5:35 575:60 1956         tcmiy 0         ; 2/1 = 0	
1:5:2B 56B:68 1957         tcmiy 1         ; 2/1 = 1	
1:5:16 556:A7 1958         br    S567      ; Carry on...	
              1959 ;	
              1960 ; Warrior count is negative; deal with it appropriately	
              1961 ;	
1:5:2C 56C:2E 1962 S56C    ldx   3         	
1:5:18 558:49 1963         tcy   9         ; 3/9 = player count	
1:5:30 570:21 1964         tma             ; Pick up number of players	
1:5:21 561:7B 1965         a14aac          ; Add 14 (2+ players)	
1:5:02 542:9D 1966         br    S55D      ; This isn't a single-player game	
              1967 ;	
              1968 ; Single player game - they lost all of their warriors so they lose with a score of 00	
              1969 ;	
1:5:05 545:46 1970         tcy   6         ; Victory/Warrior/Brigand	
1:5:0B 54B:15 1971         ldp   10        	
1:5:17 557:D4 1972         call  ROTDRM2   	
1:5:2E 56E:46 1973         tcy   6         ; Select middle lamp	
1:5:1C 55C:0D 1974         setr            ; Light it	
1:5:38 578:1C 1975         ldp   3         	
1:5:31 571:0B 1976         tpc             	
1:5:23 563:1D 1977         ldp   11        	
1:5:06 546:C5 1978         call  PLYDETH   	
1:5:0D 54D:46 1979         tcy   6         ; Select middle lamp	
1:5:1B 55B:0C 1980         rstr            ; Turn it off	
1:5:36 576:2D 1981         ldx   5         	
1:5:2D 56D:48 1982         tcy   1         	
1:5:1A 55A:60 1983         tcmiy 0         ; 5/1 = 0	
1:5:34 574:60 1984         tcmiy 0         ; 5/2 = 0	
1:5:29 569:10 1985 L569    ldp   0         	
1:5:12 552:0B 1986         tpc             	
1:5:24 564:11 1987         ldp   8         	
1:5:08 548:E4 1988         call  BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2 (Display "00")	
1:5:11 551:17 1989         ldp   14        	
1:5:22 562:B2 1990         br    L7B2      ; Prompt the player and end the game	
              1991 	
              1992 ;********************************************************************************	
              1993 ; SUBGOLD - Subtract the number of bags of gold in 4/1-2 from the player's hoard	
              1994 ;********************************************************************************	
1:5:04 544:13 1995 SUBGOLD ldp   12        	
1:5:09 549:D7 1996         call  CPY0TO5   	
1:5:13 553:13 1997         ldp   12        	
1:5:26 566:C8 1998         call  SUBB10    	
1:5:0C 54C:3F 1999         mnez            	
1:5:19 559:CA 2000         call  S54A      	
1:5:32 572:13 2001         ldp   12        	
1:5:25 565:BD 2002         br    CPY5TO0   	
1:5:0A 54A:48 2003 S54A    tcy   1         	
1:5:15 555:60 2004         tcmiy 0         	
1:5:2A 56A:60 2005         tcmiy 0         	
1:5:14 554:0F 2006         retn            	
              2007 	
1:5:28 568:21 2008         tma             	
1:5:10 550:0A 2009         tdo             	
1:5:20 560:05 2010         iyc             	
              2011 	
              2012 ; *** Chapter 1 page 6	
              2013 	
              2014 ;********************************************************************************	
              2015 ; ADDGOLD - Add the number of bags of gold in 4/1-2 to the player's hoard	
              2016 ;********************************************************************************	
1:6:00 580:13 2017 ADDGOLD ldp   12        	
1:6:01 581:D7 2018         call  CPY0TO5   	
1:6:03 583:13 2019         ldp   12        	
1:6:07 587:F4 2020         call  ADDB10    	
1:6:0F 58F:17 2021         ldp   14        	
1:6:1F 59F:3F 2022         mnez            	
1:6:3F 5BF:F1 2023         call  LOAD99    	
1:6:3E 5BE:13 2024         ldp   12        	
1:6:3D 5BD:FD 2025         call  CPY5TO0   	
              2026 ;	
              2027 ; Multiply Warrior count by 6 to determine how much gold they can carry	
              2028 ;	
1:6:3B 5BB:16 2029 L5BB    ldp   6         	
1:6:37 5B7:F2 2030         call  CPY2TO5   ; 5/1-2 = Warrior count	
1:6:2F 5AF:13 2031         ldp   12        	
1:6:1E 59E:E7 2032         call  CPY5TO4   ; 4/1-2 = Warrior count	
1:6:3C 5BC:13 2033         ldp   12        	
1:6:39 5B9:F4 2034         call  ADDB10    ; 5/1-2 = Warrior count + Warrior count = Warrior count x 2	
1:6:33 5B3:13 2035         ldp   12        	
1:6:27 5A7:E7 2036         call  CPY5TO4   ; 4/1-2 = Warrior count x 2	
1:6:0E 58E:10 2037         ldp   0         	
1:6:1D 59D:0B 2038         tpc             	
1:6:3A 5BA:12 2039         ldp   4         	
1:6:35 5B5:FF 2040         call  SUMB10    ; 5/1-2 = Warrior count x 2 + Warrior count x 2 = Warrior count x 4	
1:6:2B 5AB:10 2041         ldp   0         	
1:6:16 596:0B 2042         tpc             	
1:6:2C 5AC:12 2043         ldp   4         	
1:6:18 598:FF 2044         call  SUMB10    ; 5/1-2 = Warrior count x 2 + Warrior count x 4 = Warrior count x 6	
              2045 ;	
              2046 ; 5/0-2 now has the maximum gold that can be carried	
              2047 ;	
1:6:30 5B0:2C 2048         ldx   1         	
1:6:21 5A1:4C 2049         tcy   3         	
1:6:02 582:38 2050         tbit1 0         ; Do they have a Beast?	
1:6:05 585:88 2051         br    S588      ; Yep - add 50 to capacity	
              2052 	
1:6:0B 58B:2D 2053 S58B    ldx   5         	
1:6:17 597:40 2054         tcy   0         	
1:6:2E 5AE:3F 2055         mnez            ; Was there a Base10 overflow (Warrior count x 6 + 50 for beast if any > 99)?	
1:6:1C 59C:A4 2056         br    S5A4      ; Yeah, the warriors can carry more than 99 bags of gold; we're done	
              2057 	
1:6:38 5B8:13 2058         ldp   12        	
1:6:31 5B1:E7 2059         call  CPY5TO4   ; 4/1-2 = Max gold carried	
1:6:23 5A3:13 2060         ldp   12        	
1:6:06 586:D7 2061         call  CPY0TO5   ; 5/1-2 = Current gold	
1:6:0D 58D:13 2062         ldp   12        	
1:6:1B 59B:C8 2063         call  SUBB10    ; Subtract carrying capacity from current gold	
1:6:36 5B6:3F 2064         mnez            ; Was there a borrow?	
1:6:2D 5AD:A4 2065         br    S5A4      ; Yes. They have enough capacity	
              2066 ;	
              2067 ; Player's warriors can't carry that much gold.  Update player gold with their carrying capacity	
              2068 ;	
1:6:1A 59A:15 2069         ldp   10        	
1:6:34 5B4:C2 2070         call  SWP4ND5   ; 4/1-2 has maximum gold they can carry.	
1:6:29 5A9:13 2071         ldp   12        	
1:6:12 592:FD 2072         call  CPY5TO0   ; Update player gold	
              2073 	
1:6:24 5A4:0F 2074 S5A4    retn            	
              2075 ;	
              2076 ; Handle the player having a Beast	
              2077 ;	
1:6:08 588:29 2078 S588    ldx   4         	
1:6:11 591:48 2079         tcy   1         	
1:6:22 5A2:6A 2080         tcmiy 5         ; 4/1 = 5	
1:6:04 584:60 2081         tcmiy 0         ; 4/2 = 0	
1:6:09 589:10 2082         ldp   0         	
1:6:13 593:0B 2083         tpc             	
1:6:26 5A6:12 2084         ldp   4         	
1:6:0C 58C:C7 2085         call  L107      ; Add 50 to the warrior's capacity	
1:6:19 599:8B 2086         br    S58B      	
              2087 	
              2088 ;********************************************************************************	
              2089 ; CPY2TO5 - Copy 2/2-0 to 5/2-0	
              2090 ;	
              2091 ;           Copy player Warrior count to 5/2-0 to do math on it	
              2092 ;********************************************************************************	
1:6:32 5B2:44 2093 CPY2TO5 tcy   2         	
1:6:25 5A5:2A 2094 S5A5    ldx   2         	
1:6:0A 58A:21 2095         tma             	
1:6:15 595:2D 2096         ldx   5         	
1:6:2A 5AA:24 2097         tamdyn          	
1:6:14 594:A5 2098         br    S5A5      	
1:6:28 5A8:0F 2099         retn            	
              2100 	
1:6:10 590:00 2101         mnea            	
1:6:20 5A0:00 2102         mnea            	
              2103 	
              2104 ; *** Chapter 1 page 7	
              2105 	
              2106 ;********************************************************************************	
              2107 ; DOMOVE - Handle random encounters from player hitting the Move button	
              2108 ;********************************************************************************	
1:7:00 5C0:10 2109 DOMOVE  ldp   0         	
1:7:01 5C1:0B 2110         tpc             	
1:7:03 5C3:1C 2111         ldp   3         	
1:7:07 5C7:C0 2112         call  RANDOM    	
1:7:0F 5CF:73 2113         a13aac          ; Add 13 to result - 0-2 = Lost	
1:7:1F 5DF:86 2114         br    S5C6      	
              2115 ;	
              2116 ; Player is Lost 18.75% of the time (on a roll of 0-2 out of 16)	
              2117 ;	
1:7:3F 5FF:4E 2118         tcy   7         ; Cursed/Lost/Plague	
1:7:3E 5FE:15 2119         ldp   10        	
1:7:3D 5FD:D4 2120         call  ROTDRM2   	
1:7:3B 5FB:2C 2121         ldx   1         	
1:7:37 5F7:4C 2122         tcy   3         	
1:7:2F 5EF:3B 2123         tbit1 3         ; Do they have a Scout?	
1:7:1E 5DE:AC 2124         br    S5EC      ; Yes...	
              2125 	
1:7:3C 5FC:46 2126         tcy   6         ; Select middle lamp (Lost)	
1:7:39 5F9:0D 2127         setr            ; Turn it on	
1:7:33 5F3:1C 2128         ldp   3         	
1:7:27 5E7:0B 2129         tpc             	
1:7:0E 5CE:1D 2130         ldp   11        	
1:7:1D 5DD:C0 2131         call  PLYFAIL   ; LOST!	
1:7:3A 5FA:46 2132         tcy   6         ; Select middle lamp	
1:7:35 5F5:0C 2133         rstr            ; Turn it off	
1:7:2B 5EB:10 2134         ldp   0         	
1:7:16 5D6:8F 2135         br    ENDTURN   	
              2136 ;	
              2137 ; Lost but has a Scout	
              2138 ;	
1:7:2C 5EC:10 2139 S5EC    ldp   0         	
1:7:18 5D8:0B 2140         tpc             	
1:7:30 5F0:19 2141         ldp   9         	
1:7:21 5E1:CF 2142         call  LTMIDCL   ; Light Lost and clear display	
1:7:02 5C2:44 2143         tcy   2         ; Scout/Healer/Gold	
1:7:05 5C5:15 2144         ldp   10        	
1:7:0B 5CB:D4 2145         call  ROTDRM2   	
1:7:17 5D7:10 2146         ldp   0         	
1:7:2E 5EE:0B 2147         tpc             	
1:7:1C 5DC:19 2148         ldp   9         	
1:7:38 5F8:C0 2149         call  LTTOPCL   ; Light Scout and clear the display	
1:7:31 5F1:10 2150         ldp   0         	
1:7:23 5E3:94 2151         br    L414      	
              2152 ;	
              2153 ; Player wasn't lost; random number was 3-15.  Check for Dragon.	
              2154 ;	
1:7:06 5C6:19 2155 S5C6    ldp   9         	
1:7:0D 5CD:7B 2156         a14aac          ; Add 14 - 0-1 = Dragon 	
1:7:1B 5DB:9D 2157         br    L65D      	
              2158 ;	
              2159 ; Player encounters a Dragon 10% of the time (on a roll of 3-4 out of 16)	
              2160 ;	
1:7:36 5F6:42 2161         tcy   4         ; Dragon/Sword/Pegasus	
1:7:2D 5ED:15 2162         ldp   10        	
1:7:1A 5DA:D4 2163         call  ROTDRM2   	
1:7:34 5F4:4E 2164         tcy   7         	
1:7:29 5E9:0D 2165         setr            	
1:7:12 5D2:1C 2166         ldp   3         	
1:7:24 5E4:0B 2167         tpc             	
1:7:08 5C8:19 2168         ldp   9         	
1:7:11 5D1:C0 2169         call  PLYDRGN   ; DRAGON!!!	
1:7:22 5E2:4E 2170         tcy   7         	
1:7:04 5C4:0C 2171         rstr            	
1:7:09 5C9:2C 2172         ldx   1         	
1:7:13 5D3:4C 2173         tcy   3         	
1:7:26 5E6:11 2174         ldp   8         	
1:7:0C 5CC:39 2175         tbit1 2         ; Do they have a Sword?	
1:7:19 5D9:97 2176         br    L617      ; Yes!  Give them the Dragon's treasure	
              2177 ;	
              2178 ; Player doesn't have a Sword (Dragon defense)	
              2179 ;	
1:7:32 5F2:13 2180         ldp   12        	
1:7:25 5E5:D7 2181         call  CPY0TO5   ; Pick up current player Gold	
1:7:0A 5CA:15 2182         ldp   10        	
1:7:15 5D5:C2 2183         call  SWP4ND5   ; Move current player Gold up in the formula	
1:7:2A 5EA:1D 2184         ldp   11        	
1:7:14 5D4:C0 2185         call  L6C0      ; See how much Gold the dragon takes	
1:7:28 5E8:11 2186         ldp   8         	
1:7:10 5D0:80 2187         br    L600      	
1:7:20 5E0:00 2188         mnea            	
              2189 	
              2190 ; *** Chapter 1 page 8	
              2191 	
1:8:00 600:1D 2192 L600    ldp   11        	
1:8:01 601:F6 2193         call  SWPDGLD   ; Swap the Dragon's Gold with 5/1-2	
1:8:03 603:13 2194         ldp   12        	
1:8:07 607:F4 2195         call  ADDB10    	
1:8:0F 60F:17 2196         ldp   14        	
1:8:1F 61F:3F 2197         mnez            	
1:8:3F 63F:F1 2198         call  LOAD99    	
1:8:3E 63E:1D 2199         ldp   11        	
1:8:3D 63D:F6 2200         call  SWPDGLD   	
1:8:3B 63B:1A 2201         ldp   5         	
1:8:37 637:C4 2202         call  SUBGOLD   	
1:8:2F 62F:16 2203         ldp   6         	
1:8:1E 61E:F2 2204         call  CPY2TO5   ; Pick up current player Warriors	
1:8:3C 63C:15 2205         ldp   10        	
1:8:39 639:C2 2206         call  SWP4ND5   ; Move current player Warriors up in the formula	
1:8:33 633:1D 2207         ldp   11        	
1:8:27 627:C0 2208         call  L6C0      ; See how many Warriors the dragon takes	
1:8:0E 60E:15 2209         ldp   10        	
1:8:1D 61D:C0 2210         call  SWPDWAR   ; Swap the Dragon's Warriors with 5/1-2	
1:8:3A 63A:13 2211         ldp   12        	
1:8:35 635:F4 2212         call  ADDB10    	
1:8:2B 62B:17 2213         ldp   14        	
1:8:16 616:3F 2214         mnez            	
1:8:2C 62C:F1 2215         call  LOAD99    	
1:8:18 618:15 2216         ldp   10        	
1:8:30 630:C0 2217         call  SWPDWAR   	
1:8:21 621:1A 2218         ldp   5         	
1:8:02 602:C0 2219         call  SUBWARR   	
1:8:05 605:19 2220         ldp   9         	
1:8:0B 60B:AF 2221         br    L66F      	
              2222 ;	
              2223 ; Player has a sword; reward the Dragon's TREASURE!	
              2224 ;	
1:8:17 617:35 2225 L617    rbit  2         	
1:8:2E 62E:46 2226         tcy   6         ; Select middle lamp	
1:8:1C 61C:0D 2227         setr            ; Turn it on	
1:8:38 638:1C 2228         ldp   3         	
1:8:31 631:0B 2229         tpc             	
1:8:23 623:19 2230         ldp   9         	
1:8:06 606:F8 2231         call  PLYDSWD   ; Play the Sword defense sound	
1:8:0D 60D:46 2232         tcy   6         ; Select the middle lamp	
1:8:1B 61B:0C 2233         rstr            ; Turn it off	
              2234 ;	
              2235 ; Pick up the Dragon's Warriors from 3/5-6 and add them to the player's forces	
              2236 ;	
1:8:36 636:2E 2237         ldx   3         	
1:8:2D 62D:4A 2238         tcy   5         	
1:8:1A 61A:21 2239         tma             ; Pick up 3/5	
1:8:34 634:29 2240         ldx   4         	
1:8:29 629:48 2241         tcy   1         	
1:8:12 612:27 2242         tam             ; Store it in 4/1	
1:8:24 624:2E 2243         ldx   3         	
1:8:08 608:46 2244         tcy   6         	
1:8:11 611:21 2245         tma             ; Pick up 3/6	
1:8:22 622:29 2246         ldx   4         	
1:8:04 604:44 2247         tcy   2         	
1:8:09 609:27 2248         tam             ; Store it in 4/2	
1:8:13 613:15 2249         ldp   10        	
1:8:26 626:C6 2250         call  ADDWARR   ; Add those Warriors to the players forces	
              2251 ;	
              2252 ; Pick up the Dragon's bags of Gold from 3/7-8 and add them to the player's hoard	
              2253 ;	
1:8:0C 60C:2E 2254         ldx   3         	
1:8:19 619:4E 2255         tcy   7         	
1:8:32 632:21 2256         tma             ; Pick up 3/7	
1:8:25 625:29 2257         ldx   4         	
1:8:0A 60A:48 2258         tcy   1         	
1:8:15 615:27 2259         tam             ; Store it in 4/1	
1:8:2A 62A:2E 2260         ldx   3         	
1:8:14 614:41 2261         tcy   8         	
1:8:28 628:21 2262         tma             ; Pick up 3/8	
1:8:10 610:19 2263         ldp   9         	
1:8:20 620:80 2264         br    L640      	
              2265 	
              2266 ; *** Chapter 1 page 9	
              2267 	
1:9:00 640:29 2268 L640    ldx   4         	
1:9:01 641:44 2269         tcy   2         	
1:9:03 643:27 2270         tam             ; Store it in 4/2	
1:9:07 647:16 2271         ldp   6         	
1:9:0F 64F:C0 2272         call  ADDGOLD   ; Add that gold to the player's hoard	
              2273 ;	
              2274 ; Reset the Dragon's treasure to defaults (2 Warriors, 6 bags of Gold)	
              2275 ;	
1:9:1F 65F:2E 2276         ldx   3         	
1:9:3F 67F:4A 2277         tcy   5         	
1:9:3E 67E:60 2278         tcmiy 0         ; 3/5 = 0	
1:9:3D 67D:64 2279         tcmiy 2         ; 3/6 = 2 - 2 Warriors	
1:9:3B 67B:60 2280         tcmiy 0         ; 3/7 = 0	
1:9:37 677:66 2281         tcmiy 6         ; 3/8 = 6 - 6 bags of Gold	
1:9:2F 66F:29 2282 L66F    ldx   4         	
1:9:1E 65E:4B 2283         tcy   13        	
1:9:3C 67C:65 2284         tcmiy 10        ; 4/13 = 0b1010 - Gold and Warrior count has changed	
1:9:39 679:13 2285 L679    ldp   12        	
1:9:33 673:C9 2286         call  CALLDSP   ; Display player's updated inventory	
1:9:27 667:10 2287         ldp   0         	
              2288 	
1:9:0E 64E:8F 2289         br    ENDTURN   	
              2290 ;	
              2291 ; Player wasn't Lost or ran into a Dragon; random number was 5-15, check for Plague	
              2292 ;	
1:9:1D 65D:1D 2293 L65D    ldp   11        	
1:9:3A 67A:73 2294         a13aac          ; Add 13 to result - 0-2 = Plague	
1:9:35 675:A5 2295         br    L6E5      ; No Plague...	
              2296 ;	
              2297 ; Player gets Plague 18.75% of the time (on a roll of 5-7 out of 16)	
              2298 ;	
1:9:2B 66B:4E 2299         tcy   7         ; Cursed/Lost/Plague	
1:9:16 656:15 2300         ldp   10        	
1:9:2C 66C:D4 2301         call  ROTDRM2   	
1:9:18 658:2C 2302         ldx   1         	
1:9:30 670:4C 2303         tcy   3         	
1:9:21 661:3A 2304         tbit1 1         ; Healer?	
1:9:02 642:92 2305         br    S652      ; Yep!	
              2306 	
1:9:05 645:4A 2307         tcy   5         ; Select lower lamp	
1:9:0B 64B:0D 2308         setr            ; Turn it on	
1:9:17 657:1C 2309         ldp   3         	
1:9:2E 66E:0B 2310         tpc             	
1:9:1C 65C:1D 2311         ldp   11        	
1:9:38 678:C5 2312         call  PLYDETH   ; Play the death march	
1:9:31 671:4A 2313         tcy   5         ; Select lower lamp	
1:9:23 663:0C 2314         rstr            ; Turn it off	
1:9:06 646:29 2315         ldx   4         	
1:9:0D 64D:48 2316         tcy   1         	
1:9:1B 65B:60 2317         tcmiy 0         ; 4/1 = 0	
1:9:36 676:64 2318         tcmiy 2         ; 4/2 = 2	
1:9:2D 66D:1A 2319         ldp   5         	
1:9:1A 65A:C0 2320         call  SUBWARR   ; Kill some warriors	
1:9:34 674:15 2321         ldp   10        	
1:9:29 669:B2 2322         br    L6B2      	
              2323 ;	
              2324 ; Player has a Healer	
              2325 ;	
1:9:12 652:10 2326 S652    ldp   0         	
1:9:24 664:0B 2327         tpc             	
1:9:08 648:19 2328         ldp   9         	
1:9:11 651:FD 2329         call  LTLWRCL   ; Light Plague and clear display	
1:9:22 662:44 2330         tcy   2         ; Scout/Healer/Gold	
1:9:04 644:15 2331         ldp   10        	
1:9:09 649:D4 2332         call  ROTDRM2   	
1:9:13 653:10 2333         ldp   0         	
1:9:26 666:0B 2334         tpc             	
1:9:0C 64C:19 2335         ldp   9         	
1:9:19 659:CF 2336         call  LTMIDCL   ; Light Healer and clear display	
1:9:32 672:29 2337         ldx   4         	
1:9:25 665:48 2338         tcy   1         	
1:9:0A 64A:1F 2339         ldp   15        	
1:9:15 655:A5 2340         br    L7E5      	
              2341 	
1:9:2A 66A:4E 2342 L66A    tcy   7         ; Cursed/Lost/Plague	
1:9:14 654:15 2343         ldp   10        	
1:9:28 668:D4 2344         call  ROTDRM2   	
1:9:10 650:14 2345         ldp   2         	
1:9:20 660:80 2346         br    L480      	
              2347 	
              2348 ; *** Chapter 1 page 10	
              2349 	
              2350 ;********************************************************************************	
              2351 ; SWPDWAR - Swap 3/5 <-> 5/1 and 3/6 <-> 5/2 (Dragon's Warrior treasure)	
              2352 ;********************************************************************************	
1:A:00 680:2E 2353 SWPDWAR ldx   3         	
1:A:01 681:4A 2354         tcy   5         	
1:A:03 683:21 2355         tma             	
1:A:07 687:2D 2356         ldx   5         	
1:A:0F 68F:48 2357         tcy   1         	
1:A:1F 69F:03 2358         xma             	
1:A:3F 6BF:2E 2359         ldx   3         	
1:A:3E 6BE:4A 2360         tcy   5         	
1:A:3D 6BD:25 2361         tamiyc          	
1:A:3B 6BB:21 2362         tma             	
1:A:37 6B7:2D 2363         ldx   5         	
1:A:2F 6AF:44 2364         tcy   2         	
1:A:1E 69E:03 2365         xma             	
1:A:3C 6BC:2E 2366         ldx   3         	
1:A:39 6B9:46 2367         tcy   6         	
1:A:33 6B3:27 2368         tam             	
1:A:27 6A7:0F 2369         retn            	
              2370 	
              2371 ;********************************************************************************	
              2372 ; ADDFOOD - Add the amount of food in 4/1-2 to the current player's inventory	
              2373 ;********************************************************************************	
1:A:0E 68E:13 2374 ADDFOOD ldp   12        	
1:A:1D 69D:EC 2375         call  CPY1TO5   	
1:A:3A 6BA:13 2376         ldp   12        	
1:A:35 6B5:F4 2377         call  ADDB10    	
1:A:2B 6AB:17 2378         ldp   14        	
1:A:16 696:3F 2379         mnez            	
1:A:2C 6AC:F1 2380         call  LOAD99    	
1:A:18 698:15 2381         ldp   10        	
1:A:30 6B0:E4 2382         call  CPY5TO1   	
1:A:21 6A1:0F 2383         retn            	
              2384 	
              2385 ;********************************************************************************	
              2386 ; SWP4ND5 - Swap 4/2-0 with 5/2-0.	
              2387 ;	
              2388 ; Utility routine used in conjunction with the CPYxTOy for math	
              2389 ;********************************************************************************	
1:A:02 682:29 2390 SWP4ND5 ldx   4         	
1:A:05 685:44 2391         tcy   2         	
1:A:0B 68B:21 2392 S68B    tma             	
1:A:17 697:2D 2393         ldx   5         	
1:A:2E 6AE:03 2394         xma             	
1:A:1C 69C:29 2395         ldx   4         	
1:A:38 6B8:24 2396         tamdyn          	
1:A:31 6B1:8B 2397         br    S68B      	
1:A:23 6A3:0F 2398         retn            	
              2399 	
              2400 ;********************************************************************************	
              2401 ; ADDWARR - Add value in 4/1-2 to current player's Warrior count	
              2402 ;********************************************************************************	
1:A:06 686:16 2403 ADDWARR ldp   6         	
1:A:0D 68D:F2 2404         call  CPY2TO5   ; Pick up player Warrior count	
1:A:1B 69B:13 2405         ldp   12        	
1:A:36 6B6:F4 2406         call  ADDB10    ; Add 4/1-2 to the count	
1:A:2D 6AD:17 2407         ldp   14        	
1:A:1A 69A:3F 2408         mnez            ; Check for overflow (can't exceed 99 warriors)	
1:A:34 6B4:F1 2409         call  LOAD99    	
1:A:29 6A9:13 2410         ldp   12        	
1:A:12 692:80 2411         br    CPY5TO2   ; Update player Warrior count	
              2412 	
              2413 ;********************************************************************************	
              2414 ; CPY5TO1 - Update player Food after Base10 math	
              2415 ;********************************************************************************	
1:A:24 6A4:44 2416 CPY5TO1 tcy   2         	
1:A:08 688:2D 2417 S688    ldx   5         	
1:A:11 691:21 2418         tma             	
1:A:22 6A2:2C 2419         ldx   1         	
1:A:04 684:24 2420         tamdyn          	
1:A:09 689:50 2421         ynec  0         	
1:A:13 693:88 2422         br    S688      	
1:A:26 6A6:0F 2423         retn            	
              2424 ;	
              2425 ; Add Warriors in 4/1-2, mark Warrior count as changed and display results	
              2426 ;	
              2427 ; This is called from Plague when player has a Healer	
              2428 ;	
1:A:0C 68C:15 2429 L68C    ldp   10        	
1:A:19 699:C6 2430         call  ADDWARR   	
1:A:32 6B2:29 2431 L6B2    ldx   4         	
1:A:25 6A5:4B 2432         tcy   13        	
1:A:0A 68A:34 2433         rbit  0         	
1:A:15 695:19 2434         ldp   9         	
1:A:2A 6AA:B9 2435         br    L679      	
              2436 	
              2437 ;********************************************************************************	
              2438 ; ROTDRM2 - Local copy of ROTDRUM in Chapter 1	
              2439 ;********************************************************************************	
1:A:14 694:10 2440 ROTDRM2 ldp   0         	
1:A:28 6A8:0B 2441         tpc             	
1:A:10 690:11 2442         ldp   8         	
1:A:20 6A0:95 2443         br    ROTDRUM   	
              2444 	
              2445 ; *** Chapter 1 page 11	
              2446 	
              2447 ;	
              2448 ; Called with either player Warrior or Gold inventory in 4/1-2	
              2449 ;	
              2450 ; When player has been attacked by the Dragon and doesn't	
              2451 ; have a sword for defense.  Figure out how much the Dragon will take.	
              2452 ;	
              2453 ; Formula is based on how many Warriors or how much Gold player has.  More	
              2454 ; in their inventory means the Dragon takes more.	
              2455 ;	
              2456 ; According to the manual, the dragon takes 1/4 of the player's warriors and gold.	
              2457 ;	
1:B:00 6C0:29 2458 L6C0    ldx   4         	
1:B:01 6C1:44 2459         tcy   2         	
1:B:03 6C3:21 2460         tma             ; Take a look at the 1s digit of 4/2	
1:B:07 6C7:30 2461         sbit  0         	
1:B:0F 6CF:32 2462         sbit  1         ; Start with 3	
1:B:1F 6DF:39 2463         tbit1 2         ; Do they have 4 or more of this	
1:B:3F 6FF:BD 2464         br    S6FD      ; Yes, leave bit 0 set	
1:B:3E 6FE:34 2465         rbit  0         	
1:B:3D 6FD:3B 2466 S6FD    tbit1 3         ; Do they have 8 or more of this	
1:B:3B 6FB:AF 2467         br    S6EF      ; Yep, leave bit 1 set	
1:B:37 6F7:36 2468         rbit  1         	
1:B:2F 6EF:35 2469 S6EF    rbit  2         	
1:B:1E 6DE:37 2470         rbit  3         	
              2471 	
1:B:3C 6FC:48 2472         tcy   1         ; Take a look at the 10s digit at 4/1	
1:B:39 6F9:38 2473         tbit1 0         ; At least 10	
1:B:33 6F3:B1 2474         br    S6F1      ; Add 2 more	
1:B:27 6E7:3A 2475 S6E7    tbit1 1         ; At least 20	
1:B:0E 6CE:8B 2476         br    S6CB      ; Add 5 more	
1:B:1D 6DD:30 2477 S6DD    sbit  0         	
1:B:3A 6FA:32 2478         sbit  1         	
1:B:35 6F5:39 2479         tbit1 2         	
1:B:2B 6EB:AC 2480         br    S6EC      	
1:B:16 6D6:34 2481         rbit  0         	
1:B:2C 6EC:3B 2482 S6EC    tbit1 3         	
1:B:18 6D8:A1 2483         br    S6E1      	
1:B:30 6F0:36 2484         rbit  1         	
1:B:21 6E1:35 2485 S6E1    rbit  2         	
1:B:02 6C2:37 2486         rbit  3         	
              2487 	
1:B:05 6C5:0F 2488         retn            	
              2489 	
1:B:0B 6CB:44 2490 S6CB    tcy   2         	
1:B:17 6D7:21 2491         tma             	
1:B:2E 6EE:72 2492         a5aac           	
1:B:1C 6DC:24 2493         tamdyn          	
1:B:38 6F8:9D 2494         br    S6DD      	
              2495 	
1:B:31 6F1:44 2496 S6F1    tcy   2         	
1:B:23 6E3:21 2497         tma             	
1:B:06 6C6:78 2498         a2aac           	
1:B:0D 6CD:24 2499         tamdyn          	
1:B:1B 6DB:A7 2500         br    S6E7      	
              2501 ;********************************************************************************	
              2502 ; SWPDGLD - Swap 3/7 <-> 5/1 and 3/8 <-> 5/2 (Dragon's bags of Gold treasure)	
              2503 ;********************************************************************************	
1:B:36 6F6:2E 2504 SWPDGLD ldx   3         	
1:B:2D 6ED:4E 2505         tcy   7         	
1:B:1A 6DA:21 2506         tma             	
1:B:34 6F4:2D 2507         ldx   5         	
1:B:29 6E9:48 2508         tcy   1         	
1:B:12 6D2:03 2509         xma             	
1:B:24 6E4:2E 2510         ldx   3         	
1:B:08 6C8:4E 2511         tcy   7         	
1:B:11 6D1:25 2512         tamiyc          	
1:B:22 6E2:21 2513         tma             	
1:B:04 6C4:2D 2514         ldx   5         	
1:B:09 6C9:44 2515         tcy   2         	
1:B:13 6D3:03 2516         xma             	
1:B:26 6E6:2E 2517         ldx   3         	
1:B:0C 6CC:41 2518         tcy   8         	
1:B:19 6D9:27 2519         tam             	
1:B:32 6F2:0F 2520         retn            	
              2521 ;	
              2522 ; Player wasn't Lost, ran into a Dragon or got the Plague; random number was 8-15, check for Brigands???	
              2523 ;	
1:B:25 6E5:10 2524 L6E5    ldp   0         	
1:B:0A 6CA:73 2525         a13aac          ; Add 13 to result - 0-2 = Brigands	
1:B:15 6D5:80 2526         br    L400      ; No encounter the rest of the time (31.25%)	
              2527 ;	
              2528 ; Player gets Brigands 18.75% of the time (on a roll of 8-10 out of 16)	
              2529 ;	
1:B:2A 6EA:14 2530         ldp   2         	
1:B:14 6D4:0B 2531         tpc             	
1:B:28 6E8:12 2532         ldp   4         	
1:B:10 6D0:B7 2533         br    L937      	
1:B:20 6E0:00 2534         mnea            	
              2535 	
              2536 ; *** Chapter 1 page 12	
              2537 	
              2538 ;********************************************************************************	
              2539 ; CPY5TO2 - Copy 5/2-0 to 2/2-0	
              2540 ;********************************************************************************	
1:C:00 700:44 2541 CPY5TO2 tcy   2         	
1:C:01 701:2D 2542 S701    ldx   5         	
1:C:03 703:21 2543         tma             	
1:C:07 707:2A 2544         ldx   2         	
1:C:0F 70F:24 2545 S70F    tamdyn          	
1:C:1F 71F:50 2546         ynec  0         	
1:C:3F 73F:81 2547         br    S701      	
1:C:3E 73E:0F 2548         retn            	
              2549 	
              2550 ;********************************************************************************	
              2551 ; CPY5TO0 - Copy 5/2-0 to 0/2-0	
              2552 ;********************************************************************************	
1:C:3D 73D:44 2553 CPY5TO0 tcy   2         	
1:C:3B 73B:2D 2554 S73B    ldx   5         	
1:C:37 737:21 2555         tma             	
1:C:2F 72F:28 2556         ldx   0         	
1:C:1E 71E:24 2557         tamdyn          	
1:C:3C 73C:50 2558         ynec  0         	
1:C:39 739:BB 2559         br    S73B      	
1:C:33 733:0F 2560         retn            	
              2561 	
              2562 ;********************************************************************************	
              2563 ; CPY5TO4 - Copy 5/2-0 to 4/2-0	
              2564 ;********************************************************************************	
1:C:27 727:44 2565 CPY5TO4 tcy   2         	
1:C:0E 70E:2D 2566 S70E    ldx   5         	
1:C:1D 71D:21 2567         tma             	
1:C:3A 73A:29 2568         ldx   4         	
1:C:35 735:24 2569         tamdyn          	
1:C:2B 72B:8E 2570         br    S70E      	
1:C:16 716:0F 2571         retn            	
              2572 	
              2573 ;********************************************************************************	
              2574 ; CPY1TO5 - Copy 1/2-0 to 5/2-0	
              2575 ;********************************************************************************	
1:C:2C 72C:44 2576 CPY1TO5 tcy   2         	
1:C:18 718:2C 2577 S718    ldx   1         	
1:C:30 730:21 2578         tma             	
1:C:21 721:2D 2579         ldx   5         	
1:C:02 702:24 2580         tamdyn          	
1:C:05 705:98 2581         br    S718      	
1:C:0B 70B:0F 2582         retn            	
              2583 	
              2584 ;********************************************************************************	
              2585 ; CPY0TO5 - Copy 0/2-0 to 5/2-0	
              2586 ;********************************************************************************	
1:C:17 717:44 2587 CPY0TO5 tcy   2         	
1:C:2E 72E:28 2588 S72E    ldx   0         	
1:C:1C 71C:21 2589         tma             	
1:C:38 738:2D 2590         ldx   5         	
1:C:31 731:24 2591         tamdyn          	
1:C:23 723:AE 2592         br    S72E      	
1:C:06 706:0F 2593         retn            	
              2594 	
              2595 ;********************************************************************************	
              2596 ; 	
              2597 ;********************************************************************************	
1:C:0D 70D:63 2598 L70D    tcmiy 12        	
1:C:1B 71B:13 2599         ldp   12        	
1:C:36 736:C9 2600         call  CALLDSP   ; Display results	
1:C:2D 72D:10 2601         ldp   0         	
1:C:1A 71A:8F 2602         br    ENDTURN   	
              2603 	
              2604 ;********************************************************************************	
              2605 ; ADDB10 - Call the actual Add Base 10 routine (AD2B10)	
              2606 ;********************************************************************************	
1:C:34 734:10 2607 ADDB10  ldp   0         	
1:C:29 729:0B 2608         tpc             	
1:C:12 712:12 2609         ldp   4         	
1:C:24 724:80 2610         br    AD2B10    	
              2611 	
              2612 ;********************************************************************************	
              2613 ; SUBB10 - Call the actual Subtract Base 10 routine (SU2B10)	
              2614 ;********************************************************************************	
1:C:08 708:10 2615 SUBB10  ldp   0         	
1:C:11 711:0B 2616         tpc             	
1:C:22 722:13 2617         ldp   12        	
1:C:04 704:80 2618         br    SU2B10    	
              2619 	
              2620 ;********************************************************************************	
              2621 ; CALLDSP - Local copy of DSPRSLT in Chapter 1	
              2622 ;********************************************************************************	
1:C:09 709:10 2623 CALLDSP ldp   0         	
1:C:13 713:0B 2624         tpc             	
1:C:26 726:1A 2625         ldp   5         	
1:C:0C 70C:80 2626         br    DSPRSLT   	
              2627 	
              2628 ;********************************************************************************	
              2629 ; DOSANCT - Player has hit Sanctuary/Citadel - handle the encounter	
              2630 ;********************************************************************************	
1:C:19 719:1C 2631 DOSANCT ldp   3         	
1:C:32 732:0B 2632         tpc             	
1:C:25 725:1A 2633         ldp   5         	
1:C:0A 70A:DF 2634         call  PLYSANC      	
1:C:15 715:2A 2635         ldx   2         	
1:C:2A 72A:4C 2636         tcy   3         	
1:C:14 714:1B 2637         ldp   13        	
1:C:28 728:3E 2638         imac            ; Load up the Key inventory and add 1.  If it's 0b1111, they're in the final territory	
1:C:10 710:80 2639         br    L740      ; There was a carry.  This is a Citadel visit.	
1:C:20 720:8F 2640         br    L74F      ; Sanctuary visit	
              2641 	
              2642 ; *** Chapter 1 page 13	
              2643 	
              2644 ;	
              2645 ; This is a Citadel visit.  Test 0/3 Bit 0 to see if this is just a repeat visit.	
              2646 ;	
1:D:00 740:28 2647 L740    ldx   0         	
1:D:01 741:38 2648         tbit1 0         ; Are they cheating and trying to revisit the Citadel without a Tomb run?	
1:D:03 743:99 2649         br    S759      ; Yep.  Act like this is a Sanctuary visit, bypassing any Warrior bonuses.	
1:D:07 747:30 2650         sbit  0         ; Nope.  Flag that the Citadel has been visited and give them bonuses.	
              2651 	
              2652 ;	
              2653 ; Check to see if player is eligible for additional Warriors.	
              2654 ;	
              2655 ; If they have 4 Warriors or less, give them 5-8 more on a Sanctuary run	
              2656 ;	
1:D:0F 74F:16 2657 L74F    ldp   6         	
1:D:1F 75F:F2 2658         call  CPY2TO5   ; Copy current Warriors	
1:D:3F 77F:29 2659         ldx   4         	
1:D:3E 77E:48 2660         tcy   1         	
1:D:3D 77D:69 2661         tcmiy 9         ; 4/1 = 9	
1:D:3B 77B:6A 2662         tcmiy 5         ; 4/2 = 5	
1:D:37 777:13 2663         ldp   12        	
1:D:2F 76F:F4 2664         call  ADDB10    	
1:D:1E 75E:3F 2665         mnez            ; Check for overflow, eligble for more Warriors?	
1:D:3C 77C:97 2666         br    S757      ; Nope, sorry	
              2667 ;	
              2668 ; They had 4 Warriors or less	
              2669 ;	
1:D:39 779:10 2670         ldp   0         	
1:D:33 773:0B 2671         tpc             	
1:D:27 767:1C 2672         ldp   3         	
1:D:0E 74E:C0 2673         call  RANDOM    	
1:D:1D 75D:29 2674         ldx   4         	
1:D:3A 77A:24 2675         tamdyn          ; 4/2 = Random	
1:D:35 775:60 2676         tcmiy 0         ; 4/1 = 0	
1:D:2B 76B:37 2677         rbit  3         ; Reduce random value to 0-7	
1:D:16 756:35 2678         rbit  2         ; Reduce random value to 0-3	
1:D:2C 76C:2D 2679         ldx   5         	
1:D:18 758:48 2680         tcy   1         	
1:D:30 770:60 2681         tcmiy 0         ; 5/1 = 0	
1:D:21 761:6A 2682         tcmiy 5         ; 5/2 = 5	
1:D:02 742:13 2683         ldp   12        	
1:D:05 745:F4 2684         call  ADDB10    ; Give a random value of 5-8	
1:D:0B 74B:91 2685         br    S751      	
              2686 ;	
              2687 ; They had 5 or more Warriors, check to see if they have less than 25.	
              2688 ; If so, double their forces (this is a Citadel run).	
              2689 ;	
1:D:17 757:16 2690 S757    ldp   6         	
1:D:2E 76E:F2 2691         call  CPY2TO5   ; Copy current Warriors	
1:D:1C 75C:29 2692         ldx   4         	
1:D:38 778:48 2693         tcy   1         	
1:D:31 771:6E 2694         tcmiy 7         ; 4/1 = 7	
1:D:23 763:6A 2695         tcmiy 5         ; 4/2 = 5	
1:D:06 746:13 2696         ldp   12        	
1:D:0D 74D:F4 2697         call  ADDB10    ; Add 75 to player Warrior count	
1:D:1B 75B:3F 2698         mnez            ; Overflow?	
1:D:36 776:99 2699         br    S759      ; They had more than 24 warriors; sorry.	
              2700 ;	
              2701 ; Check to see if this is a Sanctuary run or a Citadel run based on Key inventory	
              2702 ;	
1:D:2D 76D:2A 2703         ldx   2         	
1:D:1A 75A:4C 2704         tcy   3         	
1:D:34 774:3E 2705         imac            ; Check if we're in the final territory (this is a Citadel run)	
1:D:29 769:A4 2706         br    S764      ; Yep.  Double their warriors	
1:D:12 752:99 2707         br    S759      ; Nope, sorry - this is effectively a Sanctuary run	
              2708 ;	
              2709 ; This is a Citadel run and they had 5-24 Warriors; double their forces	
              2710 ;	
1:D:24 764:16 2711 S764    ldp   6         	
1:D:08 748:F2 2712         call  CPY2TO5   ; Pick up the Warrior count	
              2713 ;	
              2714 ; Add Warriors (either double for Citadel run or 5-8 more for a Sanctuary run)	
              2715 ;	
1:D:11 751:13 2716 S751    ldp   12        	
1:D:22 762:E7 2717         call  CPY5TO4   ; Copy additional Warriors to top of formula	
1:D:04 744:15 2718         ldp   10        	
1:D:09 749:C6 2719         call  ADDWARR   ; Double their forces and update their inventory	
1:D:13 753:29 2720         ldx   4         	
1:D:26 766:4B 2721         tcy   13        	
1:D:0C 74C:34 2722         rbit  0         ; Flag that Warrior count has changed	
              2723 	
              2724 ;	
              2725 ; Check to see if player is eligible for more Gold.	
              2726 ;	
              2727 ; If they have 7 bags or less, give them 9-16 more bags of Gold	
              2728 ;	
1:D:19 759:13 2729 S759    ldp   12        	
1:D:32 772:D7 2730         call  CPY0TO5   ; Copy current player's Gold	
1:D:25 765:29 2731         ldx   4         	
1:D:0A 74A:48 2732         tcy   1         	
1:D:15 755:69 2733         tcmiy 9         ; 4/1 = 9	
1:D:2A 76A:64 2734         tcmiy 2         ; 4/2 = 2	
1:D:14 754:17 2735         ldp   14        	
1:D:28 768:80 2736         br    L780      	
1:D:10 750:00 2737         mnea            	
1:D:20 760:00 2738         mnea            	
              2739 	
              2740 ; *** Chapter 1 page 14	
              2741 	
1:E:00 780:13 2742 L780    ldp   12        	
1:E:01 781:F4 2743         call  ADDB10    ; Add 92 to player's gold	
1:E:03 783:3F 2744         mnez            ; Overflow?	
1:E:07 787:B7 2745         br    S7B7      ; Nope, sorry	
              2746 ;	
              2747 ; Player had 7 bags of gold or less.  Give them 9-16 more.	
              2748 ;	
1:E:0F 78F:D7 2749         call  S797      ; Random value of 9-16 in 4/1-2	
1:E:1F 79F:16 2750         ldp   6         	
1:E:3F 7BF:C0 2751         call  ADDGOLD   ; Add additional bags to player Gold	
1:E:3E 7BE:29 2752         ldx   4         	
1:E:3D 7BD:4B 2753         tcy   13        	
1:E:3B 7BB:35 2754         rbit  2         ; Flag that Gold inventory changed	
              2755 	
              2756 ;	
              2757 ; Check to see if the player is eligible for more Food	
              2758 ;	
              2759 ; If they have 5 rations of Food or less, give them	
              2760 ;	
1:E:37 7B7:13 2761 S7B7    ldp   12        	
1:E:2F 7AF:EC 2762         call  CPY1TO5   	
1:E:1E 79E:29 2763         ldx   4         	
1:E:3C 7BC:48 2764         tcy   1         	
1:E:39 7B9:69 2765         tcmiy 9         ; 4/1 = 9	
1:E:33 7B3:62 2766         tcmiy 4         ; 4/2 = 4	
1:E:27 7A7:13 2767         ldp   12        	
1:E:0E 78E:F4 2768         call  ADDB10    	
1:E:1D 79D:3F 2769         mnez            ; Was there an overflow?	
1:E:3A 7BA:A1 2770         br    S7A1      ; Nope, sorry	
              2771 ;	
              2772 ; Player has 5 or less rations of Food.  Give them 9-16 more.	
              2773 ;	
1:E:35 7B5:D7 2774         call  S797      ; Get a random number from 9-16 into 4/1-2	
1:E:2B 7AB:15 2775         ldp   10        	
1:E:16 796:CE 2776         call  ADDFOOD   ; Add the Food to the player inventory	
1:E:2C 7AC:29 2777         ldx   4         	
1:E:18 798:4B 2778         tcy   13        	
1:E:30 7B0:36 2779         rbit  1         ; Flag that Food inventory has changed	
              2780 ;	
              2781 ; Done with Sanctuary/Citadel - show the results	
              2782 ;	
1:E:21 7A1:13 2783 S7A1    ldp   12        	
1:E:02 782:C9 2784         call  CALLDSP   ; Display results	
1:E:05 785:10 2785         ldp   0         	
1:E:0B 78B:8F 2786         br    ENDTURN   	
              2787 	
1:E:17 797:10 2788 S797    ldp   0         	
1:E:2E 7AE:0B 2789         tpc             	
1:E:1C 79C:12 2790         ldp   4         	
1:E:38 7B8:A9 2791         br    L129      	
              2792 	
1:E:31 7B1:48 2793 LOAD99  tcy   1         	
1:E:23 7A3:69 2794         tcmiy 9         	
1:E:06 786:69 2795         tcmiy 9         	
1:E:0D 78D:0F 2796         retn            	
              2797 ;********************************************************************************	
              2798 ; CPYTRNC - Copy the turn counter for math 	
              2799 ; 	
              2800 ; Swap 3/3 <-> 5/1 and 3/4 <-> 5/2	
              2801 ;********************************************************************************	
1:E:1B 79B:2E 2802 CPYTRNC ldx   3         	
1:E:36 7B6:4C 2803         tcy   3         	
1:E:2D 7AD:21 2804         tma             	
1:E:1A 79A:2D 2805         ldx   5         	
1:E:34 7B4:48 2806         tcy   1         	
1:E:29 7A9:03 2807         xma             	
1:E:12 792:2E 2808         ldx   3         	
1:E:24 7A4:4C 2809         tcy   3         	
1:E:08 788:25 2810         tamiyc	
1:E:11 791:21 2811         tma             	
1:E:22 7A2:2D 2812         ldx   5         	
1:E:04 784:44 2813         tcy   2         	
1:E:09 789:03 2814         xma             	
1:E:13 793:2E 2815         ldx   3         	
1:E:26 7A6:42 2816         tcy   4         	
1:E:0C 78C:27 2817         tam	
1:E:19 799:0F 2818         retn            	
              2819 	
1:E:32 7B2:10 2820 L7B2    ldp   0         	
1:E:25 7A5:0B 2821         tpc             	
1:E:0A 78A:1E 2822         ldp   7         	
1:E:15 795:CB 2823         call  PROMPT      	
1:E:2A 7AA:1F 2824         ldp   15        	
1:E:14 794:94 2825         br    L7D4      	
1:E:28 7A8:0D 2826         setr            	
1:E:10 790:0C 2827         rstr            	
1:E:20 7A0:05 2828         iyc             	
              2829 	
              2830 ; *** Chapter 1 page 15	
              2831 	
              2832 ;********************************************************************************	
              2833 ; PLYOPEN - Play the tomb open sound	
              2834 ;********************************************************************************	
1:F:00 7C0:2B 2835 PLYOPEN ldx   6         	
1:F:01 7C1:40 2836         tcy   0         	
1:F:03 7C3:60 2837         tcmiy 0         ; 6/0 = 0	
1:F:07 7C7:64 2838         tcmiy 2         ; 6/1 = 2	
1:F:0F 7CF:CB 2839 S7CF    call  S7CB      	
1:F:1F 7DF:74 2840         a3aac           	
1:F:3F 7FF:BD 2841         br    S7FD      	
1:F:3E 7FE:AF 2842         br    S7EF      	
1:F:3D 7FD:25 2843 S7FD    tamiyc          	
1:F:3B 7FB:3E 2844         imac            	
1:F:37 7F7:B2 2845         br    S7F2      ; Return	
1:F:2F 7EF:27 2846 S7EF    tam             	
1:F:1E 7DE:8F 2847         br    S7CF      	
              2848 	
              2849 ;********************************************************************************	
              2850 ; PLYCLOS - Play the tomb close sound (tomb is empty) and end the turn	
              2851 ;********************************************************************************	
1:F:3C 7FC:2B 2852 PLYCLOS ldx   6         	
1:F:39 7F9:40 2853         tcy   0         	
1:F:33 7F3:6F 2854         tcmiy 15        ; 6/0 = 15	
1:F:27 7E7:6F 2855         tcmiy 15        ; 6/1 = 15	
1:F:0E 7CE:CB 2856 S7CE    call  S7CB      	
1:F:1D 7DD:73 2857         a13aac          	
1:F:3A 7FA:82 2858         br    S7C2      	
1:F:35 7F5:25 2859         tamiyc          	
1:F:2B 7EB:07 2860         dman            	
1:F:16 7D6:27 2861         tam             	
1:F:2C 7EC:73 2862         a13aac          	
1:F:18 7D8:8E 2863         br    S7CE      	
1:F:30 7F0:10 2864         ldp   0         	
1:F:21 7E1:8F 2865         br    ENDTURN   	
1:F:02 7C2:27 2866 S7C2    tam             	
1:F:05 7C5:8E 2867         br    S7CE      	
              2868 ;	
              2869 ; Probably play a tick and delay based on contents of 6/0-1	
              2870 ; Used by Tomb open/close routines	
              2871 ;	
1:F:0B 7CB:45 2872 S7CB    tcy   10        ; Select speaker out	
1:F:17 7D7:0D 2873         setr            ; Set the speaker	
1:F:2E 7EE:02 2874         ynea            	
1:F:1C 7DC:02 2875         ynea            	
1:F:38 7F8:02 2876         ynea            	
1:F:31 7F1:02 2877         ynea            	
1:F:23 7E3:2B 2878         ldx   6         	
1:F:06 7C6:0C 2879         rstr            ; Reset the speaker	
1:F:0D 7CD:40 2880         tcy   0         	
1:F:1B 7DB:21 2881         tma             ; A = 6/0	
1:F:36 7F6:05 2882         iyc             	
1:F:2D 7ED:22 2883         tmy             ; Y = 6/1	
1:F:1A 7DA:2F 2884         ldx   7         	
1:F:34 7F4:27 2885 S7F4    tam             	
1:F:29 7E9:7F 2886         cla             	
1:F:12 7D2:71 2887         a9aac           	
1:F:24 7E4:77 2888 S7E4    dan             	
1:F:08 7C8:A4 2889         br    S7E4      	
1:F:11 7D1:21 2890         tma             	
1:F:22 7E2:77 2891         dan             	
1:F:04 7C4:B4 2892         br    S7F4      	
1:F:09 7C9:04 2893         dyn             	
1:F:13 7D3:B4 2894         br    S7F4      	
1:F:26 7E6:2B 2895         ldx   6         	
1:F:0C 7CC:40 2896         tcy   0         	
1:F:19 7D9:21 2897         tma             	
1:F:32 7F2:0F 2898 S7F2    retn            	
              2899 ;	
              2900 ; Plague with Healer - add some warriors	
              2901 ;	
1:F:25 7E5:60 2902 L7E5    tcmiy 0         ; 4/1 = 0	
1:F:0A 7CA:64 2903         tcmiy 2         ; 4/2 = 2	
1:F:15 7D5:15 2904         ldp   10        	
1:F:2A 7EA:8C 2905         br    L68C      ; Add two Warriors to player's forces and display results	
              2906 	
1:F:14 7D4:10 2907 L7D4    ldp   0         	
1:F:28 7E8:0B 2908         tpc             	
1:F:10 7D0:1F 2909         ldp   15        	
1:F:20 7E0:AD 2910         br    L3ED      	
              2911 	
              2912 ; *** Chapter 2 page 0	
              2913 	
              2914 ;	
              2915 ; Brigand encounter	
              2916 ;	
              2917 ; Determine how many Brigands the player will face. Instead of a random number, "tether" the enemy	
              2918 ; strength to the players current Warrior count to ensure the fight is always challenging but fair.	
              2919 ;	
              2920 ; 1. Generate a value from 0-2 to give a random headcount advantage (either Warriors or Brigands).	
              2921 ; 2. Based on bit 3 of 3/1 (continually updated random value when waiting for a keypress), determine	
              2922 ;    if advantage goes to Player (bit set) or to Brigands (bit clear).	
              2923 ; 3. Take player Warrior count and add or subtract advantage to give Brigand count	
              2924 ;	
2:0:00 800:1F 2925 L800    ldp   15        	
2:0:01 801:E6 2926         call  LRANDOM   ; Random number between 0-15	
2:0:03 803:1F 2927         ldp   15        	
2:0:07 807:E5 2928         call  LBE5      ; Scale it down to 0-2 - this will be the advantage for either the Player or Brigands	
2:0:0F 80F:29 2929         ldx   4         	
2:0:1F 81F:48 2930         tcy   1         ; Set up for BCD arithmetic in BCD scratchpad at 4/1-2	
2:0:3F 83F:60 2931         tcmiy 0         ; 4/1 = 0	
2:0:3E 83E:27 2932         tam             ; 4/2 = Result of LBE5	
2:0:3D 83D:1F 2933         ldp   15        	
2:0:3B 83B:D4 2934         call  LBD4      ; Copy player's current warrior count to BCD scratchpad at 5/1-2	
2:0:37 837:2E 2935         ldx   3         	
2:0:2F 82F:48 2936         tcy   1         	
2:0:1E 81E:3B 2937         tbit1 3         ; Check bit 3 of 3/1 - Who gets the advantage?	
2:0:3C 83C:96 2938         br    S816      ; Bit is set - easy fight - Player gets advantage	
2:0:39 839:12 2939         ldp   4         ; Bit was clear - hard fight - Brigands get advantage	
2:0:33 833:EA 2940         call  LADDB10   ; Add value in 4/1-2 to the player Warrior count in 5/1-2 giving Brigand count	
2:0:27 827:18 2941         ldp   1         	
2:0:0E 80E:0B 2942         tpc             	
2:0:1D 81D:17 2943         ldp   14        	
2:0:3A 83A:3F 2944         mnez            ; Check 5/0 to see if there is an overflow of Brigands (>100)?	
2:0:35 835:F1 2945         call  LOAD99    ; If so, drop 99 in 5/1-2	
2:0:2B 82B:8D 2946         br    S80D      	
2:0:16 816:10 2947 S816    ldp   0         ; Easy fight - Player advantage	
2:0:2C 82C:0B 2948         tpc             	
2:0:18 818:13 2949         ldp   12        	
2:0:30 830:C0 2950         call  SU2B10    ; Subtract the value in 4/1-2 from 5/1-2 (player warrior count) giving Brigand count	
2:0:21 821:3F 2951         mnez            ; Underflow at 5/0 on Brigands?	
2:0:02 802:B1 2952         br    S831      ; Yes	
2:0:05 805:48 2953         tcy   1         	
2:0:0B 80B:3F 2954         mnez            ; Is 5/1 (Brigand 10s) != 0?	
2:0:17 817:8D 2955         br    S80D      	
2:0:2E 82E:44 2956         tcy   2         ; Is 5/2 (Brigands 1s) != 0?	
2:0:1C 81C:3F 2957         mnez            	
2:0:38 838:8D 2958         br    S80D      	
2:0:31 831:48 2959 S831    tcy   1         ; Zero or fewer Brigands - not very challenging...	
2:0:23 823:60 2960         tcmiy 0         ; 0 -> 5/1	
2:0:06 806:68 2961         tcmiy 1         ; 1 -> 5/2 - We have to have at least one Brigand for an encounter	
2:0:0D 80D:12 2962 S80D    ldp   4         	
2:0:1B 81B:D3 2963         call  L913      ; Update the encounter Brigand count at 3/12-13 from 5/1-2	
2:0:36 836:1C 2964 L836    ldp   3         	
2:0:2D 82D:0B 2965         tpc             	
2:0:1A 81A:1E 2966         ldp   7         	
2:0:34 834:EB 2967         call  PLYBUGL   	
2:0:29 829:14 2968         ldp   2         	
2:0:12 812:D5 2969         call  LCPBRIG   ; Copy Brigand count to 5/1-2 to prepare for call to 5TODISPB	
2:0:24 824:1C 2970         ldp   3         	
2:0:08 808:F4 2971         call  5TODSPB   ; Copy Brigand count to Display Buffer	
2:0:11 811:46 2972         tcy   6         ; Victory/Warriors/Brigands	
2:0:22 822:19 2973         ldp   9         	
2:0:04 804:C4 2974         call  ROTDRM3   ; Rotate the drum to Brigands	
2:0:09 809:10 2975         ldp   0         	
2:0:13 813:0B 2976         tpc             	
2:0:26 826:19 2977         ldp   9         	
2:0:0C 80C:FB 2978         call  L27B      ; Light the lower window, update the LED display with the Brigand count, and beep	
2:0:19 819:2F 2979         ldx   7         	
2:0:32 832:47 2980         tcy   14        	
2:0:25 825:6F 2981         tcmiy 15        ; 7/14 = 15 (" ")	
2:0:0A 80A:6F 2982         tcmiy 15        ; 7/15 = 15 (" ") - Two blanks to clear LED display	
2:0:15 815:10 2983         ldp   0         	
2:0:2A 82A:0B 2984         tpc             	
2:0:14 814:19 2985         ldp   9         	
2:0:28 828:E7 2986         call  L267      ; Clear the LED display of the Brigand count and prepare for Warrior count	
2:0:10 810:18 2987         ldp   1         	
2:0:20 820:80 2988         br    L840      	
              2989 	
              2990 ; *** Chapter 2 page 1	
              2991 	
              2992 ;	
              2993 ; Combat loop - Make sure there is a non-zero number of Brigands to fight (the battle isn't over)	
              2994 ;	
2:1:00 840:2E 2995 L840    ldx   3         	
2:1:01 841:43 2996         tcy   12        	
2:1:03 843:21 2997         tma             ; Remaining Brigands count 10s digit	
2:1:07 847:4B 2998         tcy   13        	
2:1:0F 84F:06 2999         amaac           ; Add the remaining Brigand count 1s digit	
2:1:1F 85F:BB 3000         br    S87B      ; There's an overflow - clearly there were Brigands	
2:1:3F 87F:77 3001         dan             ; Subtract 1	
2:1:3E 87E:BB 3002         br    S87B      ; There's no underflow - there was at least one Brigand	
2:1:3D 87D:0F 3003         retn            ; Battle is over (no Brigands remain)	
              3004 	
2:1:3B 87B:2B 3005 S87B    ldx   6         	
2:1:37 877:43 3006         tcy   12        	
2:1:2F 86F:34 3007         rbit  0         ; Clear bit 0 of 6/12 (do not wait for input)	
2:1:1E 85E:2F 3008         ldx   7         	
2:1:3C 87C:47 3009         tcy   14        	
2:1:39 879:6F 3010         tcmiy 15        ; 7/14 = 15 (" ")	
2:1:33 873:6F 3011         tcmiy 15        ; 7/15 = 15 (" ") Set display to blanks	
2:1:27 867:2E 3012         ldx   3         	
2:1:0E 84E:49 3013         tcy   9         	
2:1:1D 85D:21 3014         tma             ; Pick up player count	
2:1:3A 87A:7B 3015         a14aac          ; More than one player?	
2:1:35 875:9B 3016         br    S85B      ; Yes - do special check for sufficient Warriors	
2:1:2B 86B:10 3017 S86B    ldp   0         	
2:1:16 856:0B 3018         tpc             	
2:1:2C 86C:1E 3019         ldp   7         	
2:1:18 858:F8 3020         call  L1F8      ; Perform non-blocking read of keyboard to allow player to retreat	
2:1:30 870:51 3021         ynec  8         ; Did player hit the No/End button (retreat)?	
2:1:21 861:91 3022         br    S851      ; Nope - into combat...	
              3023 ;	
              3024 ; Multiplayer game where current player has two or fewer Warriors OR player retreats	
              3025 ;	
              3026 ; Kill a single Warrior and end combat	
              3027 ; 	
2:1:02 842:D5 3028 S842    call  KILLONE   ; Kill just one Warrior	
2:1:05 845:46 3029         tcy   6         	
2:1:0B 84B:0D 3030         setr            ; Turn on the Warrior lamp	
2:1:17 857:1C 3031         ldp   3         	
2:1:2E 86E:0B 3032         tpc             	
2:1:1C 85C:1D 3033         ldp   11        	
2:1:38 878:C5 3034         call  PLYDETH   ; Play the death march	
2:1:31 871:46 3035         tcy   6         	
2:1:23 863:0C 3036         rstr            ; Turn off the Warrior lamp	
2:1:06 846:7F 3037         cla             	
2:1:0D 84D:0F 3038         retn            	
              3039 	
2:1:1B 85B:2A 3040 S85B    ldx   2         ; Multiplayer game - special Warrior count check	
2:1:36 876:48 3041         tcy   1         	
2:1:2D 86D:3F 3042         mnez            	
2:1:1A 85A:AB 3043         br    S86B      ; Sufficient (non-zero) Warriors (10 or more)	
2:1:34 874:44 3044         tcy   2         ; Less than 10, check 1s digit	
2:1:29 869:21 3045         tma             	
2:1:12 852:73 3046         a13aac          ; Add 13 to check to see if player has at least three Warriors	
2:1:24 864:AB 3047         br    S86B      ; Sufficient (three or more) Warriors	
2:1:08 848:82 3048         br    S842      ; Nope, two or less Warriors	
              3049 ;	
              3050 ; Combat resolution	
              3051 ;	
2:1:11 851:1F 3052 S851    ldp   15        	
2:1:22 862:E6 3053         call  LRANDOM   ; Generate a random number from 0-15 for combat strength multiplier (0-3 after massaging)	
2:1:04 844:2D 3054         ldx   5         	
2:1:09 849:4C 3055         tcy   3         	
2:1:13 853:27 3056         tam             ; Store it in 5/3 (scratchpad RAM)	
2:1:26 866:37 3057         rbit  3         ; Clear bit 3	
2:1:0C 84C:35 3058         rbit  2         ; and clear bit 2, limiting random value to 0-3	
2:1:19 859:1F 3059         ldp   15        	
2:1:32 872:E6 3060         call  LRANDOM   ; Give us another random number	
2:1:25 865:14 3061         ldp   2         	
2:1:0A 84A:80 3062         br    L880      	
              3063 	
2:1:15 855:29 3064 KILLONE ldx   4         ; Kill just one Warrior	
2:1:2A 86A:48 3065         tcy   1         	
2:1:14 854:60 3066         tcmiy 0         	
2:1:28 868:68 3067         tcmiy 1         	
2:1:10 850:1E 3068         ldp   7         	
2:1:20 860:93 3069         br    L9D3      ; Call SUBWARR	
              3070 	
              3071 ; *** Chapter 2 page 2	
              3072 	
              3073 ;	
              3074 ; Generate combat factors	
              3075 ;	
              3076 ; - Calculate combat strength by multiplying the player's Warrior count by a random multiplier (1-4)	
              3077 ; - Calculate a sub-round count to determine how many times a player must beat the Warriors to win a round (up to 4x)	
              3078 ;	
2:2:00 880:2D 3079 L880    ldx   5         	
2:2:01 881:4D 3080         tcy   11        	
2:2:03 883:27 3081         tam             ; Store random value in 5/11 - this will be the number of sub-rounds the player must win to win a round	
2:2:07 887:37 3082         rbit  3         ; Clear bit 3	
2:2:0F 88F:35 3083         rbit  2         ; and bit 2, limiting random value again to 0-3	
2:2:1F 89F:1F 3084         ldp   15        	
2:2:3F 8BF:D4 3085         call  LBD4      ; Pick up player Warrior count and drop it in 5/1-2	
2:2:3E 8BE:40 3086         tcy   0         	
2:2:3D 8BD:60 3087         tcmiy 0         ; Clear the carry at 5/0	
2:2:3B 8BB:D9 3088         call  LCP5TO4   	
2:2:37 8B7:B9 3089         br    S8B9      	
2:2:2F 8AF:27 3090 S8AF    tam             ; Update combat strength loop counter at 5/3	
2:2:1E 89E:14 3091         ldp   2         	
2:2:3C 8BC:C9 3092         call  LSUMB10   ; Add another round of "Warrior count" to the combat strength	
2:2:39 8B9:2D 3093 S8B9    ldx   5         	
2:2:33 8B3:4C 3094         tcy   3         	
2:2:27 8A7:07 3095         dman            ; Subtract 1 from first random number we generated at 5/3 (combat strength multiplier)	
2:2:0E 88E:AF 3096         br    S8AF      ; Result was 0 or greater (hence 1-4 from the 0-3 random value).  Do another loop.	
              3097 	
2:2:1D 89D:D9 3098         call  LCP5TO4   ; Save player combat strength in 4/1-2	
2:2:3A 8BA:D5 3099         call  LCPBRIG   ; Copy Brigand count to 5/1-2 for calculations	
2:2:35 8B5:40 3100         tcy   0         	
2:2:2B 8AB:60 3101         tcmiy 0         	
2:2:16 896:C8 3102         call  LSWP4N5   ; Swap player combat strength and Brigand count	
2:2:2C 8AC:42 3103         tcy   4         	
              3104 ;	
              3105 ; Combat strength has been calculated.  Now handle the sub-rounds to determine who wins this round.	
              3106 ;	
              3107 ; Sub-round loop	
              3108 ;	
              3109 ; Player must win all sub-rounds (count in 5/11, calculated above at L880) to win a full round.  Each sub-round subtracts	
              3110 ; the Brigand count from the player's combat strength.	
              3111 ;	
2:2:18 898:27 3112 S898    tam             ; Store sub-round counter at 5/11 (NOTE: first pass stores in 4/4 - this appears to be a bug)	
2:2:30 8B0:10 3113         ldp   0         	
2:2:21 8A1:0B 3114         tpc             	
2:2:02 882:13 3115         ldp   12        	
2:2:05 885:FF 3116         call  L33F      ; Perform a base 10 subtraction (alternate entry point to SU2B10) and return borrow flag in A	
2:2:0B 88B:1C 3117         ldp   3         	
2:2:17 897:77 3118         dan             ; Decrement accumulator which will set S=1 if there was a borrow in SU2B10	
2:2:2E 8AE:BE 3119         br    L8FE      ; Player lost this round (ran out of combat strength)	
2:2:1C 89C:4D 3120         tcy   11        	
2:2:38 8B8:14 3121         ldp   2         	
2:2:31 8B1:07 3122         dman            ; Decrement the sub-round counter at 5/11	
2:2:23 8A3:98 3123         br    S898      ; Not done with this round yet, do it again	
              3124 ;	
              3125 ; Round is complete and player wins (this round)!	
              3126 ;	
              3127 ; Start calculating the number of Brigands remaining by multiplying starting Brigands by 5	
              3128 ;	
2:2:06 886:27 3129         tam             ; Save the sub-round count at 5/11 (should be 0xF as we've ended the loop)	
2:2:0D 88D:C8 3130         call  LSWP4N5   ; Brigand count was in 4/1-2, remaining player combat strength in 5/1-2 - swap them	
2:2:1B 89B:D9 3131         call  LCP5TO4   ; Overwrite 4/1-2 with Brigand count - Bank 4 = X	
2:2:36 8B6:C9 3132         call  LSUMB10   ; Bank 4 = X, Bank 5 = 2X	
2:2:2D 8AD:C8 3133         call  LSWP4N5   ; Bank 4 = 2X, Bank 5 = X	
2:2:1A 89A:C9 3134         call  LSUMB10   ; Bank 4 = 2X, Bank 5 = 3X (2X + X)	
2:2:34 8B4:C9 3135         call  LSUMB10   ; Bank 4 = 2X, Bank 5 = 5X (2X + 3X)	
2:2:29 8A9:21 3136         tma             ; Pick up overflow from 5/0	
2:2:12 892:1C 3137         ldp   3         	
2:2:24 8A4:80 3138         br    L8C0      	
              3139 	
2:2:08 888:18 3140 LSWP4N5 ldp   1         	
2:2:11 891:0B 3141         tpc             	
2:2:22 8A2:15 3142         ldp   10        	
2:2:04 884:82 3143         br    SWP4ND5   	
              3144 	
2:2:09 889:10 3145 LSUMB10 ldp   0         	
2:2:13 893:0B 3146         tpc             	
2:2:26 8A6:12 3147         ldp   4         	
2:2:0C 88C:BF 3148         br    SUMB10    	
              3149 	
2:2:19 899:18 3150 LCP5TO4 ldp   1         	
2:2:32 8B2:0B 3151         tpc             	
2:2:25 8A5:13 3152         ldp   12        	
2:2:0A 88A:A7 3153         br    CPY5TO4   	
              3154 	
2:2:15 895:10 3155 LCPBRIG ldp   0         	
2:2:2A 8AA:0B 3156         tpc             	
2:2:14 894:19 3157         ldp   9         	
2:2:28 8A8:89 3158         br    CPYBRIG   ; Copy Brigand count to 5/1-2 for calculations	
              3159 	
2:2:10 890:00 3160         mnea            	
2:2:20 8A0:00 3161         mnea            	
              3162 	
              3163 ; *** Chapter 2 page 3	
              3164 	
              3165 ;	
              3166 ; Calculate remaining Brigands after this round by dividing remaining combat strength by 10	
              3167 ;	
              3168 ; Ultimately, each round the Brigands lose, their numbers are cut by 50% (multiply by 5 then divide by 10)	
              3169 ;	
2:3:00 8C0:48 3170 L8C0    tcy   1         	
2:3:01 8C1:03 3171         xma             ; Swap the 10s digit of the remaining combat strength with the original 100s digit at 5/0	
2:3:03 8C3:44 3172         tcy   2         	
2:3:07 8C7:27 3173         tam             ; Store the old 10s digit in the 1s digit	
2:3:0F 8CF:12 3174         ldp   4         	
2:3:1F 8DF:D3 3175         call  L913      ; Update the encounter Brigand count at 3/12-13 from 5/1-2	
2:3:3F 8FF:BB 3176         br    S8FB      	
              3177 	
2:3:3E 8FE:18 3178 L8FE    ldp   1         ; Player lost this round...	
2:3:3D 8FD:D5 3179         call  KILLONE      	
              3180 	
2:3:3B 8FB:46 3181 S8FB    tcy   6         ; Light middle lamp	
2:3:37 8F7:0D 3182         setr            	
2:3:2F 8EF:C9 3183         call  S8C9      	
2:3:1E 8DE:1F 3184         ldp   15        	
2:3:3C 8FC:D4 3185         call  LBD4      	
2:3:39 8F9:F4 3186         call  5TODSPB   	
2:3:33 8F3:C8 3187         call  S8C8      	
2:3:27 8E7:46 3188         tcy   6         ; Turn off middle lamp	
2:3:0E 8CE:0C 3189         rstr            	
2:3:1D 8DD:4A 3190         tcy   5         ; Light lower lamp	
2:3:3A 8FA:0D 3191         setr            	
2:3:35 8F5:C9 3192         call  S8C9      	
2:3:2B 8EB:14 3193         ldp   2         	
2:3:16 8D6:D5 3194         call  LCPBRIG   ; Copy Brigand count to 5/1-2	
2:3:2C 8EC:F4 3195         call  5TODSPB   ; Copy Brigand count to display buffer at 7/14-15	
2:3:18 8D8:C8 3196         call  S8C8      	
2:3:30 8F0:4A 3197         tcy   5         ; Turn off lower lamp	
2:3:21 8E1:0C 3198         rstr            	
2:3:02 8C2:2D 3199         ldx   5         	
2:3:05 8C5:4D 3200         tcy   11        	
2:3:0B 8CB:3E 3201         imac            	
2:3:17 8D7:86 3202         br    S8C6      	
2:3:2E 8EE:1C 3203         ldp   3         	
2:3:1C 8DC:0B 3204         tpc             	
2:3:38 8F8:11 3205         ldp   8         	
2:3:31 8F1:EF 3206         call  PLYLOSR   ; Play the "lose round" sound	
2:3:23 8E3:AD 3207         br    S8ED      	
2:3:06 8C6:1C 3208 S8C6    ldp   3         	
2:3:0D 8CD:0B 3209         tpc             	
2:3:1B 8DB:1E 3210         ldp   7         	
2:3:36 8F6:CC 3211         call  PLYWINR   ; Play the "win round" sound	
2:3:2D 8ED:18 3212 S8ED    ldp   1         	
2:3:1A 8DA:80 3213         br    L840      	
2:3:34 8F4:10 3214 5TODSPB ldp   0         	
2:3:29 8E9:0B 3215         tpc             	
2:3:12 8D2:11 3216         ldp   8         	
2:3:24 8E4:A4 3217         br    BUF2DSP   ; Update display buffer with contents of 5/1 and 5/2	
2:3:08 8C8:10 3218 S8C8    ldp   0         	
2:3:11 8D1:0B 3219         tpc             	
2:3:22 8E2:19 3220         ldp   9         	
2:3:04 8C4:A7 3221         br    L267      	
              3222 	
2:3:09 8C9:1C 3223 S8C9    ldp   3         	
2:3:13 8D3:0B 3224         tpc             	
2:3:26 8E6:17 3225         ldp   14        	
2:3:0C 8CC:80 3226         br    LF80      	
2:3:19 8D9:18 3227 L8D9    ldp   1         	
2:3:32 8F2:0B 3228         tpc             	
2:3:25 8E5:1F 3229         ldp   15        	
2:3:0A 8CA:C0 3230         call  PLYOPEN   	
2:3:15 8D5:12 3231         ldp   4         	
2:3:2A 8EA:80 3232         br    L900      	
              3233 	
2:3:14 8D4:10 3234 L8D4    ldp   0         	
2:3:28 8E8:0B 3235         tpc             	
2:3:10 8D0:13 3236         ldp   12        	
2:3:20 8E0:96 3237         br    L316      ; Display awarded key	
              3238 	
              3239 ; *** Chapter 2 page 4	
              3240 	
2:4:00 900:1F 3241 L900    ldp   15        	
2:4:01 901:E6 3242         call  LRANDOM   	
2:4:03 903:7B 3243         a14aac          ; Add 14; is the result 0-1 (12.5%)?	
2:4:07 907:BD 3244         br    S93D      ; Nope	
2:4:0F 90F:18 3245         ldp   1         	
2:4:1F 91F:0B 3246         tpc             	
2:4:3F 93F:1F 3247         ldp   15        	
2:4:3E 93E:BC 3248         br    PLYCLOS   ; Nothing interesting in Tomb/Ruin--play the close sound	
              3249 	
2:4:3D 93D:7A 3250 S93D    a6aac           ; Add another 6; was the original value 2-9 (50%)?	
2:4:3B 93B:9D 3251         br    S91D      ; Nope	
2:4:37 937:10 3252 L937    ldp   0         	
2:4:2F 92F:C0 3253         call  L800      ; Brigands or Wizard	
2:4:1E 91E:70 3254         iac             	
2:4:3C 93C:9D 3255         br    S91D      	
              3256 	
2:4:39 939:18 3257 S939    ldp   1         	
2:4:33 933:0B 3258         tpc             	
2:4:27 927:10 3259         ldp   0         	
2:4:0E 90E:8F 3260         br    ENDTURN   	
              3261 ;	
              3262 ; Always give player Gold if Tomb/Ruin has something in it (Brigands or otherwise)	
              3263 ;	
2:4:1D 91D:17 3264 S91D    ldp   14        	
2:4:3A 93A:C6 3265         call  LB86      ; Randomly award 13-20 Gold	
2:4:35 935:1E 3266         ldp   7         	
2:4:2B 92B:EA 3267         call  L9EA      ; Call ADDGOLD	
2:4:16 916:29 3268         ldx   4         	
2:4:2C 92C:4B 3269         tcy   13        	
2:4:18 918:35 3270         rbit  2         ; Flag that player Gold has changed	
2:4:30 930:10 3271         ldp   0         	
2:4:21 921:0B 3272         tpc             	
2:4:02 902:1A 3273         ldp   5         	
2:4:05 905:C0 3274         call  DSPRSLT   ; Display results	
              3275 	
2:4:0B 90B:1F 3276         ldp   15        	
2:4:17 917:E6 3277         call  LRANDOM   	
2:4:2E 92E:1A 3278         ldp   5         	
2:4:1C 91C:7A 3279         a6aac           ; Add 6; is the value 0-9 (62.5%)?	
2:4:38 938:BA 3280         br    L97A      ; Nope, maybe give them a Pegasus	
              3281 ;	
              3282 ; Award a key 62.5% of the time	
              3283 ;	
2:4:31 931:2A 3284         ldx   2         	
2:4:23 923:4C 3285         tcy   3         ; 2/3 = Current player key inventory and status	
2:4:06 906:12 3286         ldp   4         	
2:4:0D 90D:38 3287         tbit1 0         ; Key found in this region yet?	
2:4:1B 91B:9A 3288         br    S91A      ; Nope.  Let's give them one	
              3289 	
2:4:36 936:12 3290 S936    ldp   4         	
2:4:2D 92D:B9 3291         br    S939      ; Sorry, sucker.  End the turn	
              3292 	
2:4:1A 91A:21 3293 S91A    tma             ; Pick up the current key inventory	
2:4:34 934:06 3294         amaac           ; Check to see if they already have the Gold key (8 + 8 = overflow)	
2:4:29 929:B6 3295         br    S936      ; Yep - end the turn	
2:4:12 912:27 3296         tam             ; We doubled the previous value, effectively granting the next key; save it to their inventory	
2:4:24 924:7F 3297         cla             	
2:4:08 908:78 3298         a2aac           ; Accumulator = 2	
2:4:11 911:1A 3299         ldp   5         	
2:4:22 922:3B 3300         tbit1 3         ; Do they have the Gold key now?	
2:4:04 904:AF 3301         br    L96F      ; Yep, they must have just gotten it - show it as an award	
2:4:09 909:80 3302         br    L940      	
              3303 	
2:4:13 913:10 3304 L913    ldp   0         	
2:4:26 926:0B 3305         tpc             	
2:4:0C 90C:13 3306         ldp   12        	
2:4:19 919:8D 3307         br    L30D      ; Copy 5/1-2 to 3/12-13 - Results of Brigand math to Brigand count	
              3308 	
2:4:32 932:18 3309 L932    ldp   1         	
2:4:25 925:0B 3310         tpc             	
2:4:0A 90A:1A 3311         ldp   5         	
2:4:15 915:A9 3312         br    L569      ; Update the display with the current Brigand count	
              3313 	
              3314 ;********************************************************************************	
              3315 ; LADDB10 - Call the AD2B10 routine - Local to chapter 2	
              3316 ;********************************************************************************	
2:4:2A 92A:10 3317 LADDB10 ldp   0         	
2:4:14 914:0B 3318         tpc             	
2:4:28 928:12 3319         ldp   4         	
2:4:10 910:80 3320         br    AD2B10    	
2:4:20 920:00 3321         mnea            	
              3322 	
              3323 ; *** Chapter 2 page 5	
              3324 	
2:5:00 940:77 3325 L940    dan             	
2:5:01 941:39 3326         tbit1 2         ; Do they have the Silver key now?	
2:5:03 943:B3 3327         br    S973      ; Yep, they must have just gotten it, as they didn't have the Gold key - show it as an award	
              3328 ;	
              3329 ; Award a Brass key since it wasn't the Gold or Silver keys	
              3330 ;	
2:5:07 947:7F 3331         cla             	
2:5:0F 94F:29 3332         ldx   4         	
2:5:1F 95F:47 3333         tcy   14        	
2:5:3F 97F:35 3334         rbit  2         ; Brass key flag	
              3335 ;	
              3336 ; Treasure included a key - handle it	
              3337 ;	
2:5:3E 97E:1C 3338 S97E    ldp   3         	
2:5:3D 97D:D4 3339         call  L8D4      ; Display the key awarded	
2:5:3B 97B:12 3340 S97B    ldp   4         	
2:5:37 977:B9 3341         br    S939      ; ...and end the turn	
              3342 ;	
              3343 ; Award a Gold key	
              3344 ;	
2:5:2F 96F:29 3345 L96F    ldx   4         	
2:5:1E 95E:4F 3346         tcy   15        	
2:5:3C 97C:34 3347         rbit  0         ; Gold key flag	
2:5:39 979:BE 3348         br    S97E      	
              3349 ;	
              3350 ; Award a Silver key	
              3351 ;	
2:5:33 973:29 3352 S973    ldx   4         	
2:5:27 967:47 3353         tcy   14        	
2:5:0E 94E:37 3354         rbit  3         ; Silver key flag	
2:5:1D 95D:BE 3355         br    S97E      	
              3356 ;	
              3357 ; Award a Pegasus?	
              3358 ;	
2:5:3A 97A:7B 3359 L97A    a14aac          	
2:5:35 975:86 3360         br    S946      	
              3361 ;	
              3362 ; Yep	
              3363 ;	
2:5:2B 96B:42 3364         tcy   4         ; Dragon/Sword/Pegasus	
2:5:16 956:19 3365         ldp   9         	
2:5:2C 96C:C4 3366         call  ROTDRM3   	
2:5:18 958:4A 3367         tcy   5         ; Select lower lamp	
2:5:30 970:0D 3368         setr            ; Light it	
2:5:21 961:1C 3369         ldp   3         	
2:5:02 942:0B 3370         tpc             	
2:5:05 945:13 3371         ldp   12        	
2:5:0B 94B:CD 3372         call  PLYPEGA   	
2:5:17 957:4A 3373         tcy   5         ; Select lower lamp	
2:5:2E 96E:0C 3374         rstr            ; Turn it off	
2:5:1C 95C:29 3375         ldx   4         	
2:5:38 978:4F 3376         tcy   15        	
2:5:31 971:35 3377         rbit  2         ; Flag that Pegasus was found	
2:5:23 963:BB 3378         br    S97B      ; and end the turn	
              3379 ;	
              3380 ; Award a Dragonsword?	
              3381 ;	
2:5:06 946:7B 3382 S946    a14aac          	
2:5:0D 94D:99 3383         br    S959      	
              3384 ;	
              3385 ; Yep	
              3386 ;	
2:5:1B 95B:2C 3387         ldx   1         	
2:5:36 976:4C 3388         tcy   3         	
2:5:2D 96D:39 3389         tbit1 2         ; Check 1/3 bit 2.  Do they have one already?	
2:5:1A 95A:BB 3390         br    S97B      ; Sorry.  End turn.	
2:5:34 974:31 3391         sbit  2         	
2:5:29 969:42 3392         tcy   4         ; Dragon/Sword/Pegasus	
2:5:12 952:19 3393         ldp   9         	
2:5:24 964:C4 3394         call  ROTDRM3   	
2:5:08 948:10 3395         ldp   0         	
2:5:11 951:0B 3396         tpc             	
2:5:22 962:19 3397         ldp   9         	
2:5:04 944:CF 3398         call  LTMIDCL   ; Light up Sword	
2:5:09 949:29 3399         ldx   4         	
2:5:13 953:4F 3400         tcy   15        	
2:5:26 966:36 3401         rbit  1         ; Flag Sword found in encounter	
2:5:0C 94C:BB 3402         br    S97B      ; End turn	
              3403 ;	
              3404 ; Award a Wizard?	
              3405 ;	
2:5:19 959:2E 3406 S959    ldx   3         	
2:5:32 972:49 3407         tcy   9         	
2:5:25 965:21 3408         tma             ; Pick up number of players in the game	
2:5:0A 94A:7B 3409         a14aac          ; Is this a single-player game?	
2:5:15 955:94 3410         br    S954      ; There was a carry--yes	
2:5:2A 96A:BB 3411         br    S97B      ; Nope.  End turn	
              3412 ;	
              3413 ; Player is awarded a Wizard; handle selecting who will be cursed	
              3414 ;	
2:5:14 954:2E 3415 S954    ldx   3         	
2:5:28 968:4D 3416         tcy   11        	
2:5:10 950:16 3417         ldp   6         	
2:5:20 960:80 3418         br    L980      	
              3419 	
              3420 ; *** Chapter 2 page 6	
              3421 	
              3422 ;	
              3423 ; Curse continued	
              3424 ;	
2:6:00 980:21 3425 L980    tma             ; Get current player	
2:6:01 981:29 3426         ldx   4         	
2:6:03 983:27 3427         tam             ; Save current player in 4/11	
2:6:07 987:4A 3428         tcy   5         ; Wizard/Bazaar Closed/Key Missing	
2:6:0F 98F:19 3429         ldp   9         	
2:6:1F 99F:C4 3430         call  ROTDRM3   	
2:6:3F 9BF:10 3431         ldp   0         	
2:6:3E 9BE:0B 3432         tpc             	
2:6:3D 9BD:19 3433         ldp   9         	
2:6:3B 9BB:C0 3434         call  LTTOPCL   ; Light up Wizard and clear the display	
2:6:37 9B7:15 3435 S9B7    ldp   10        	
2:6:2F 9AF:CF 3436         call  ROTPLYR   ; Rotate player info	
2:6:1E 99E:29 3437         ldx   4         	
2:6:3C 9BC:4D 3438         tcy   11        	
2:6:39 9B9:00 3439         mnea            ; Make sure the player rotated in isn't the current player	
2:6:33 9B3:8E 3440         br    S98E      ; Got it	
2:6:27 9A7:B7 3441         br    S9B7      ; Nope, it is; don't want to curse ourselves.  Rotate again	
              3442 	
2:6:0E 98E:2E 3443 S98E    ldx   3         	
2:6:1D 99D:4D 3444         tcy   11        	
2:6:3A 9BA:21 3445         tma             ; Pick up target player	
2:6:35 9B5:2F 3446         ldx   7         	
2:6:2B 9AB:47 3447         tcy   14        	
2:6:16 996:6D 3448         tcmiy 11        ; 7/14 = 11 ("C")	
2:6:2C 9AC:27 3449         tam             ; 7/15 = Target player to curse	
2:6:18 998:10 3450 S998    ldp   0         	
2:6:30 9B0:0B 3451         tpc             	
2:6:21 9A1:1E 3452         ldp   7         	
2:6:02 982:CB 3453         call  PROMPT      	
2:6:05 985:51 3454         ynec  8         ; Did they hit No/End	
2:6:0B 98B:AE 3455         br    S9AE      ; Nope	
2:6:17 997:B7 3456         br    S9B7      	
              3457 	
2:6:2E 9AE:59 3458 S9AE    ynec  9         ; Did they hit Clear?	
2:6:1C 99C:A9 3459         br    S9A9      ; Nope	
2:6:38 9B8:15 3460 S9B8    ldp   10        	
2:6:31 9B1:CF 3461         call  ROTPLYR   	
2:6:23 9A3:29 3462         ldx   4         	
2:6:06 986:4D 3463         tcy   11        	
2:6:0D 98D:00 3464         mnea            ; Check that the player rotated in is the current player	
2:6:1B 99B:B8 3465         br    S9B8      ; Nope, rotate again	
2:6:36 9B6:18 3466         ldp   1         	
2:6:2D 9AD:0B 3467         tpc             	
2:6:1A 99A:18 3468         ldp   1         	
2:6:34 9B4:98 3469         br    DOCLEAR   	
2:6:29 9A9:50 3470 S9A9    ynec  0         ; Did they hit Yes/Buy	
2:6:12 992:98 3471         br    S998      ; Nope, try again	
              3472 ;	
              3473 ; We've got the right player rotated in; handle the curse	
              3474 ;	
2:6:24 9A4:28 3475         ldx   0         	
2:6:08 988:4C 3476         tcy   3         	
2:6:11 991:36 3477         rbit  1         ; 0/3 bit 1 - cleared - flag that player has been cursed	
2:6:22 9A2:1E 3478         ldp   7         	
2:6:04 984:F6 3479         call  L9F6      ; Call CPY0TO5	
2:6:09 989:14 3480         ldp   2         	
2:6:13 993:D9 3481         call  LCP5TO4   	
2:6:26 9A6:1E 3482         ldp   7         	
2:6:0C 98C:E9 3483         call  L9E9      	
2:6:19 999:44 3484         tcy   2         	
2:6:32 9B2:29 3485 S9B2    ldx   4         	
2:6:25 9A5:21 3486         tma             	
2:6:0A 98A:2B 3487         ldx   6         	
2:6:15 995:24 3488         tamdyn          	
2:6:2A 9AA:B2 3489         br    S9B2      	
2:6:14 994:1E 3490         ldp   7         	
2:6:28 9A8:D1 3491         call  L9D1      ; Call SUBGOLD	
2:6:10 990:1E 3492         ldp   7         	
2:6:20 9A0:80 3493         br    L9C0      	
              3494 	
              3495 ; *** Chapter 2 page 7	
              3496 	
2:7:00 9C0:1F 3497 L9C0    ldp   15        	
2:7:01 9C1:D4 3498         call  LBD4      	
2:7:03 9C3:14 3499         ldp   2         	
2:7:07 9C7:D9 3500         call  LCP5TO4   	
2:7:0F 9CF:E9 3501         call  L9E9      	
2:7:1F 9DF:14 3502         ldp   2         	
2:7:3F 9FF:C8 3503         call  LSWP4N5   	
2:7:3E 9FE:15 3504         ldp   10        	
2:7:3D 9FD:FD 3505         call  CPY5TO7   	
2:7:3B 9FB:14 3506         ldp   2         	
2:7:37 9F7:C8 3507         call  LSWP4N5   	
2:7:2F 9EF:D3 3508         call  L9D3      ; Call SUBWARR	
2:7:1E 9DE:15 3509         ldp   10        	
2:7:3C 9FC:DE 3510         call  CPY7TO5   	
2:7:39 9F9:14 3511         ldp   2         	
2:7:33 9F3:C8 3512         call  LSWP4N5   	
2:7:27 9E7:15 3513 S9E7    ldp   10        	
2:7:0E 9CE:CF 3514         call  ROTPLYR   	
2:7:1D 9DD:29 3515         ldx   4         	
2:7:3A 9FA:4D 3516         tcy   11        	
2:7:35 9F5:00 3517         mnea            	
2:7:2B 9EB:A7 3518         br    S9E7      	
2:7:16 9D6:F2 3519         call  S9F2      ; Call ADDWARR	
2:7:2C 9EC:44 3520         tcy   2         	
2:7:18 9D8:2B 3521 S9D8    ldx   6         	
2:7:30 9F0:21 3522         tma             	
2:7:21 9E1:29 3523         ldx   4         	
2:7:02 9C2:24 3524         tamdyn          	
2:7:05 9C5:98 3525         br    S9D8      	
2:7:0B 9CB:EA 3526         call  L9EA      ; Call ADDGOLD	
2:7:17 9D7:29 3527         ldx   4         	
2:7:2E 9EE:4B 3528         tcy   13        	
2:7:1C 9DC:34 3529         rbit  0         	
2:7:38 9F8:10 3530         ldp   0         	
2:7:31 9F1:0B 3531         tpc             	
2:7:23 9E3:1A 3532         ldp   5         	
2:7:06 9C6:C0 3533         call  DSPRSLT   ; Display results	
2:7:0D 9CD:12 3534         ldp   4         	
2:7:1B 9DB:B9 3535         br    S939      	
2:7:36 9F6:18 3536 L9F6    ldp   1         	
2:7:2D 9ED:0B 3537         tpc             	
2:7:1A 9DA:13 3538         ldp   12        	
2:7:34 9F4:97 3539         br    CPY0TO5   	
2:7:29 9E9:18 3540 L9E9    ldp   1         	
2:7:12 9D2:0B 3541         tpc             	
2:7:24 9E4:1D 3542         ldp   11        	
2:7:08 9C8:80 3543         br    L6C0      	
2:7:11 9D1:18 3544 L9D1    ldp   1         	
2:7:22 9E2:0B 3545         tpc             	
2:7:04 9C4:1A 3546         ldp   5         	
2:7:09 9C9:84 3547         br    SUBGOLD   	
2:7:13 9D3:18 3548 L9D3    ldp   1         	
2:7:26 9E6:0B 3549         tpc             	
2:7:0C 9CC:1A 3550         ldp   5         	
2:7:19 9D9:80 3551         br    SUBWARR   	
2:7:32 9F2:18 3552 S9F2    ldp   1         	
2:7:25 9E5:0B 3553         tpc             	
2:7:0A 9CA:15 3554         ldp   10        	
2:7:15 9D5:86 3555         br    ADDWARR   	
2:7:2A 9EA:18 3556 L9EA    ldp   1         	
2:7:14 9D4:0B 3557         tpc             	
2:7:28 9E8:16 3558         ldp   6         	
2:7:10 9D0:80 3559         br    ADDGOLD   	
2:7:20 9E0:00 3560         mnea            	
              3561 	
              3562 ; *** Chapter 2 page 8	
              3563 	
              3564 ;	
              3565 ; Attack the Dark Tower!  First, do The Riddle of the Keys.	
              3566 ;	
2:8:00 A00:3E 3567 LA00    imac            ; Are we in the final territory with all the keys?	
2:8:01 A01:BD 3568         br    SA3D      ; Yep	
              3569 ;	
              3570 ; They're missing some element.  Check to see if they have all of the keys yet or if they're just	
              3571 ; not back in their own territory (2/3 Bit 0 is still clear).	
              3572 ;	
2:8:03 A03:18 3573         ldp   1         	
2:8:07 A07:0B 3574         tpc             	
2:8:0F A0F:12 3575         ldp   4         	
2:8:1F A1F:70 3576         iac             	
2:8:3F A3F:85 3577         br    L505      ; They're not back in their own territory; play the failure sound and end turn	
2:8:3E A3E:AC 3578         br    KEYMISS        ; They're still missing a key	
              3579 ;	
              3580 ; Begin The Riddle of the Keys	
              3581 ;	
2:8:3D A3D:2D 3582 SA3D    ldx   5         	
2:8:3B A3B:43 3583         tcy   12        	
2:8:37 A37:67 3584         tcmiy 14        ; 5/12 = 14	
2:8:2F A2F:6F 3585         tcmiy 15        ; 5/13 = 15	
2:8:1E A1E:10 3586 LA1E    ldp   0         	
2:8:3C A3C:0B 3587         tpc             	
2:8:39 A39:11 3588         ldp   8         	
2:8:33 A33:E3 3589         call  RND0TO2   ; Start with a random key	
2:8:27 A27:89 3590         br    SA09      ; Propose it...	
              3591 ;	
              3592 ; Propose the key in A (0-2) to the player	
              3593 ;	
2:8:0E A0E:4D 3594 SA0E    tcy   11        	
2:8:1D A1D:27 3595         tam             ; Save the proposed key in 5/11	
2:8:3A A3A:1C 3596 SA3A    ldp   3         	
2:8:35 A35:D4 3597         call  L8D4      ; Show the proposed next key	
2:8:2B A2B:2D 3598         ldx   5         	
2:8:16 A16:43 3599         tcy   12        	
2:8:2C A2C:21 3600         tma             ; 5/12 has 14 for the first key, 15 for the second key (5/14 or 5/15)	
2:8:18 A18:74 3601         a3aac           ; Add 3 to bump it up to 1-2	
2:8:30 A30:2F 3602         ldx   7         	
2:8:21 A21:47 3603         tcy   14        	
2:8:02 A02:25 3604         tamiyc          ; 7/14 = which key sequence we're on	
2:8:05 A05:6F 3605         tcmiy 15        ; 7/15 = 15 (" ")	
              3606 ;	
              3607 ; Prompt user to use the key in the accumulator or not	
              3608 ;	
2:8:0B A0B:10 3609 SA0B    ldp   0         	
2:8:17 A17:0B 3610         tpc             	
2:8:2E A2E:1E 3611         ldp   7         	
2:8:1C A1C:CB 3612         call  PROMPT      	
              3613 	
2:8:38 A38:52 3614         ynec  4         ; Did they hit Repeat?	
2:8:31 A31:B6 3615         br    SA36      ; Nope	
2:8:23 A23:2D 3616         ldx   5         	
2:8:06 A06:4D 3617         tcy   11        	
2:8:0D A0D:21 3618         tma             ; Pick up the last proposed key	
2:8:1B A1B:BA 3619         br    SA3A      	
              3620 	
2:8:36 A36:59 3621 SA36    ynec  9         ; Did they hit Clear?	
2:8:2D A2D:A4 3622         br    SA24      ; Nope	
2:8:1A A1A:18 3623         ldp   1         	
2:8:34 A34:0B 3624         tpc             	
2:8:29 A29:18 3625         ldp   1         	
2:8:12 A12:98 3626         br    DOCLEAR   	
              3627 	
2:8:24 A24:51 3628 SA24    ynec  8         ; Did they hit No/End?	
2:8:08 A08:95 3629         br    SA15      ; Nope	
2:8:11 A11:2D 3630         ldx   5         	
2:8:22 A22:4D 3631         tcy   11        	
2:8:04 A04:21 3632         tma             ; Pick up the last proposed key	
              3633 ;	
              3634 ; Pick the next key to use...	
              3635 ;	
2:8:09 A09:77 3636 SA09    dan             ; Accumulator had the last key used	
2:8:13 A13:8C 3637         br    SA0C      	
2:8:26 A26:74 3638         a3aac           	
2:8:0C A0C:2D 3639 SA0C    ldx   5         	
2:8:19 A19:4B 3640         tcy   13        	
2:8:32 A32:00 3641         mnea            ; Is this the last key we tried?	
2:8:25 A25:8E 3642         br    SA0E      ; Nope, propose this key	
2:8:0A A0A:89 3643         br    SA09      ; Try the next key	
              3644 	
2:8:15 A15:50 3645 SA15    ynec  0         ; Did they hit Yes/Buy?	
2:8:2A A2A:8B 3646         br    SA0B      ; Nope, go back and prompt again	
2:8:14 A14:2D 3647         ldx   5         	
2:8:28 A28:4D 3648         tcy   11        	
2:8:10 A10:19 3649         ldp   9         	
2:8:20 A20:80 3650         br    LA40      	
              3651 	
              3652 ; *** Chapter 2 page 9	
              3653 	
              3654 ;	
              3655 ; They said "Yes, use this key here"	
              3656 ; Check the key sequence against The Riddle of the Keys	
              3657 ;	
2:9:00 A40:21 3658 LA40    tma             ; Pick up the last proposed key from 5/11	
2:9:01 A41:43 3659         tcy   12        ; 5/12 is the key we're trying (14 or 15 for 5/14 and 5/15)	
2:9:03 A43:22 3660         tmy             ; Pick up that address for an indirect comparsion	
2:9:07 A47:00 3661         mnea            ; Is this the right key?	
2:9:0F A4F:9E 3662         br    SA5E      ; Nope.  Wrong key.	
              3663 ;	
              3664 ; They did get the right key	
              3665 ;	
2:9:1F A5F:05 3666         iyc             ; Advance Y to the next key position	
2:9:3F A7F:9D 3667         br    SA5D      ; Y overflowed, they solved The Riddle of the Keys.  Storm the tower.	
              3668 ;	
              3669 ; First key is solved.  Update 5/12 to point to the second key storage location (5/15)	
              3670 ;	
2:9:3E A7E:43 3671         tcy   12        	
2:9:3D A7D:6F 3672         tcmiy 15        ; 5/12 = 15 (for 5/15)	
2:9:3B A7B:27 3673         tam             ; Save the key we just used in 5/13	
2:9:37 A77:11 3674         ldp   8         	
2:9:2F A6F:9E 3675         br    LA1E      ; Go back and prompt for the next key, choosing a random one	
              3676 ;	
              3677 ; Chose the wrong key	
              3678 ;	
2:9:1E A5E:1C 3679 SA5E    ldp   3         	
2:9:3C A7C:0B 3680         tpc             	
2:9:39 A79:1D 3681         ldp   11        	
2:9:33 A73:C0 3682         call  PLYFAIL   	
2:9:27 A67:12 3683         ldp   4         	
2:9:0E A4E:B9 3684         br    S939      ; Call ENDTURN	
              3685 ;	
              3686 ; They solved The Riddle of the Keys; fight the Final Battle	
              3687 ;	
2:9:1D A5D:CC 3688 SA5D    call  SA4C      	
2:9:3A A7A:10 3689         ldp   0         	
2:9:35 A75:F6 3690         call  L836      	
2:9:2B A6B:70 3691         iac             	
2:9:16 A56:B0 3692         br    SA70      	
2:9:2C A6C:12 3693         ldp   4         	
2:9:18 A58:B9 3694         br    S939      ; Call ENDTURN	
              3695 ;	
              3696 ; Handle Victory	
              3697 ;	
2:9:30 A70:46 3698 SA70    tcy   6         ; Victory/Warriors/Brigands	
2:9:21 A61:C4 3699         call  ROTDRM3   	
2:9:02 A42:4E 3700         tcy   7         ; Light upper lamp	
2:9:05 A45:0D 3701         setr            	
2:9:0B A4B:1C 3702         ldp   3         	
2:9:17 A57:0B 3703         tpc             	
2:9:2E A6E:10 3704         ldp   0         	
2:9:1C A5C:CC 3705         call  PLYTHEM      	
2:9:38 A78:4E 3706         tcy   7         	
2:9:31 A71:0C 3707         rstr            ; Turn off upper lamp	
              3708 ;	
              3709 ; Calculate the player's score and end the game	
              3710 ;	
2:9:23 A63:2A 3711         ldx   2         	
2:9:06 A46:18 3712         ldp   1         	
2:9:0D A4D:0B 3713         tpc             	
2:9:1B A5B:18 3714         ldp   1         	
2:9:36 A76:C6 3715         call  S446      ; Copy saved player Warriors back to current player	
2:9:2D A6D:CC 3716         call  SA4C      ; Copy Dark Tower Brigand count to Brigand battle count	
2:9:1A A5A:10 3717         ldp   0         	
2:9:34 A74:0B 3718         tpc             	
2:9:29 A69:19 3719         ldp   9         	
2:9:12 A52:C9 3720         call  CPYBRIG  ; Copy Brigand count to 5/1-2 for calculations	
2:9:24 A64:1C 3721         ldp   3         	
2:9:08 A48:0B 3722         tpc             	
2:9:11 A51:1F 3723         ldp   15        	
2:9:22 A62:BF 3724         br    LFFF      ; Finish calculating the score and end the game	
              3725 	
2:9:04 A44:10 3726 ROTDRM3 ldp   0         	
2:9:09 A49:0B 3727         tpc             	
2:9:13 A53:11 3728         ldp   8         	
2:9:26 A66:95 3729         br    ROTDRUM	
              3730 	
2:9:0C A4C:2E 3731 SA4C    ldx   3         	
2:9:19 A59:4F 3732         tcy   15        	
2:9:32 A72:21 3733 SA72    tma             	
2:9:25 A65:04 3734         dyn             	
2:9:0A A4A:04 3735         dyn             	
2:9:15 A55:25 3736         tamiyc          	
2:9:2A A6A:5B 3737         ynec  13        	
2:9:14 A54:B2 3738         br    SA72      	
2:9:28 A68:0F 3739         retn            	
              3740 	
2:9:10 A50:00 3741         mnea            	
2:9:20 A60:00 3742         mnea            	
              3743 	
              3744 ; *** Chapter 2 page 10	
              3745 	
              3746 ;********************************************************************************	
              3747 ; ROT7LFT - Call the routine to rotate the buffer of 2-digit Base10 values	
              3748 ;           left at 7/1-10, keeping track of the position at 7/11.	
              3749 ;********************************************************************************	
2:A:00 A80:10 3750 ROT7LFT ldp   0         	
2:A:01 A81:0B 3751         tpc             	
2:A:03 A83:1D 3752         ldp   11        	
2:A:07 A87:96 3753         br    L2D6      	
              3754 	
              3755 ;********************************************************************************	
              3756 ; ROTPLYR - Call the routine to rotate the next player's info into 	
              3757 ;           0/1-3, 1/1-3, 2/2-3	
              3758 ;********************************************************************************	
2:A:0F A8F:10 3759 ROTPLYR ldp   0         	
2:A:1F A9F:0B 3760         tpc             	
2:A:3F ABF:11 3761         ldp   8         	
2:A:3E ABE:80 3762         br    L200      	
              3763 	
              3764 ;********************************************************************************	
              3765 ; CPY5TO7 - Call the routine to copy 5/2-0 to 7/2-0	
              3766 ;********************************************************************************	
2:A:3D ABD:10 3767 CPY5TO7 ldp   0         	
2:A:3B ABB:0B 3768         tpc             	
2:A:37 AB7:15 3769         ldp   10        	
2:A:2F AAF:8C 3770         br    L28C      	
              3771 	
              3772 ;********************************************************************************	
              3773 ; CPY7TO5 - Call the routine to copy 7/2-0 to 5/2-0	
              3774 ;********************************************************************************	
2:A:1E A9E:10 3775 CPY7TO5 ldp   0         	
2:A:3C ABC:0B 3776         tpc             	
2:A:39 AB9:1D 3777         ldp   11        	
2:A:33 AB3:B3 3778         br    L2F3      	
              3779 ;	
              3780 ; Player is attacking the Dark Tower.  Play the attack sound and handle it	
              3781 ;	
2:A:27 AA7:1C 3782 LAA7    ldp   3         	
2:A:0E A8E:0B 3783         tpc             	
2:A:1D A9D:16 3784         ldp   6         	
2:A:3A ABA:FE 3785         call  PLYATTK      	
2:A:35 AB5:2A 3786         ldx   2         	
2:A:2B AAB:4C 3787         tcy   3         	
2:A:16 A96:11 3788         ldp   8         	
2:A:2C AAC:80 3789         br    LA00      	
              3790 ;	
              3791 ; Visit the Bazaar	
              3792 ;	
              3793 ; Start by filling in the "price buffer" at 7/1-10 with the prices of the various goods.	
              3794 ; Prices are recorded as two-digit Base10 values to facilitate display on the LED display.	
              3795 ;	
              3796 ; The order of buffer is: Warriors, Food, Beast, Scout, Healer	
              3797 ;	
              3798 ; Price values are set to:	
              3799 ;   - Warriors: 5-8 bags of gold	
              3800 ;   - Food: 1 bag of gold	
              3801 ;   - Beast, Scout, Healer: 17-26 bags of gold each	
              3802 ;	
2:A:18 A98:1C 3803 LA98    ldp   3         	
2:A:30 AB0:0B 3804         tpc             	
2:A:21 AA1:12 3805         ldp   4         	
2:A:02 A82:DD 3806         call  PLYBAZR   ; Play the Bazaar music to set the location for the player	
2:A:05 A85:2F 3807         ldx   7         	
2:A:0B A8B:4D 3808         tcy   11        	
2:A:17 A97:68 3809         tcmiy 1         ; 7/11 = 1 - Start at position 1	
2:A:2E AAE:1F 3810         ldp   15        	
              3811 ;	
              3812 ; Fill in position 1 with a random value from 5-8 (Warrior price)	
              3813 ;	
2:A:1C A9C:E6 3814         call  LRANDOM   	
2:A:38 AB8:29 3815         ldx   4         	
2:A:31 AB1:24 3816         tamdyn          ; 4/2 = Random	
2:A:23 AA3:60 3817         tcmiy 0         ; 4/1 = 0	
2:A:06 A86:37 3818         rbit  3         ; Reduce random value to 0-7	
2:A:0D A8D:35 3819         rbit  2         ; Reduce random value further to 0-3	
              3820 ;	
              3821 ; Add 5 to the random value	
              3822 ;	
2:A:1B A9B:2D 3823         ldx   5         	
2:A:36 AB6:48 3824         tcy   1         	
2:A:2D AAD:60 3825         tcmiy 0         ; 5/1 = 0	
2:A:1A A9A:6A 3826         tcmiy 5         ; 5/2 = 5	
2:A:34 AB4:12 3827         ldp   4         	
2:A:29 AA9:EA 3828         call  LADDB10   ; Call ADDB10 - Add 5 to the random value	
2:A:12 A92:FD 3829         call  CPY5TO7   ; Copy 5/2-0 to 7/2-0 - Save it in the 7 buffer	
2:A:24 AA4:C0 3830         call  ROT7LFT   ; Move on to the next price	
              3831 ;	
              3832 ; Fill in the next position with a 1 (Food price)	
              3833 ;	
2:A:08 A88:48 3834         tcy   1         	
2:A:11 A91:60 3835         tcmiy 0         ; 7/1 = 0	
2:A:22 AA2:68 3836         tcmiy 1         ; 7/2 = 1	
2:A:04 A84:C0 3837         call  ROT7LFT   ; Move on to the next price	
              3838 ;	
              3839 ; Fill in the remaining three positions with random values from 17-26 (Beast, Scout, Healer)	
              3840 ;	
2:A:09 A89:10 3841 SA89    ldp   0         	
2:A:13 A93:0B 3842         tpc             	
2:A:26 AA6:1D 3843         ldp   11        	
2:A:0C A8C:ED 3844         call  L2ED      ; Generate value from 17-26 and store in 5/1-2	
2:A:19 A99:FD 3845         call  CPY5TO7   ; Copy 5/2-0 to 7/2-0	
2:A:32 AB2:C0 3846         call  ROT7LFT   ; Move on to the next price	
2:A:25 AA5:4D 3847         tcy   11        	
2:A:0A A8A:22 3848         tmy             	
2:A:15 A95:58 3849         ynec  1         ; Have we filled in all five prices yet?	
2:A:2A AAA:89 3850         br    SA89      ; Nope	
              3851 	
              3852 ;	
              3853 ; Copy the price for the current item to 5/2-0 and show it	
              3854 ;	
2:A:14 A94:DE 3855 LA94    call  CPY7TO5   	
2:A:28 AA8:1D 3856         ldp   11        	
2:A:10 A90:80 3857         br    LAC0      	
2:A:20 AA0:00 3858         mnea            	
              3859 	
              3860 ; *** Chapter 2 page 11	
              3861 	
              3862 ;	
              3863 ; Handle Bazaar shopping	
              3864 ;	
2:B:00 AC0:1F 3865 LAC0    ldp   15        	
2:B:01 AC1:FD 3866         call  ROL5BY6   	
2:B:03 AC3:29 3867         ldx   4         	
2:B:07 AC7:43 3868         tcy   12        	
2:B:0F ACF:32 3869         sbit  1         ; 4/12 Bit 1 set - haven't yet haggled, give a better chance of succeeding	
              3870 ;	
              3871 ; Display what's for sale and its price then wait for a response	
              3872 ;	
2:B:1F ADF:1F 3873 SADF    ldp   15        	
2:B:3F AFF:DE 3874         call  DSPWARE   ; Show the player what's for sale...	
2:B:3E AFE:2F 3875 LAFE    ldx   7         	
2:B:3D AFD:47 3876         tcy   14        	
2:B:3B AFB:67 3877         tcmiy 14        ; 7/14 = 14 ("-")	
2:B:37 AF7:67 3878         tcmiy 14        ; 7/15 = 14 ("-")	
2:B:2F AEF:10 3879         ldp   0         	
2:B:1E ADE:0B 3880         tpc             	
              3881 ;	
              3882 ; Prompt the user for a response and process the key pressed	
              3883 ;	
2:B:3C AFC:1E 3884 SAFC    ldp   7         	
2:B:39 AF9:CB 3885         call  PROMPT      	
              3886 	
2:B:33 AF3:52 3887         ynec  4         ; Did they hit Repeat?	
2:B:27 AE7:9D 3888         br    SADD      ; Nope	
              3889 ;	
              3890 ; Handle player hitting Repeat	
              3891 ;	
2:B:0E ACE:9F 3892         br    SADF      ; Go back and display current item	
              3893 	
2:B:1D ADD:59 3894 SADD    ynec  9         ; Did they hit Clear?	
2:B:3A AFA:98 3895         br    SAD8      ; Nope	
              3896 ;	
              3897 ; Handle player hitting Clear	
              3898 ;	
2:B:35 AF5:18 3899         ldp   1         	
2:B:2B AEB:0B 3900         tpc             	
2:B:16 AD6:18 3901         ldp   1         	
2:B:2C AEC:98 3902         br    DOCLEAR   	
              3903 	
2:B:18 AD8:51 3904 SAD8    ynec  8         ; Did they hit No/End?	
2:B:30 AF0:84 3905         br    SAC4      ; Nope	
              3906 ;	
              3907 ; Handle player hitting No/End; display next item	
              3908 ;	
2:B:21 AE1:15 3909 SAE1    ldp   10        	
2:B:02 AC2:C0 3910         call  ROT7LFT   	
2:B:05 AC5:4D 3911         tcy   11        	
2:B:0B ACB:21 3912         tma             ; Check to see what item we're on	
2:B:17 AD7:73 3913         a13aac          ; Have we hit Beast/Scout/Healer?	
2:B:2E AEE:B1 3914         br    SAF1      ; Yes.  Check to see if player already has item in inventory	
2:B:1C ADC:15 3915 SADC    ldp   10        	
2:B:38 AF8:94 3916         br    LA94      ; Copy the price from 7/2-0 to 5/2-0 and show the wares	
              3917 ;	
              3918 ; We're looking at the Beast, Scout and Healer.  Don't show something they already have.	
              3919 ;	
              3920 ; As we added 13 to the current item in view, Acc is as follows:	
              3921 ;	
              3922 ; Acc = 0 - Beast	
              3923 ;       1 - Scout	
              3924 ;       2 - Healer	
              3925 ;	
2:B:31 AF1:2C 3926 SAF1    ldx   1         	
2:B:23 AE3:4C 3927         tcy   3         	
              3928 	
2:B:06 AC6:77 3929         dan             	
2:B:0D ACD:9A 3930         br    SADA      ; We're not on Beast	
2:B:1B ADB:38 3931         tbit1 0         ; Do they have a Beast?	
2:B:36 AF6:A1 3932         br    SAE1      ; Yes, advance to next item	
2:B:2D AED:9C 3933         br    SADC      ; Nope, go back and let them buy it	
              3934 	
2:B:1A ADA:77 3935 SADA    dan             	
2:B:34 AF4:88 3936         br    SAC8      ; We're not on Scout	
2:B:29 AE9:3B 3937         tbit1 3         ; Do they have a Scout?	
2:B:12 AD2:A1 3938         br    SAE1      ; Yes, advance to next item	
2:B:24 AE4:9C 3939         br    SADC      ; Nope, go back and let them buy it	
              3940 	
2:B:08 AC8:3A 3941 SAC8    tbit1 1         ; Do they have a Healer?	
2:B:11 AD1:A1 3942         br    SAE1      ; Yes, advance to next item	
2:B:22 AE2:9C 3943         br    SADC      ; Nope, go back and let them buy it	
              3944 	
2:B:04 AC4:13 3945 SAC4    ldp   12        	
2:B:09 AC9:58 3946         ynec  1         ; Did they hit Haggle?	
2:B:13 AD3:86 3947         br    LB06      ; Nope	
              3948 ;	
              3949 ; Haggle precheck	
              3950 ;	
              3951 ; Check to see that the price isn't already 1 bag of gold	
              3952 ;	
2:B:26 AE6:2D 3953         ldx   5         	
2:B:0C ACC:4C 3954         tcy   3         	
2:B:19 AD9:13 3955         ldp   12        	
2:B:32 AF2:3F 3956         mnez            ; Is 10s digit non-zero?	
2:B:25 AE5:BC 3957         br    LB3C      ; Yep.  We can haggle	
2:B:0A ACA:42 3958         tcy   4         ; Nope, check 1s digit...	
2:B:15 AD5:22 3959         tmy             	
2:B:2A AEA:58 3960         ynec  1         ; Is the current price more than 1 bag of gold?	
2:B:14 AD4:BC 3961         br    LB3C      ; Yeah.  We can haggle.	
2:B:28 AE8:80 3962         br    SB00      ; Price is already 1 bag of gold.  Fuck you.  Close Bazaar	
2:B:10 AD0:00 3963         mnea            	
2:B:20 AE0:00 3964         mnea            	
              3965 	
              3966 ; *** Chapter 2 page 12	
              3967 	
              3968 ;	
              3969 ; Fuck you.  I'm closing the Bazaar.	
              3970 ;	
2:C:00 B00:4A 3971 SB00    tcy   5         ; Wizard/Bazaar Closed/Key Missing	
2:C:01 B01:19 3972         ldp   9         	
2:C:03 B03:C4 3973         call  ROTDRM3   	
2:C:07 B07:46 3974         tcy   6         	
2:C:0F B0F:0D 3975         setr            ; Turn on middle lamp - Bazaar Closed	
2:C:1F B1F:1C 3976         ldp   3         	
2:C:3F B3F:0B 3977         tpc             	
2:C:3E B3E:1D 3978         ldp   11        	
2:C:3D B3D:C0 3979         call  PLYFAIL   	
2:C:3B B3B:46 3980         tcy   6         	
2:C:37 B37:0C 3981         rstr            ; Turn off middle lamp	
2:C:2F B2F:12 3982         ldp   4         	
2:C:1E B1E:B9 3983         br    S939      ; Call ENDTURN	
              3984 ;	
              3985 ; Haggle...	
              3986 ;	
              3987 ; Call RANDOM to get a random value in the Accumulator.  On 0-7, haggling succeeds (50% of the time)	
              3988 ; except when bit 1 of 4/12 is set.  Then it has a 75% chance of success.	
              3989 ;	
2:C:3C B3C:1F 3990 LB3C    ldp   15        	
2:C:39 B39:E6 3991         call  LRANDOM   	
2:C:33 B33:29 3992         ldx   4         	
2:C:27 B27:43 3993         tcy   12        	
2:C:0E B0E:3A 3994         tbit1 1         ; Check bit 1 of 4/12 - is this the first round of haggling?	
2:C:1D B1D:96 3995         br    SB16      ; It's set	
2:C:3A B3A:7E 3996         a8aac           ; 50% chance of haggling succeeding (roll of 0-7)	
2:C:35 B35:80 3997         br    SB00      ; Bazaar Closed on overflow	
2:C:2B B2B:B0 3998         br    SB30      	
              3999 ;	
              4000 ; First round of haggling has a better chance of succeeding.  4/12 bit 1 tracks.	
              4001 ;	
2:C:16 B16:36 4002 SB16    rbit  1         ; Clear 4/12 bit 1; this was your first chance, make it work for you...	
2:C:2C B2C:7C 4003         a4aac           ; 75% chance of succeeding on first round (roll of 0-11)	
2:C:18 B18:80 4004         br    SB00      ; Sorry, sucker	
              4005 ;	
              4006 ; Haggle succeeded.  Reduce the price by one bag of gold and update it in the buffer	
              4007 ;	
2:C:30 B30:29 4008 SB30    ldx   4         	
2:C:21 B21:48 4009         tcy   1         	
2:C:02 B02:60 4010         tcmiy 0         ; 4/1 = 0	
2:C:05 B05:68 4011         tcmiy 1         ; 4/2 = 1	
2:C:0B B0B:1F 4012         ldp   15        	
2:C:17 B17:C0 4013         call  ROL5BY2  	
2:C:2E B2E:EA 4014         call  SB2A      ; Subtract one from the price	
2:C:1C B1C:1F 4015         ldp   15        	
2:C:38 B38:FD 4016         call  ROL5BY6	
2:C:31 B31:1D 4017         ldp   11        	
2:C:23 B23:9F 4018         br    SADF      ; Go back and prompt with the updated price	
              4019 ;	
              4020 ; Bazaar keypress processing continues	
              4021 ;	
2:C:06 B06:1D 4022 LB06    ldp   11        	
2:C:0D B0D:50 4023         ynec  0         ; Did they hit Yes/Buy	
2:C:1B B1B:BE 4024         br    LAFE      ; Nope	
              4025 ;	
              4026 ; Handle Yes/Buy purchase	
              4027 ;	
2:C:36 B36:2D 4028         ldx   5         	
2:C:2D B2D:4A 4029         tcy   5         	
2:C:1A B1A:13 4030         ldp   12        	
2:C:34 B34:60 4031 SB34    tcmiy 0         	
2:C:29 B29:59 4032         ynec  9         	
2:C:12 B12:B4 4033         br    SB34      	
2:C:24 B24:1F 4034 LB24    ldp   15        	
2:C:08 B08:C0 4035         call  ROL5BY2   	
2:C:11 B11:14 4036         ldp   2         	
2:C:22 B22:D9 4037         call  LCP5TO4   	
2:C:04 B04:1F 4038         ldp   15        	
2:C:09 B09:C0 4039         call  ROL5BY2   	
2:C:13 B13:12 4040         ldp   4         	
2:C:26 B26:EA 4041         call  LADDB10   	
2:C:0C B0C:14 4042         ldp   2         	
2:C:19 B19:D9 4043         call  LCP5TO4   	
2:C:32 B32:1F 4044         ldp   15        	
2:C:25 B25:CF 4045         call  ROL5BY4   	
2:C:0A B0A:1B 4046         ldp   13        	
2:C:15 B15:80 4047         br    LB40      	
2:C:2A B2A:10 4048 SB2A    ldp   0         	
2:C:14 B14:0B 4049         tpc             	
2:C:28 B28:13 4050         ldp   12        	
2:C:10 B10:80 4051         br    SU2B10    	
2:C:20 B20:00 4052         mnea            	
              4053 	
              4054 ; *** Chapter 2 page 13	
              4055 	
2:D:00 B40:1E 4056 LB40    ldp   7         	
2:D:01 B41:F6 4057         call  L9F6      	
2:D:03 B43:13 4058         ldp   12        	
2:D:07 B47:EA 4059         call  SB2A      	
2:D:0F B4F:13 4060         ldp   12        	
2:D:1F B5F:3F 4061         mnez            	
2:D:3F B7F:80 4062         br    SB00      	
2:D:3E B7E:2F 4063         ldx   7         	
2:D:3D B7D:4D 4064         tcy   11        	
2:D:3B B7B:21 4065         tma             ; 7/11 - Current Bazaar item	
2:D:37 B77:1B 4066         ldp   13        	
2:D:2F B6F:73 4067         a13aac          	
2:D:1E B5E:93 4068         br    SB53      	
2:D:3C B7C:1F 4069         ldp   15        	
2:D:39 B79:FD 4070         call  ROL5BY6   	
2:D:33 B73:29 4071         ldx   4         	
2:D:27 B67:48 4072         tcy   1         	
2:D:0E B4E:60 4073         tcmiy 0         	
2:D:1D B5D:68 4074         tcmiy 1         	
2:D:3A B7A:12 4075         ldp   4         	
2:D:35 B75:EA 4076         call  LADDB10   	
2:D:2B B6B:14 4077         ldp   2         	
2:D:16 B56:D9 4078         call  LCP5TO4   	
2:D:2C B6C:1F 4079         ldp   15        	
2:D:18 B58:C0 4080         call  ROL5BY2   	
2:D:30 B70:14 4081 SB70    ldp   2         	
2:D:21 B61:C8 4082         call  LSWP4N5   	
2:D:02 B42:14 4083         ldp   2         	
2:D:05 B45:D9 4084         call  LCP5TO4   	
2:D:0B B4B:1C 4085         ldp   3         	
2:D:17 B57:F4 4086         call  5TODSPB   	
2:D:2E B6E:10 4087         ldp   0         	
2:D:1C B5C:0B 4088         tpc             	
2:D:38 B78:1E 4089         ldp   7         	
2:D:31 B71:CB 4090         call  PROMPT      	
2:D:23 B63:59 4091         ynec  9         ; Did the user hit Clear?	
2:D:06 B46:9A 4092         br    SB5A      ; Nope	
              4093 ;	
              4094 ; Handle the user hitting Clear	
              4095 ;	
2:D:0D B4D:18 4096         ldp   1         	
2:D:1B B5B:0B 4097         tpc             	
2:D:36 B76:18 4098         ldp   1         	
2:D:2D B6D:98 4099         br    DOCLEAR   	
              4100 	
2:D:1A B5A:50 4101 SB5A    ynec  0         ; Did the user hit Yes/Buy?	
2:D:34 B74:A4 4102         br    SB64      ; Nope	
              4103 ;	
              4104 ; Handle Yes/Buy	
              4105 ;	
2:D:29 B69:13 4106         ldp   12        	
2:D:12 B52:A4 4107         br    LB24      	
              4108 ;	
              4109 ; Handle Repeat	
              4110 ;	
2:D:24 B64:17 4111 SB64    ldp   14        	
2:D:08 B48:52 4112         ynec  4         ; Did the user hit Repeat?	
2:D:11 B51:80 4113         br    LB80      ; Nope	
2:D:22 B62:1F 4114         ldp   15        	
2:D:04 B44:DE 4115         call  DSPWARE   ; Display the Bazaar's wares	
2:D:09 B49:B0 4116         br    SB70      	
              4117 	
2:D:13 B53:2C 4118 SB53    ldx   1         	
2:D:26 B66:4C 4119         tcy   3         ; Player Scout/Sword/Healer/Beast inventory	
2:D:0C B4C:7B 4120         a14aac          ; Add 14 (0b1110)	
2:D:19 B59:A8 4121         br    SB68      ; They have a Scout, Sword or Healer	
2:D:32 B72:70 4122         iac             ; Add one more	
2:D:25 B65:AA 4123         br    SB6A      	
2:D:0A B4A:30 4124         sbit  0         	
2:D:15 B55:90 4125         br    SB50      	
2:D:2A B6A:33 4126 SB6A    sbit  3         	
2:D:14 B54:90 4127         br    SB50      	
2:D:28 B68:32 4128 SB68    sbit  1         ; Bit 1 - Healer	
2:D:10 B50:17 4129 SB50    ldp   14        	
2:D:20 B60:AB 4130         br    LBAB      	
              4131 	
              4132 ; *** Chapter 2 page 14	
              4133 	
2:E:00 B80:1B 4134 LB80    ldp   13        	
2:E:01 B81:51 4135         ynec  8         	
2:E:03 B83:B0 4136         br    SB70      	
2:E:07 B87:1F 4137         ldp   15        	
2:E:0F B8F:FD 4138         call  ROL5BY6   	
2:E:1F B9F:14 4139         ldp   2         	
2:E:3F BBF:D9 4140         call  LCP5TO4   	
2:E:3E BBE:1F 4141         ldp   15        	
2:E:3D BBD:C0 4142         call  ROL5BY2   	
2:E:3B BBB:2F 4143         ldx   7         	
2:E:37 BB7:4D 4144         tcy   11        	
2:E:2F BAF:21 4145         tma             ; 7/11 - Current Bazaar item	
2:E:1E B9E:7B 4146         a14aac          	
2:E:3C BBC:8E 4147         br    SB8E      	
2:E:39 BB9:1E 4148         ldp   7         	
2:E:33 BB3:F2 4149         call  S9F2      	
2:E:27 BA7:AB 4150         br    LBAB      	
2:E:0E B8E:18 4151 SB8E    ldp   1         	
2:E:1D B9D:0B 4152         tpc             	
2:E:3A BBA:15 4153         ldp   10        	
2:E:35 BB5:CE 4154         call  ADDFOOD   	
              4155 	
2:E:2B BAB:1F 4156 LBAB    ldp   15        	
2:E:16 B96:CF 4157         call  ROL5BY4   	
2:E:2C BAC:14 4158         ldp   2         	
2:E:18 B98:D9 4159         call  LCP5TO4   	
2:E:30 BB0:1E 4160         ldp   7         	
2:E:21 BA1:D1 4161         call  L9D1      ; Call SUBGOLD	
2:E:02 B82:29 4162         ldx   4         	
2:E:05 B85:4B 4163         tcy   13        	
2:E:0B B8B:35 4164         rbit  2         ; Flag that Gold changed during encounter	
2:E:17 B97:10 4165         ldp   0         	
2:E:2E BAE:0B 4166         tpc             	
2:E:1C B9C:1A 4167         ldp   5         	
2:E:38 BB8:C0 4168         call  DSPRSLT   ; Display results	
2:E:31 BB1:12 4169         ldp   4         	
2:E:23 BA3:B9 4170         br    S939      	
              4171 	
2:E:06 B86:1F 4172 LB86    ldp   15        	
2:E:0D B8D:E6 4173         call  LRANDOM   ; Call RANDOM.  Random value in A; Y=2	
2:E:1B B9B:29 4174         ldx   4         	
2:E:36 BB6:24 4175         tamdyn          ; 4/2 = random value	
2:E:2D BAD:60 4176         tcmiy 0         ; 4/1 = 0	
2:E:1A B9A:37 4177         rbit  3         ; Ensure random number is 0-7	
2:E:34 BB4:2D 4178         ldx   5         	
2:E:29 BA9:48 4179         tcy   1         	
2:E:12 B92:68 4180         tcmiy 1         ; 5/1 = 1	
2:E:24 BA4:6C 4181         tcmiy 3         ; 5/2 = 3	
2:E:08 B88:12 4182         ldp   4         	
2:E:11 B91:EA 4183         call  LADDB10   ; Add 4/1-2 to 5/1-2 - Give value of 13-20	
2:E:22 BA2:14 4184         ldp   2         	
2:E:04 B84:99 4185         br    LCP5TO4   ; Copy result to 4	
              4186 	
2:E:09 B89:77 4187 LB89    dan             	
2:E:13 B93:D4 4188         call  SB94      ; Zero out 5/0-2	
2:E:26 BA6:3F 4189         mnez            ; Check for overflow	
2:E:0C B8C:E5 4190         call  SBA5      ; Yep.  Cap it at 99	
2:E:19 B99:12 4191         ldp   4         	
2:E:32 BB2:B2 4192         br    L932      ; Display the current Brigand count	
              4193 	
2:E:25 BA5:48 4194 SBA5    tcy   1         	
2:E:0A B8A:69 4195         tcmiy 9         	
2:E:15 B95:69 4196         tcmiy 9         	
2:E:2A BAA:0F 4197         retn            	
              4198 	
2:E:14 B94:60 4199 SB94    tcmiy 0         	
2:E:28 BA8:60 4200         tcmiy 0         	
2:E:10 B90:60 4201         tcmiy 0         	
2:E:20 BA0:0F 4202         retn            	
              4203 	
              4204 	
              4205 ; *** Chapter 2 page 15	
              4206 	
              4207 ;********************************************************************************	
              4208 ; ROL5BY2 - Call the routine to rotate the buffer at 5/8-1 left 2 times	
              4209 ;********************************************************************************	
2:F:00 BC0:10 4210 ROL5BY2 ldp   0         	
2:F:01 BC1:0B 4211         tpc             	
2:F:03 BC3:1D 4212         ldp   11        	
2:F:07 BC7:8F 4213         br    L2CF      	
              4214 ;********************************************************************************	
              4215 ; ROL5BY4 - Call the routine to rotate the buffer at 5/8-1 left 4 times	
              4216 ;********************************************************************************	
2:F:0F BCF:10 4217 ROL5BY4 ldp   0         	
2:F:1F BDF:0B 4218         tpc             	
2:F:3F BFF:1D 4219         ldp   11        	
2:F:3E BFE:83 4220         br    L2C3      	
              4221 ;********************************************************************************	
              4222 ; ROL5BY6 - Call the routine to rotate the buffer at 5/8-1 left 6 times	
              4223 ;********************************************************************************	
2:F:3D BFD:10 4224 ROL5BY6 ldp   0         	
2:F:3B BFB:0B 4225         tpc             	
2:F:37 BF7:1D 4226         ldp   11        	
2:F:2F BEF:80 4227         br    L2C0      	
              4228 	
              4229 ;********************************************************************************	
              4230 ; DISPWARE - Display the Bazaar merchant's wares	
              4231 ;********************************************************************************	
2:F:1E BDE:C0 4232 DSPWARE call  ROL5BY2   	
2:F:3C BFC:1C 4233         ldp   3         	
2:F:39 BF9:F4 4234         call  5TODSPB   	
2:F:33 BF3:FD 4235         call  ROL5BY6   	
2:F:27 BE7:2F 4236         ldx   7         	
2:F:0E BCE:4D 4237         tcy   11        	
2:F:1D BDD:21 4238         tma             ; Pick up the current Bazaar item being looked at	
              4239 	
2:F:3A BFA:7D 4240         a12aac          	
2:F:35 BF5:B6 4241         br    SBF6      	
2:F:2B BEB:48 4242         tcy   1         ; Warrior/Food/Beast	
2:F:16 BD6:19 4243         ldp   9         	
2:F:2C BEC:C4 4244         call  ROTDRM3   	
2:F:18 BD8:2F 4245         ldx   7         	
2:F:30 BF0:4D 4246         tcy   11        	
2:F:21 BE1:21 4247         tma             	
              4248 	
2:F:02 BC2:73 4249         a13aac          	
2:F:05 BC5:A2 4250         br    SBE2      	
2:F:0B BCB:70 4251         iac             	
2:F:17 BD7:A3 4252         br    SBE3      	
2:F:2E BEE:10 4253 SBEE    ldp   0         	
2:F:1C BDC:0B 4254         tpc             	
2:F:38 BF8:19 4255         ldp   9         	
2:F:31 BF1:81 4256         br    L241      	
2:F:23 BE3:10 4257 SBE3    ldp   0         	
2:F:06 BC6:0B 4258         tpc             	
2:F:0D BCD:19 4259         ldp   9         	
2:F:1B BDB:9F 4260         br    L25F      	
              4261 	
2:F:36 BF6:44 4262 SBF6    tcy   2         ; Scout/Healer/Gold	
2:F:2D BED:19 4263         ldp   9         	
2:F:1A BDA:C4 4264         call  ROTDRM3   	
2:F:34 BF4:2F 4265         ldx   7         	
2:F:29 BE9:4D 4266         tcy   11        	
2:F:12 BD2:21 4267         tma             	
              4268 	
2:F:24 BE4:75 4269         a11aac          	
2:F:08 BC8:A3 4270         br    SBE3      	
2:F:11 BD1:AE 4271         br    SBEE      	
2:F:22 BE2:10 4272 SBE2    ldp   0         	
2:F:04 BC4:0B 4273         tpc             	
2:F:09 BC9:19 4274         ldp   9         	
2:F:13 BD3:BB 4275         br    L27B      	
              4276 	
2:F:26 BE6:10 4277 LRANDOM ldp   0         	
2:F:0C BCC:0B 4278         tpc             	
2:F:19 BD9:1C 4279         ldp   3         	
2:F:32 BF2:80 4280         br    RANDOM    	
              4281 	
2:F:25 BE5:10 4282 LBE5    ldp   0         	
2:F:0A BCA:0B 4283         tpc             	
2:F:15 BD5:11 4284         ldp   8         	
2:F:2A BEA:8D 4285         br    L20D      	
2:F:14 BD4:18 4286 LBD4    ldp   1         	
2:F:28 BE8:0B 4287         tpc             	
2:F:10 BD0:16 4288         ldp   6         	
2:F:20 BE0:B2 4289         br    CPY2TO5   	
              4290 	
              4291 ; *** Chapter 3 page 0	
              4292 	
              4293 	
              4294 ;********************************************************************************	
              4295 ; PLAYBUF - Play the sound buffer loaded in the Scratchpad RAM region	
              4296 ;	
              4297 ; 4/Y and 5/Y have array of durations	
              4298 ; 6/Y and 7/Y have array of pitches	
              4299 ; Notes are loaded in reverse order from Y=(0-10) down to 0	
              4300 ;	
              4301 ; Called with Y register pointing to first note plus 1	
              4302 ;********************************************************************************	
3:0:00 C00:23 4303 PLAYBUF tya             ; Transfer the Y register to the Accumulator	
3:0:01 C01:77 4304         dan             ; Subtract one from Accumulator to point to beginning of sound buffer at 4/Y	
3:0:03 C03:2E 4305         ldx   3         	
3:0:07 C07:45 4306         tcy   10        	
3:0:0F C0F:27 4307 SC0F    tam             ; Save updated pointer into sound buffer into 3/10	
3:0:1F C1F:22 4308         tmy             	
3:0:3F C3F:29 4309         ldx   4         ; Check 4/Y	
3:0:3E C3E:3F 4310         mnez            	
3:0:3D C3D:BA 4311         br    SC3A      ; There's a non-zero value here, play it	
              4312 	
3:0:3B C3B:2D 4313         ldx   5         ; Check 5/Y	
3:0:37 C37:3F 4314         mnez            	
3:0:2F C2F:BA 4315         br    SC3A      ; There's a non-zero value here, play it	
3:0:1E C1E:18 4316         ldp   1         	
3:0:3C C3C:9F 4317         br    LC5F      ; There's a zero here... play silence (a rest)	
              4318 	
3:0:39 C39:00 4319 SC39    mnea            	
3:0:33 C33:00 4320         mnea            	
3:0:27 C27:00 4321         mnea            	
3:0:0E C0E:00 4322         mnea            	
3:0:1D C1D:27 4323 SC1D    tam             	
              4324 	
3:0:3A C3A:45 4325 SC3A    tcy   10        ; Select the speaker R output	
3:0:35 C35:0D 4326         setr            ; Toggle the speaker on	
3:0:2B C2B:00 4327         mnea            	
3:0:16 C16:00 4328         mnea            	
3:0:2C C2C:00 4329         mnea            	
3:0:18 C18:00 4330         mnea            	
3:0:30 C30:2E 4331         ldx   3         	
3:0:21 C21:0C 4332         rstr            ; Toggle the speaker off	
3:0:02 C02:22 4333         tmy             ; Restore the note we were playing	
              4334 ;	
              4335 ; Load delay from 6/Y and 7/Y into A and Y respectively and delay for that many loops	
              4336 ;	
              4337 ; This adjusts the time between toggles of the speaker	
              4338 ;	
3:0:05 C05:2B 4339         ldx   6         	
3:0:0B C0B:21 4340         tma             	
3:0:17 C17:2F 4341         ldx   7         	
3:0:2E C2E:22 4342         tmy             	
3:0:1C C1C:04 4343 SC1C    dyn             	
3:0:38 C38:9C 4344         br    SC1C      	
3:0:31 C31:77 4345         dan             	
3:0:23 C23:9C 4346         br    SC1C      	
              4347 ;	
              4348 ; Restore the note we're on into the Y register	
              4349 ;	
3:0:06 C06:2E 4350         ldx   3         	
3:0:0D C0D:45 4351         tcy   10        	
3:0:1B C1B:22 4352         tmy             	
              4353 ;	
              4354 ; Loop based on 5/Y and 4/Y, playing the note repeatedly.  This gives duration.	
              4355 ;	
3:0:36 C36:2D 4356         ldx   5         	
3:0:2D C2D:07 4357         dman            	
3:0:1A C1A:B9 4358         br    SC39      	
3:0:34 C34:27 4359         tam             	
3:0:29 C29:29 4360         ldx   4         	
3:0:12 C12:07 4361         dman            	
3:0:24 C24:9D 4362         br    SC1D      	
              4363 ;	
              4364 ; Note has been played for requested duration, decrement 3/10 and loop	
              4365 ;	
3:0:08 C08:2E 4366 LC08    ldx   3         	
3:0:11 C11:45 4367         tcy   10        	
3:0:22 C22:07 4368         dman            	
3:0:04 C04:8F 4369         br    SC0F      	
3:0:09 C09:0F 4370         retn            	
              4371 	
3:0:13 C13:11 4372 LC13    ldp   8         	
3:0:26 C26:AF 4373         br    PLYLOSR   ; Play the "lose round" sound	
              4374 	
              4375 ;********************************************************************************	
              4376 ; PLYTHEM - Play the theme song (start of game and victory over Dark Tower)	
              4377 ;********************************************************************************	
3:0:0C C0C:2B 4378 PLYTHEM ldx   6         	
3:0:19 C19:40 4379         tcy   0         ; 6/0 - 7 1 8 0 11 0 8 1 11 1 8	
3:0:32 C32:6E 4380         tcmiy 7         	
3:0:25 C25:68 4381         tcmiy 1         	
3:0:0A C0A:61 4382         tcmiy 8         	
3:0:15 C15:60 4383         tcmiy 0         	
3:0:2A C2A:6D 4384         tcmiy 11        	
3:0:14 C14:60 4385         tcmiy 0         	
3:0:28 C28:61 4386         tcmiy 8         	
3:0:10 C10:18 4387         ldp   1         	
3:0:20 C20:8D 4388         br    LC4D      	
              4389 	
              4390 	
              4391 ; *** Chapter 3 page 1	
              4392 	
              4393 ;	
              4394 ; More of the PLAYBUF routine.  Code responsible for playing silence (a rest)	
              4395 ;	
3:1:00 C40:00 4396 SC40    mnea            	
3:1:01 C41:00 4397         mnea            	
3:1:03 C43:00 4398         mnea            	
3:1:07 C47:00 4399         mnea            	
3:1:0F C4F:27 4400 SC4F    tam             	
              4401 	
              4402 ;	
              4403 ; Play a "zero" note - silence	
              4404 ;	
3:1:1F C5F:7F 4405 LC5F    cla             	
3:1:3F C7F:77 4406         dan             	
3:1:3E C7E:00 4407 SC7E    mnea            	
3:1:3D C7D:00 4408         mnea            	
3:1:3B C7B:00 4409         mnea            	
3:1:37 C77:00 4410         mnea            	
3:1:2F C6F:00 4411         mnea            	
3:1:1E C5E:77 4412         dan             	
3:1:3C C7C:BE 4413         br    SC7E      	
3:1:39 C79:2F 4414         ldx   7         	
3:1:33 C73:07 4415         dman            	
3:1:27 C67:80 4416         br    SC40      	
3:1:0E C4E:27 4417         tam             	
3:1:1D C5D:2B 4418         ldx   6         	
3:1:3A C7A:07 4419         dman            	
3:1:35 C75:8F 4420         br    SC4F      	
3:1:2B C6B:10 4421         ldp   0         	
3:1:16 C56:88 4422         br    LC08      ; Go back and play the next note	
              4423 	
              4424 ;********************************************************************************	
              4425 ; PLYTICK - Play tick sound on keypress	
              4426 ;********************************************************************************	
3:1:2C C6C:2F 4427 PLYTICK ldx   7         	
3:1:18 C58:40 4428         tcy   0         ; 7/0 - 0	
3:1:30 C70:60 4429         tcmiy 0         	
3:1:21 C61:2B 4430         ldx   6         	
3:1:02 C42:40 4431         tcy   0         ; 6/0 - 4	
3:1:05 C45:62 4432         tcmiy 4         	
3:1:0B C4B:2D 4433         ldx   5         	
3:1:17 C57:40 4434         tcy   0         ; 5/0 - 1	
3:1:2E C6E:68 4435         tcmiy 1         	
3:1:1C C5C:29 4436         ldx   4         	
3:1:38 C78:40 4437         tcy   0         ; 4/0 - 0	
3:1:31 C71:60 4438         tcmiy 0         	
3:1:23 C63:10 4439         ldp   0         	
3:1:06 C46:80 4440         br    PLAYBUF   ; Play the tick sound and return to caller	
              4441 	
              4442 ;********************************************************************************	
              4443 ; Continue loading play buffer for part 1 of intro tune	
              4444 ;********************************************************************************	
3:1:0D C4D:68 4445 LC4D    tcmiy 1         	
3:1:1B C5B:6D 4446         tcmiy 11        	
3:1:36 C76:68 4447         tcmiy 1         	
3:1:2D C6D:61 4448         tcmiy 8         	
3:1:1A C5A:2F 4449         ldx   7         	
3:1:34 C74:40 4450         tcy   0         ; 7/0 - 5 0 11 1 13 1 11 0 13 0 11	
3:1:29 C69:6A 4451         tcmiy 5         	
3:1:12 C52:60 4452         tcmiy 0         	
3:1:24 C64:6D 4453         tcmiy 11        	
3:1:08 C48:68 4454         tcmiy 1         	
3:1:11 C51:6B 4455         tcmiy 13        	
3:1:22 C62:68 4456         tcmiy 1         	
3:1:04 C44:6D 4457         tcmiy 11        	
3:1:09 C49:60 4458         tcmiy 0         	
3:1:13 C53:6B 4459         tcmiy 13        	
3:1:26 C66:60 4460         tcmiy 0         	
3:1:0C C4C:6D 4461         tcmiy 11        	
3:1:19 C59:29 4462         ldx   4         	
3:1:32 C72:40 4463         tcy   0         ; 4/0 - 6 0 2 0 1 0 2 1 0 4 0 6	
3:1:25 C65:66 4464         tcmiy 6         	
3:1:0A C4A:60 4465         tcmiy 0         	
3:1:15 C55:64 4466         tcmiy 2         	
3:1:2A C6A:60 4467         tcmiy 0         	
3:1:14 C54:68 4468         tcmiy 1         	
3:1:28 C68:60 4469         tcmiy 0         	
3:1:10 C50:14 4470         ldp   2         	
3:1:20 C60:80 4471         br    LC80      	
              4472 	
              4473 ; *** Chapter 3 page 2	
              4474 	
3:2:00 C80:68 4475 LC80    tcmiy 1         	
3:2:01 C81:60 4476         tcmiy 0         	
3:2:03 C83:62 4477         tcmiy 4         	
3:2:07 C87:60 4478         tcmiy 0         	
3:2:0F C8F:66 4479         tcmiy 6         	
3:2:1F C9F:2D 4480         ldx   5         	
3:2:3F CBF:40 4481         tcy   0         ; 5/0 - 0 0 2 0 10 0 10 0 4 0 0	
3:2:3E CBE:60 4482         tcmiy 0         	
3:2:3D CBD:60 4483         tcmiy 0         	
3:2:3B CBB:64 4484         tcmiy 2         	
3:2:37 CB7:60 4485         tcmiy 0         	
3:2:2F CAF:65 4486         tcmiy 10        	
3:2:1E C9E:60 4487         tcmiy 0         	
3:2:3C CBC:65 4488         tcmiy 10        	
3:2:39 CB9:60 4489         tcmiy 0         	
3:2:33 CB3:62 4490         tcmiy 4         	
3:2:27 CA7:60 4491         tcmiy 0         	
3:2:0E C8E:60 4492         tcmiy 0         	
3:2:1D C9D:10 4493         ldp   0         	
3:2:3A CBA:C0 4494         call  PLAYBUF   ; Play part 1 of intro tune	
              4495 	
              4496 ;********************************************************************************	
              4497 ; Load play buffer for part 2 of intro tune	
              4498 ;********************************************************************************	
3:2:35 CB5:2B 4499         ldx   6         	
3:2:2B CAB:40 4500         tcy   0         ; 6/0 - 1 5 1 7 0 8 0 7 1 8 1	
3:2:16 C96:68 4501         tcmiy 1         	
3:2:2C CAC:6A 4502         tcmiy 5         	
3:2:18 C98:68 4503         tcmiy 1         	
3:2:30 CB0:6E 4504         tcmiy 7         	
3:2:21 CA1:60 4505         tcmiy 0         	
3:2:02 C82:61 4506         tcmiy 8         	
3:2:05 C85:60 4507         tcmiy 0         	
3:2:0B C8B:6E 4508         tcmiy 7         	
3:2:17 C97:68 4509         tcmiy 1         	
3:2:2E CAE:61 4510         tcmiy 8         	
3:2:1C C9C:68 4511         tcmiy 1         	
3:2:38 CB8:2F 4512         ldx   7         	
3:2:31 CB1:40 4513         tcy   0         ; 7/0 - 0 10 0 3 1 11 1 5 0 11 0	
3:2:23 CA3:60 4514         tcmiy 0         	
3:2:06 C86:65 4515         tcmiy 10        	
3:2:0D C8D:60 4516         tcmiy 0         	
3:2:1B C9B:6C 4517         tcmiy 3         	
3:2:36 CB6:68 4518         tcmiy 1         	
3:2:2D CAD:6D 4519         tcmiy 11        	
3:2:1A C9A:68 4520         tcmiy 1         	
3:2:34 CB4:6A 4521         tcmiy 5         	
3:2:29 CA9:60 4522         tcmiy 0         	
3:2:12 C92:6D 4523         tcmiy 11        	
3:2:24 CA4:60 4524         tcmiy 0         	
3:2:08 C88:29 4525         ldx   4         	
3:2:11 C91:40 4526         tcy   0         ; 4/0 - 0 8 0 2 0 1 0 1 0 4 0	
3:2:22 CA2:60 4527         tcmiy 0         	
3:2:04 C84:61 4528         tcmiy 8         	
3:2:09 C89:60 4529         tcmiy 0         	
3:2:13 C93:64 4530         tcmiy 2         	
3:2:26 CA6:60 4531         tcmiy 0         	
3:2:0C C8C:68 4532         tcmiy 1         	
3:2:19 C99:60 4533         tcmiy 0         	
3:2:32 CB2:68 4534         tcmiy 1         	
3:2:25 CA5:60 4535         tcmiy 0         	
3:2:0A C8A:62 4536         tcmiy 4         	
3:2:15 C95:60 4537         tcmiy 0         	
3:2:2A CAA:2D 4538         ldx   5         	
3:2:14 C94:40 4539         tcy   0         ; 5/0 - 3 0 0 2 0 10 0 10 0 5 0	
3:2:28 CA8:60 4540         tcmiy 0         	
3:2:10 C90:1C 4541         ldp   3         	
3:2:20 CA0:80 4542         br    LCC0      	
              4543 	
              4544 ; *** Chapter 3 page 3	
              4545 	
3:3:00 CC0:60 4546 LCC0    tcmiy 0         	
3:3:01 CC1:60 4547         tcmiy 0         	
3:3:03 CC3:64 4548         tcmiy 2         	
3:3:07 CC7:60 4549         tcmiy 0         	
3:3:0F CCF:65 4550         tcmiy 10        	
3:3:1F CDF:60 4551         tcmiy 0         	
3:3:3F CFF:65 4552         tcmiy 10        	
3:3:3E CFE:60 4553         tcmiy 0         	
3:3:3D CFD:6A 4554         tcmiy 5         	
3:3:3B CFB:60 4555         tcmiy 0         	
3:3:37 CF7:10 4556         ldp   0         	
3:3:2F CEF:C0 4557         call  PLAYBUF   ; Play part 2 of the intro tune	
              4558 	
              4559 ;********************************************************************************	
              4560 ; Load play buffer for part 3 of intro tune	
              4561 ;********************************************************************************	
3:3:1E CDE:2B 4562         ldx   6         	
3:3:3C CFC:40 4563         tcy   0         ; 6/0 - 6 1 8 0 11 0 8 1 11	
3:3:39 CF9:66 4564         tcmiy 6         	
3:3:33 CF3:68 4565         tcmiy 1         	
3:3:27 CE7:61 4566         tcmiy 8         	
3:3:0E CCE:60 4567         tcmiy 0         	
3:3:1D CDD:6D 4568         tcmiy 11        	
3:3:3A CFA:60 4569         tcmiy 0         	
3:3:35 CF5:61 4570         tcmiy 8         	
3:3:2B CEB:68 4571         tcmiy 1         	
3:3:16 CD6:6D 4572         tcmiy 11        	
3:3:2C CEC:2F 4573         ldx   7         	
3:3:18 CD8:40 4574         tcy   0         ; 7/0 - 13 0 11 1 13 1 11 0 13	
3:3:30 CF0:6B 4575         tcmiy 13        	
3:3:21 CE1:60 4576         tcmiy 0         	
3:3:02 CC2:6D 4577         tcmiy 11        	
3:3:05 CC5:68 4578         tcmiy 1         	
3:3:0B CCB:6B 4579         tcmiy 13        	
3:3:17 CD7:68 4580         tcmiy 1         	
3:3:2E CEE:6D 4581         tcmiy 11        	
3:3:1C CDC:60 4582         tcmiy 0         	
3:3:38 CF8:6B 4583         tcmiy 13        	
3:3:31 CF1:29 4584         ldx   4         	
3:3:23 CE3:40 4585         tcy   0         ; 4/0 - 15 0 2 0 1 0 2 0 3	
3:3:06 CC6:6F 4586         tcmiy 15        	
3:3:0D CCD:60 4587         tcmiy 0         	
3:3:1B CDB:64 4588         tcmiy 2         	
3:3:36 CF6:60 4589         tcmiy 0         	
3:3:2D CED:68 4590         tcmiy 1         	
3:3:1A CDA:60 4591         tcmiy 0         	
3:3:34 CF4:64 4592         tcmiy 2         	
3:3:29 CE9:60 4593         tcmiy 0         	
3:3:12 CD2:6C 4594         tcmiy 3         	
3:3:24 CE4:2D 4595         ldx   5         	
3:3:08 CC8:40 4596         tcy   0         ; 5/0 - 15 0 2 0 10 0 2 0 4	
3:3:11 CD1:6F 4597         tcmiy 15        	
3:3:22 CE2:60 4598         tcmiy 0         	
3:3:04 CC4:64 4599         tcmiy 2         	
3:3:09 CC9:60 4600         tcmiy 0         	
3:3:13 CD3:65 4601         tcmiy 10        	
3:3:26 CE6:60 4602         tcmiy 0         	
3:3:0C CCC:64 4603         tcmiy 2         	
3:3:19 CD9:60 4604         tcmiy 0         	
3:3:32 CF2:62 4605         tcmiy 4         	
3:3:25 CE5:10 4606         ldp   0         	
3:3:0A CCA:80 4607         br    PLAYBUF   ; Play part 3 of the intro tune and return to the caller	
              4608 	
              4609 ;********************************************************************************	
              4610 ; PLAYEOT - Play the end of turn sound (three tones)	
              4611 ;********************************************************************************	
3:3:15 CD5:2B 4612 PLAYEOT ldx   6         	
3:3:2A CEA:40 4613         tcy   0         ; 6/0 - 1 3 6	
3:3:14 CD4:68 4614         tcmiy 1         	
3:3:28 CE8:6C 4615         tcmiy 3         	
3:3:10 CD0:12 4616         ldp   4         	
3:3:20 CE0:80 4617         br    LD00      	
              4618 	
              4619 ; *** Chapter 3 page 4	
              4620 	
3:4:00 D00:66 4621 LD00    tcmiy 6         	
3:4:01 D01:2F 4622         ldx   7         	
3:4:03 D03:40 4623         tcy   0         ; 7/0 - 3 0 11	
3:4:07 D07:6C 4624         tcmiy 3         	
3:4:0F D0F:60 4625         tcmiy 0         	
3:4:1F D1F:6D 4626         tcmiy 11        	
3:4:3F D3F:29 4627         ldx   4         	
3:4:3E D3E:40 4628         tcy   0         ; 4/0 - 8 4 2	
3:4:3D D3D:61 4629         tcmiy 8         	
3:4:3B D3B:62 4630         tcmiy 4         	
3:4:37 D37:64 4631         tcmiy 2         	
3:4:2F D2F:2D 4632         ldx   5         	
3:4:1E D1E:40 4633         tcy   0         ; 5/0 - 0 0 0	
3:4:3C D3C:60 4634         tcmiy 0         	
3:4:39 D39:60 4635         tcmiy 0         	
3:4:33 D33:60 4636         tcmiy 0         	
3:4:27 D27:10 4637         ldp   0         	
3:4:0E D0E:80 4638         br    PLAYBUF   ; Play the EOT sound and return to caller	
              4639 	
              4640 ;********************************************************************************	
              4641 ; PLYBAZR - Play Bazaar snake charmer tune	
              4642 ;********************************************************************************	
3:4:1D D1D:2B 4643 PLYBAZR ldx   6         	
3:4:3A D3A:40 4644         tcy   0         ; 6/0 - 6 5 6 7 6 5 6 7 9	
3:4:35 D35:66 4645         tcmiy 6         	
3:4:2B D2B:6A 4646         tcmiy 5         	
3:4:16 D16:66 4647         tcmiy 6         	
3:4:2C D2C:6E 4648         tcmiy 7         	
3:4:18 D18:66 4649         tcmiy 6         	
3:4:30 D30:6A 4650         tcmiy 5         	
3:4:21 D21:66 4651         tcmiy 6         	
3:4:02 D02:6E 4652         tcmiy 7         	
3:4:05 D05:69 4653         tcmiy 9         	
3:4:0B D0B:2F 4654         ldx   7         	
3:4:17 D17:40 4655         tcy   0         ; 7/0 - 3 15 3 10 3 15 3 10 7	
3:4:2E D2E:6C 4656         tcmiy 3         	
3:4:1C D1C:6F 4657         tcmiy 15        	
3:4:38 D38:6C 4658         tcmiy 3         	
3:4:31 D31:65 4659         tcmiy 10        	
3:4:23 D23:6C 4660         tcmiy 3         	
3:4:06 D06:6F 4661         tcmiy 15        	
3:4:0D D0D:6C 4662         tcmiy 3         	
3:4:1B D1B:65 4663         tcmiy 10        	
3:4:36 D36:6E 4664         tcmiy 7         	
3:4:2D D2D:29 4665         ldx   4         	
3:4:1A D1A:40 4666         tcy   0         ; 4/0 - 10 5 5 5 5 5 5 5 5 5	
3:4:34 D34:65 4667         tcmiy 10        	
3:4:29 D29:6A 4668 SD29    tcmiy 5         	
3:4:12 D12:59 4669         ynec  9         	
3:4:24 D24:A9 4670         br    SD29      	
3:4:08 D08:2D 4671         ldx   5         	
3:4:11 D11:40 4672         tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0 0	
3:4:22 D22:60 4673 SD22    tcmiy 0         	
3:4:04 D04:59 4674         ynec  9         	
3:4:09 D09:A2 4675         br    SD22      	
3:4:13 D13:10 4676         ldp   0         	
3:4:26 D26:C0 4677         call  PLAYBUF   ; Play part 1 of tune	
              4678 	
3:4:0C D0C:2B 4679 LD0C    ldx   6         	
3:4:19 D19:40 4680         tcy   0         ; 6/0 - 15	
3:4:32 D32:6F 4681         tcmiy 15        	
3:4:25 D25:2F 4682         ldx   7         	
3:4:0A D0A:40 4683         tcy   0         ; 7/0 - 15	
3:4:15 D15:6F 4684         tcmiy 15        	
3:4:2A D2A:29 4685         ldx   4         	
3:4:14 D14:40 4686         tcy   0         ; 4/0 - 0	
3:4:28 D28:60 4687         tcmiy 0         	
3:4:10 D10:1A 4688         ldp   5         	
3:4:20 D20:80 4689         br    LD40      	
              4690 	
              4691 ; *** Chapter 3 page 5	
              4692 	
3:5:00 D40:2D 4693 LD40    ldx   5         	
3:5:01 D41:40 4694         tcy   0         ; 5/0 - 0	
3:5:03 D43:60 4695         tcmiy 0         	
3:5:07 D47:10 4696         ldp   0         	
3:5:0F D4F:80 4697         br    PLAYBUF   ; Play part 2 of tune and return to caller	
              4698 	
              4699 ;********************************************************************************	
              4700 ; PLYSANC - Play the Sanctuary / Citadel sound	
              4701 ;********************************************************************************	
3:5:1F D5F:CE 4702 PLYSANC call  SD4E      	
3:5:3F D7F:CE 4703         call  SD4E      	
3:5:3E D7E:CE 4704         call  SD4E      	
3:5:3D D7D:CE 4705         call  SD4E      	
3:5:3B D7B:CE 4706         call  SD4E      	
3:5:37 D77:E9 4707         call  SD69      	
3:5:2F D6F:E9 4708         call  SD69      	
3:5:1E D5E:E9 4709         call  SD69      	
3:5:3C D7C:E9 4710         call  SD69      	
3:5:39 D79:E9 4711         call  SD69      	
3:5:33 D73:12 4712         ldp   4         	
3:5:27 D67:8C 4713         br    LD0C      	
              4714 	
              4715 ;	
              4716 ; First half of Sanctuary / Citadel sound 	
              4717 ;	
3:5:0E D4E:2B 4718 SD4E    ldx   6         	
3:5:1D D5D:40 4719         tcy   0         ; 6/0 - 0 0 1 0 0 1 0 0 1 	
3:5:3A D7A:60 4720 SD7A    tcmiy 0         	
3:5:35 D75:60 4721         tcmiy 0         	
3:5:2B D6B:68 4722         tcmiy 1         	
3:5:16 D56:59 4723         ynec  9         	
3:5:2C D6C:BA 4724         br    SD7A      	
3:5:18 D58:2F 4725         ldx   7         	
3:5:30 D70:40 4726         tcy   0         ; 7/0 - 10 14 4 10 14 4 10 14 4 	
3:5:21 D61:65 4727 SD61    tcmiy 10        	
3:5:02 D42:67 4728         tcmiy 14        	
3:5:05 D45:62 4729         tcmiy 4         	
3:5:0B D4B:59 4730         ynec  9         	
3:5:17 D57:A1 4731         br    SD61      	
3:5:2E D6E:29 4732         ldx   4         	
3:5:1C D5C:40 4733         tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1	
3:5:38 D78:68 4734 SD78    tcmiy 1         	
3:5:31 D71:59 4735         ynec  9         	
3:5:23 D63:B8 4736         br    SD78      	
3:5:06 D46:2D 4737         ldx   5         	
3:5:0D D4D:40 4738         tcy   0         ; 5/0 - 10 10 10 10 10 10 10 10 10	
3:5:1B D5B:65 4739 SD5B    tcmiy 10        	
3:5:36 D76:59 4740         ynec  9         	
3:5:2D D6D:9B 4741         br    SD5B      	
3:5:1A D5A:10 4742         ldp   0         	
3:5:34 D74:80 4743         br    PLAYBUF      	
              4744 	
              4745 ;	
              4746 ; Second half of Sanctuary / Citadel sound	
              4747 ;	
3:5:29 D69:2B 4748 SD69    ldx   6         	
3:5:12 D52:40 4749         tcy   0         ; 6/0 - 0 0 1 0 0 1 0 0 1 	
3:5:24 D64:60 4750 SD64    tcmiy 0         	
3:5:08 D48:60 4751         tcmiy 0         	
3:5:11 D51:68 4752         tcmiy 1         	
3:5:22 D62:59 4753         ynec  9         	
3:5:04 D44:A4 4754         br    SD64      	
3:5:09 D49:2F 4755         ldx   7         ; 7/0 - 9 15 4 9 15 4 9 15 4 	
3:5:13 D53:40 4756         tcy   0         	
3:5:26 D66:69 4757 SD66    tcmiy 9         	
3:5:0C D4C:6F 4758         tcmiy 15        	
3:5:19 D59:62 4759         tcmiy 4         	
3:5:32 D72:59 4760         ynec  9         	
3:5:25 D65:A6 4761         br    SD66      	
3:5:0A D4A:29 4762         ldx   4         	
3:5:15 D55:40 4763         tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1 	
3:5:2A D6A:68 4764 SD6A    tcmiy 1         	
3:5:14 D54:59 4765         ynec  9         	
3:5:28 D68:AA 4766         br    SD6A      	
3:5:10 D50:16 4767         ldp   6         	
3:5:20 D60:80 4768         br    LD80      	
              4769 	
              4770 ; *** Chapter 3 page 6	
              4771 	
3:6:00 D80:2D 4772 LD80    ldx   5         	
3:6:01 D81:40 4773         tcy   0         ; 5/0 - 10 10 10 10 10 10 10 10 10 	
3:6:03 D83:65 4774 SD83    tcmiy 10        	
3:6:07 D87:59 4775         ynec  9         	
3:6:0F D8F:83 4776         br    SD83      	
3:6:1F D9F:10 4777         ldp   0         	
3:6:3F DBF:80 4778         br    PLAYBUF      	
              4779 	
              4780 ;********************************************************************************	
              4781 ; PLYATTK - Play the Dark Tower attack song	
              4782 ;********************************************************************************	
3:6:3E DBE:2B 4783 PLYATTK ldx   6         	
3:6:3D DBD:40 4784         tcy   0         ; 6/0 - 2 8 2 7 2 6 2 7 2 8	
3:6:3B DBB:64 4785         tcmiy 2         	
3:6:37 DB7:61 4786         tcmiy 8         	
3:6:2F DAF:64 4787         tcmiy 2         	
3:6:1E D9E:6E 4788         tcmiy 7         	
3:6:3C DBC:64 4789         tcmiy 2         	
3:6:39 DB9:66 4790         tcmiy 6         	
3:6:33 DB3:64 4791         tcmiy 2         	
3:6:27 DA7:6E 4792         tcmiy 7         	
3:6:0E D8E:64 4793         tcmiy 2         	
3:6:1D D9D:61 4794         tcmiy 8         	
3:6:3A DBA:2F 4795         ldx   7         	
3:6:35 DB5:40 4796         tcy   0         ; 7/0 - 1 8 1 10 1 11 1 10 1 8	
3:6:2B DAB:68 4797         tcmiy 1         	
3:6:16 D96:61 4798         tcmiy 8         	
3:6:2C DAC:68 4799         tcmiy 1         	
3:6:18 D98:65 4800         tcmiy 10        	
3:6:30 DB0:68 4801         tcmiy 1         	
3:6:21 DA1:6D 4802         tcmiy 11        	
3:6:02 D82:68 4803         tcmiy 1         	
3:6:05 D85:65 4804         tcmiy 10        	
3:6:0B D8B:68 4805         tcmiy 1         	
3:6:17 D97:61 4806         tcmiy 8         	
3:6:2E DAE:29 4807         ldx   4         ; 4/0 - 0 2 0 2 0 2 0 2 0 2	
3:6:1C D9C:40 4808         tcy   0         	
3:6:38 DB8:60 4809 SDB8    tcmiy 0         	
3:6:31 DB1:64 4810         tcmiy 2         	
3:6:23 DA3:55 4811         ynec  10        	
3:6:06 D86:B8 4812         br    SDB8      	
3:6:0D D8D:2D 4813         ldx   5         ; 5/0 - 0 0 0 0 0 0 0 0 0 0	
3:6:1B D9B:40 4814         tcy   0         	
3:6:36 DB6:60 4815 SDB6    tcmiy 0         	
3:6:2D DAD:55 4816         ynec  10        	
3:6:1A D9A:B6 4817         br    SDB6      	
3:6:34 DB4:10 4818         ldp   0         	
3:6:29 DA9:C0 4819         call  PLAYBUF      	
              4820 	
3:6:12 D92:2B 4821         ldx   6         	
3:6:24 DA4:40 4822         tcy   0         ; 6/0 - 8 2 8 9 6 2 7	
3:6:08 D88:61 4823         tcmiy 8         	
3:6:11 D91:64 4824         tcmiy 2         	
3:6:22 DA2:61 4825         tcmiy 8         	
3:6:04 D84:69 4826         tcmiy 9         	
3:6:09 D89:66 4827         tcmiy 6         	
3:6:13 D93:64 4828         tcmiy 2         	
3:6:26 DA6:6E 4829         tcmiy 7         	
3:6:0C D8C:2F 4830         ldx   7         ; 7/0 - 0 8 1 8 2 11 1 10	
3:6:19 D99:40 4831         tcy   0         	
3:6:32 DB2:61 4832         tcmiy 8         	
3:6:25 DA5:68 4833         tcmiy 1         	
3:6:0A D8A:61 4834         tcmiy 8         	
3:6:15 D95:64 4835         tcmiy 2         	
3:6:2A DAA:6D 4836         tcmiy 11        	
3:6:14 D94:68 4837         tcmiy 1         	
3:6:28 DA8:65 4838         tcmiy 10        	
3:6:10 D90:1E 4839         ldp   7         	
3:6:20 DA0:80 4840         br    LDC0      	
              4841 	
              4842 ; *** Chapter 3 page 7	
              4843 	
3:7:00 DC0:29 4844 LDC0    ldx   4         ; 4/0 - 11 0 5 0 1 0 2	
3:7:01 DC1:40 4845         tcy   0         	
3:7:03 DC3:6D 4846         tcmiy 11        	
3:7:07 DC7:60 4847         tcmiy 0         	
3:7:0F DCF:6A 4848         tcmiy 5         	
3:7:1F DDF:60 4849         tcmiy 0         	
3:7:3F DFF:68 4850         tcmiy 1         	
3:7:3E DFE:60 4851         tcmiy 0         	
3:7:3D DFD:64 4852         tcmiy 2         	
3:7:3B DFB:2D 4853         ldx   5         ; 5/0 - 0 0 0 0 8 0 0	
3:7:37 DF7:40 4854         tcy   0         	
3:7:2F DEF:60 4855 SDEF    tcmiy 0         	
3:7:1E DDE:52 4856         ynec  4         	
3:7:3C DFC:AF 4857         br    SDEF      	
3:7:39 DF9:61 4858         tcmiy 8         	
3:7:33 DF3:60 4859         tcmiy 0         	
3:7:27 DE7:60 4860         tcmiy 0         	
3:7:0E DCE:10 4861         ldp   0         	
3:7:1D DDD:C0 4862         call  PLAYBUF      	
              4863 	
3:7:3A DFA:12 4864         ldp   4         	
3:7:35 DF5:8C 4865         br    LD0C      	
              4866 	
              4867 ;********************************************************************************	
              4868 ; PLYBUGL - Play bugle call for brigand attack	
              4869 ;********************************************************************************	
3:7:2B DEB:2B 4870 PLYBUGL ldx   6         	
3:7:16 DD6:40 4871         tcy   0         ; 6/0 - 1 3 2 1 3	
3:7:2C DEC:68 4872         tcmiy 1         	
3:7:18 DD8:6C 4873         tcmiy 3         	
3:7:30 DF0:64 4874         tcmiy 2         	
3:7:21 DE1:68 4875         tcmiy 1         	
3:7:02 DC2:6C 4876         tcmiy 3         	
3:7:05 DC5:2F 4877         ldx   7         	
3:7:0B DCB:40 4878         tcy   0         ; 7/0 - 14 3 0 14 3	
3:7:17 DD7:67 4879         tcmiy 14        	
3:7:2E DEE:6C 4880         tcmiy 3         	
3:7:1C DDC:60 4881         tcmiy 0         	
3:7:38 DF8:67 4882         tcmiy 14        	
3:7:31 DF1:6C 4883         tcmiy 3         	
3:7:23 DE3:29 4884         ldx   4         	
3:7:06 DC6:40 4885         tcy   0         ; 4/0 - 15 5 0 15 5	
3:7:0D DCD:6F 4886         tcmiy 15        	
3:7:1B DDB:6A 4887         tcmiy 5         	
3:7:36 DF6:60 4888         tcmiy 0         	
3:7:2D DED:6F 4889         tcmiy 15        	
3:7:1A DDA:6A 4890         tcmiy 5         	
3:7:34 DF4:2D 4891         ldx   5         	
3:7:29 DE9:40 4892         tcy   0         ; 5/0 - 10 0 0 10 0 	
3:7:12 DD2:65 4893         tcmiy 10        	
3:7:24 DE4:60 4894         tcmiy 0         	
3:7:08 DC8:60 4895         tcmiy 0         	
3:7:11 DD1:65 4896         tcmiy 10        	
3:7:22 DE2:60 4897         tcmiy 0         	
3:7:04 DC4:10 4898         ldp   0         	
3:7:09 DC9:C0 4899         call  PLAYBUF      	
3:7:13 DD3:12 4900         ldp   4         	
3:7:26 DE6:8C 4901         br    LD0C      	
              4902 	
              4903 ;********************************************************************************	
              4904 ; PLYWINR - Play low/high tones when player wins a round against Brigands	
              4905 ;********************************************************************************	
3:7:0C DCC:2B 4906 PLYWINR ldx   6         	
3:7:19 DD9:40 4907         tcy   0         ; 6/0 - 4 6	
3:7:32 DF2:62 4908         tcmiy 4         	
3:7:25 DE5:66 4909         tcmiy 6         	
3:7:0A DCA:2F 4910         ldx   7         	
3:7:15 DD5:40 4911         tcy   0         ; 7/0 - 5 12	
3:7:2A DEA:6A 4912         tcmiy 5         	
3:7:14 DD4:63 4913         tcmiy 12        	
3:7:28 DE8:29 4914         ldx   4         	
3:7:10 DD0:11 4915         ldp   8         	
3:7:20 DE0:80 4916         br    LE00      	
              4917 	
              4918 ; *** Chapter 3 page 8	
              4919 	
3:8:00 E00:40 4920 LE00    tcy   0         ; 4/0 - 11 5	
3:8:01 E01:6D 4921         tcmiy 11        	
3:8:03 E03:6A 4922         tcmiy 5         	
3:8:07 E07:2D 4923         ldx   5         	
3:8:0F E0F:40 4924         tcy   0         ; 5/0 - 0 0 0	
3:8:1F E1F:60 4925         tcmiy 0         	
3:8:3F E3F:60 4926         tcmiy 0         	
3:8:3E E3E:10 4927         ldp   0         	
3:8:3D E3D:C0 4928         call  PLAYBUF      	
3:8:3B E3B:12 4929         ldp   4         	
3:8:37 E37:8C 4930         br    LD0C      	
              4931 	
              4932 ;********************************************************************************	
              4933 ; PLYLOSR - Play high/low tones when player loses a round against Brigands	
              4934 ;********************************************************************************	
3:8:2F E2F:2B 4935 PLYLOSR ldx   6         	
3:8:1E E1E:40 4936         tcy   0         ; 6/0 - 9 6	
3:8:3C E3C:69 4937         tcmiy 9         	
3:8:39 E39:66 4938         tcmiy 6         	
3:8:33 E33:2F 4939         ldx   7         	
3:8:27 E27:40 4940         tcy   0         ; 7/0 - 7 11	
3:8:0E E0E:6E 4941         tcmiy 7         	
3:8:1D E1D:6D 4942         tcmiy 11        	
3:8:3A E3A:29 4943         ldx   4         	
3:8:35 E35:40 4944         tcy   0         ; 4/0 - 8 10	
3:8:2B E2B:61 4945         tcmiy 8         	
3:8:16 E16:65 4946         tcmiy 10        	
3:8:2C E2C:2D 4947         ldx   5         	
3:8:18 E18:40 4948         tcy   0         ; 5/0 - 0 0	
3:8:30 E30:60 4949         tcmiy 0         	
3:8:21 E21:60 4950         tcmiy 0         	
3:8:02 E02:10 4951         ldp   0         	
3:8:05 E05:C0 4952         call  PLAYBUF      	
3:8:0B E0B:12 4953         ldp   4         	
3:8:17 E17:8C 4954         br    LD0C      	
              4955 	
              4956 ;********************************************************************************	
              4957 ; PLYFRNT - Play the Frontier sound	
              4958 ;********************************************************************************	
3:8:2E E2E:E3 4959 PLYFRNT call  SE23      	
3:8:1C E1C:E3 4960         call  SE23      	
3:8:38 E38:12 4961         ldp   4         	
3:8:31 E31:8C 4962         br    LD0C      	
              4963 	
3:8:23 E23:2B 4964 SE23    ldx   6         	
3:8:06 E06:40 4965         tcy   0         ; 6/0 - 1 2 3 1 2 3	
3:8:0D E0D:68 4966 SE0D    tcmiy 1         	
3:8:1B E1B:64 4967         tcmiy 2         	
3:8:36 E36:6C 4968         tcmiy 3         	
3:8:2D E2D:56 4969         ynec  6         	
3:8:1A E1A:8D 4970         br    SE0D      	
3:8:34 E34:2F 4971         ldx   7         	
3:8:29 E29:40 4972         tcy   0         ; 7/0 - 13 10 0 13 10 0 	
3:8:12 E12:6B 4973 SE12    tcmiy 13        	
3:8:24 E24:65 4974         tcmiy 10        	
3:8:08 E08:60 4975         tcmiy 0         	
3:8:11 E11:56 4976         ynec  6         	
3:8:22 E22:92 4977         br    SE12      	
3:8:04 E04:29 4978         ldx   4         	
3:8:09 E09:40 4979         tcy   0         ; 4/0 - 3 3 3 3 3 3	
3:8:13 E13:6C 4980 SE13    tcmiy 3         	
3:8:26 E26:56 4981         ynec  6         	
3:8:0C E0C:93 4982         br    SE13      	
3:8:19 E19:2D 4983         ldx   5         	
3:8:32 E32:40 4984         tcy   0         ; 5/0 - 0 0 0 0 0 0	
3:8:25 E25:60 4985 SE25    tcmiy 0         	
3:8:0A E0A:56 4986         ynec  6         	
3:8:15 E15:A5 4987         br    SE25      	
3:8:2A E2A:10 4988         ldp   0         	
3:8:14 E14:80 4989         br    PLAYBUF      	
              4990 	
3:8:28 E28:08 4991         tka             	
3:8:10 E10:27 4992         tam             	
3:8:20 E20:05 4993         iyc             	
              4994 	
              4995 ; *** Chapter 3 page 9	
              4996 	
              4997 	
              4998 ;********************************************************************************	
              4999 ; PLYDRGN - Play the dragon siren	
              5000 ;********************************************************************************	
3:9:00 E40:FE 5001 PLYDRGN call  SE7E      	
3:9:01 E41:FE 5002         call  SE7E      	
3:9:03 E43:FE 5003         call  SE7E      	
3:9:07 E47:FE 5004         call  SE7E      	
3:9:0F E4F:FE 5005         call  SE7E      	
3:9:1F E5F:FE 5006         call  SE7E      	
3:9:3F E7F:FE 5007         call  SE7E      	
              5008 	
3:9:3E E7E:2B 5009 SE7E    ldx   6         	
3:9:3D E7D:40 5010         tcy   0         ; 6/0 - 1 0 1 0 1 0 1 0 1 0	
3:9:3B E7B:68 5011 SE7B    tcmiy 1         	
3:9:37 E77:60 5012         tcmiy 0         	
3:9:2F E6F:55 5013         ynec  10        	
3:9:1E E5E:BB 5014         br    SE7B      	
3:9:3C E7C:2F 5015         ldx   7         ; 7/0 - 3 5 3 5 3 5 3 5 3 5	
3:9:39 E79:40 5016         tcy   0         	
3:9:33 E73:6C 5017 SE73    tcmiy 3         	
3:9:27 E67:6A 5018         tcmiy 5         	
3:9:0E E4E:55 5019         ynec  10        	
3:9:1D E5D:B3 5020         br    SE73      	
3:9:3A E7A:29 5021         ldx   4         ; 4/0 - 1 0 1 0 1 0 1 0 1 0	
3:9:35 E75:40 5022         tcy   0         	
3:9:2B E6B:68 5023 SE6B    tcmiy 1         	
3:9:16 E56:60 5024         tcmiy 0         	
3:9:2C E6C:55 5025         ynec  10        	
3:9:18 E58:AB 5026         br    SE6B      	
3:9:30 E70:2D 5027         ldx   5         ; 5/0 - 6 8 6 8 6 8 6 8 6 8	
3:9:21 E61:40 5028         tcy   0         	
3:9:02 E42:66 5029 SE42    tcmiy 6         	
3:9:05 E45:61 5030         tcmiy 8         	
3:9:0B E4B:55 5031         ynec  10        	
3:9:17 E57:82 5032         br    SE42      	
3:9:2E E6E:10 5033         ldp   0         	
3:9:1C E5C:80 5034         br    PLAYBUF      	
              5035 	
              5036 ;********************************************************************************	
              5037 ; PLYDSWD - Sword defense against Dragon sound	
              5038 ;********************************************************************************	
3:9:38 E78:15 5039 PLYDSWD ldp   10        	
3:9:31 E71:C0 5040         call  LE80      	
3:9:23 E63:15 5041         ldp   10        	
3:9:06 E46:DB 5042         call  LE9B      	
              5043 ;	
              5044 ; Sword defense part three	
              5045 ;	
3:9:0D E4D:2B 5046         ldx   6         	
3:9:1B E5B:40 5047         tcy   0         ; 6/0 - 13 12 12 11 11	
3:9:36 E76:6B 5048         tcmiy 13        	
3:9:2D E6D:63 5049         tcmiy 12        	
3:9:1A E5A:63 5050         tcmiy 12        	
3:9:34 E74:6D 5051         tcmiy 11        	
3:9:29 E69:6D 5052         tcmiy 11        	
3:9:12 E52:2F 5053         ldx   7         	
3:9:24 E64:40 5054         tcy   0         ; 7/0 - 1 7 2 9 4	
3:9:08 E48:68 5055         tcmiy 1         	
3:9:11 E51:6E 5056         tcmiy 7         	
3:9:22 E62:64 5057         tcmiy 2         	
3:9:04 E44:69 5058         tcmiy 9         	
3:9:09 E49:62 5059         tcmiy 4         	
3:9:13 E53:29 5060         ldx   4         	
3:9:26 E66:40 5061         tcy   0         ; 4/0 - 9 1 1 1 1	
3:9:0C E4C:69 5062         tcmiy 9         	
3:9:19 E59:68 5063 SE59    tcmiy 1         	
3:9:32 E72:5A 5064         ynec  5         	
3:9:25 E65:99 5065         br    SE59      	
3:9:0A E4A:2D 5066         ldx   5         	
3:9:15 E55:40 5067         tcy   0         ; 5/0 - 8 8 8 8 8	
3:9:2A E6A:61 5068 SE6A    tcmiy 8         	
3:9:14 E54:5A 5069         ynec  5         	
3:9:28 E68:AA 5070         br    SE6A      	
3:9:10 E50:10 5071         ldp   0         	
3:9:20 E60:80 5072         br    PLAYBUF      	
              5073 	
              5074 ; *** Chapter 3 page 10	
              5075 	
              5076 ;	
              5077 ; Sword defense part one	
              5078 ;	
3:A:00 E80:2B 5079 LE80    ldx   6         	
3:A:01 E81:40 5080         tcy   0         ; 6/0 - 6 5 5 4 4 3 3 3 2 2	
3:A:03 E83:66 5081         tcmiy 6         	
3:A:07 E87:6A 5082         tcmiy 5         	
3:A:0F E8F:6A 5083         tcmiy 5         	
3:A:1F E9F:62 5084         tcmiy 4         	
3:A:3F EBF:62 5085         tcmiy 4         	
3:A:3E EBE:6C 5086         tcmiy 3         	
3:A:3D EBD:6C 5087         tcmiy 3         	
3:A:3B EBB:6C 5088         tcmiy 3         	
3:A:37 EB7:64 5089         tcmiy 2         	
3:A:2F EAF:64 5090         tcmiy 2         	
3:A:1E E9E:2F 5091         ldx   7         	
3:A:3C EBC:40 5092         tcy   0         ; 7/0 - 1 13 2 14 4 15 5 0 7 2	
3:A:39 EB9:68 5093         tcmiy 1         	
3:A:33 EB3:6B 5094         tcmiy 13        	
3:A:27 EA7:64 5095         tcmiy 2         	
3:A:0E E8E:67 5096         tcmiy 14        	
3:A:1D E9D:62 5097         tcmiy 4         	
3:A:3A EBA:6F 5098         tcmiy 15        	
3:A:35 EB5:6A 5099         tcmiy 5         	
3:A:2B EAB:60 5100         tcmiy 0         	
3:A:16 E96:6E 5101         tcmiy 7         	
3:A:2C EAC:64 5102         tcmiy 2         	
3:A:18 E98:29 5103 SE98    ldx   4         	
3:A:30 EB0:40 5104         tcy   0         ; 4/0 - 0 1 0 1 0 1 0 1 0 1	
3:A:21 EA1:60 5105 SEA1    tcmiy 0         	
3:A:02 E82:68 5106         tcmiy 1         	
3:A:05 E85:55 5107         ynec  10        	
3:A:0B E8B:A1 5108         br    SEA1      	
3:A:17 E97:2D 5109         ldx   5         	
3:A:2E EAE:40 5110         tcy   0         ; 5/0 - 8 6 8 6 8 6 8 6 8 6	
3:A:1C E9C:61 5111 SE9C    tcmiy 8         	
3:A:38 EB8:66 5112         tcmiy 6         	
3:A:31 EB1:55 5113         ynec  10        	
3:A:23 EA3:9C 5114         br    SE9C      	
3:A:06 E86:10 5115         ldp   0         	
3:A:0D E8D:80 5116         br    PLAYBUF      	
              5117 ;	
              5118 ; Sword defense part two	
              5119 ;	
3:A:1B E9B:2B 5120 LE9B    ldx   6         	
3:A:36 EB6:40 5121         tcy   0         ; 6/0 - 10 10 9 9 8 8 7 7 6 6	
3:A:2D EAD:65 5122         tcmiy 10        	
3:A:1A E9A:65 5123         tcmiy 10        	
3:A:34 EB4:69 5124         tcmiy 9         	
3:A:29 EA9:69 5125         tcmiy 9         	
3:A:12 E92:61 5126         tcmiy 8         	
3:A:24 EA4:61 5127         tcmiy 8         	
3:A:08 E88:6E 5128         tcmiy 7         	
3:A:11 E91:6E 5129         tcmiy 7         	
3:A:22 EA2:66 5130         tcmiy 6         	
3:A:04 E84:66 5131         tcmiy 6         	
3:A:09 E89:2F 5132         ldx   7         	
3:A:13 E93:40 5133         tcy   0         ; 7/0 - 10 5 12 7 13 8 15 10 15 11	
3:A:26 EA6:65 5134         tcmiy 10        	
3:A:0C E8C:6A 5135         tcmiy 5         	
3:A:19 E99:63 5136         tcmiy 12        	
3:A:32 EB2:6E 5137         tcmiy 7         	
3:A:25 EA5:6B 5138         tcmiy 13        	
3:A:0A E8A:61 5139         tcmiy 8         	
3:A:15 E95:6F 5140         tcmiy 15        	
3:A:2A EAA:65 5141         tcmiy 10        	
3:A:14 E94:6F 5142         tcmiy 15        	
3:A:28 EA8:6D 5143         tcmiy 11        	
3:A:10 E90:98 5144         br    SE98      	
3:A:20 EA0:00 5145         mnea            	
              5146 	
              5147 ; *** Chapter 3 page 11	
              5148 	
              5149 	
              5150 ;********************************************************************************	
              5151 ; PLYFAIL - Play failure riff.  Bazaar Closed and Lost events	
              5152 ;********************************************************************************	
3:B:00 EC0:2B 5153 PLYFAIL ldx   6         	
3:B:01 EC1:40 5154         tcy   0         ; 6/0 - 10 9 8 7 6 5 4 3 2	
3:B:03 EC3:65 5155         tcmiy 10        	
3:B:07 EC7:69 5156         tcmiy 9         	
3:B:0F ECF:61 5157         tcmiy 8         	
3:B:1F EDF:6E 5158         tcmiy 7         	
3:B:3F EFF:66 5159         tcmiy 6         	
3:B:3E EFE:6A 5160         tcmiy 5         	
3:B:3D EFD:62 5161         tcmiy 4         	
3:B:3B EFB:6C 5162         tcmiy 3         	
3:B:37 EF7:64 5163         tcmiy 2         	
3:B:2F EEF:2F 5164         ldx   7         	
3:B:1E EDE:60 5165         tcmiy 0         ; 7/0 - 0 0 0 0 0 0 0 0 0	
3:B:3C EFC:60 5166 SEFC    tcmiy 0         	
3:B:39 EF9:59 5167         ynec  9         	
3:B:33 EF3:BC 5168         br    SEFC      	
3:B:27 EE7:29 5169         ldx   4         	
3:B:0E ECE:40 5170         tcy   0         ; 4/0 - 4 4 4 4 4 4 4 4 4	
3:B:1D EDD:62 5171 SEDD    tcmiy 4         	
3:B:3A EFA:59 5172         ynec  9         	
3:B:35 EF5:9D 5173         br    SEDD      	
3:B:2B EEB:2D 5174         ldx   5         	
3:B:16 ED6:40 5175         tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0	
3:B:2C EEC:60 5176 SEEC    tcmiy 0         	
3:B:18 ED8:59 5177         ynec  9         	
3:B:30 EF0:AC 5178         br    SEEC      	
3:B:21 EE1:10 5179         ldp   0         	
3:B:02 EC2:80 5180         br    PLAYBUF      	
              5181 	
              5182 ;********************************************************************************	
              5183 ; PLYDETH - Play the death march (Plague, starvation, etc.)	
              5184 ;********************************************************************************	
3:B:05 EC5:2B 5185 PLYDETH ldx   6         	
3:B:0B ECB:40 5186         tcy   0         ; 6/0 - 0 9 0 9 0 9 0 9	
3:B:17 ED7:60 5187 SED7    tcmiy 0         	
3:B:2E EEE:69 5188         tcmiy 9         	
3:B:1C EDC:51 5189         ynec  8         	
3:B:38 EF8:97 5190         br    SED7      	
3:B:31 EF1:2F 5191         ldx   7         	
3:B:23 EE3:40 5192         tcy   0         ; 7/0 - 12 9 12 9 12 9 12 9 	
3:B:06 EC6:63 5193 SEC6    tcmiy 12        	
3:B:0D ECD:69 5194         tcmiy 9         	
3:B:1B EDB:51 5195         ynec  8         	
3:B:36 EF6:86 5196         br    SEC6      	
3:B:2D EED:29 5197         ldx   4         	
3:B:1A EDA:40 5198         tcy   0         ; 4/0 - 0 6 0 1 0 3 0 3	
3:B:34 EF4:60 5199         tcmiy 0         	
3:B:29 EE9:66 5200         tcmiy 6         	
3:B:12 ED2:60 5201         tcmiy 0         	
3:B:24 EE4:68 5202         tcmiy 1         	
3:B:08 EC8:60 5203         tcmiy 0         	
3:B:11 ED1:6C 5204         tcmiy 3         	
3:B:22 EE2:60 5205         tcmiy 0         	
3:B:04 EC4:6C 5206         tcmiy 3         	
3:B:09 EC9:2D 5207         ldx   5         	
3:B:13 ED3:40 5208         tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0	
3:B:26 EE6:60 5209 SEE6    tcmiy 0         	
3:B:0C ECC:51 5210         ynec  8         	
3:B:19 ED9:A6 5211         br    SEE6      	
3:B:32 EF2:10 5212         ldp   0         	
3:B:25 EE5:C0 5213         call  PLAYBUF      	
              5214 	
3:B:0A ECA:2B 5215         ldx   6         	
3:B:15 ED5:40 5216         tcy   0         ; 6/0 - 9 9 9 0 9 8 0 8 7	
3:B:2A EEA:69 5217         tcmiy 9         	
3:B:14 ED4:69 5218         tcmiy 9         	
3:B:28 EE8:69 5219         tcmiy 9         	
3:B:10 ED0:13 5220         ldp   12        	
3:B:20 EE0:80 5221         br    LF00      	
              5222 	
              5223 ; *** Chapter 3 page 12	
              5224 	
3:C:00 F00:60 5225 LF00    tcmiy 0         	
3:C:01 F01:69 5226         tcmiy 9         	
3:C:03 F03:61 5227         tcmiy 8         	
3:C:07 F07:60 5228         tcmiy 0         	
3:C:0F F0F:61 5229         tcmiy 8         	
3:C:1F F1F:6E 5230         tcmiy 7         	
3:C:3F F3F:2F 5231         ldx   7         	
3:C:3E F3E:40 5232         tcy   0         ; 7/0 - 9 14 9 12 9 2 12 2 12	
3:C:3D F3D:69 5233         tcmiy 9         	
3:C:3B F3B:67 5234         tcmiy 14        	
3:C:37 F37:69 5235         tcmiy 9         	
3:C:2F F2F:63 5236         tcmiy 12        	
3:C:1E F1E:69 5237         tcmiy 9         	
3:C:3C F3C:64 5238         tcmiy 2         	
3:C:39 F39:63 5239         tcmiy 12        	
3:C:33 F33:64 5240         tcmiy 2         	
3:C:27 F27:63 5241         tcmiy 12        	
3:C:0E F0E:29 5242         ldx   4         	
3:C:1D F1D:40 5243         tcy   0         ; 4/0 - 3 3 3 0 3 3 0 3 3	
3:C:3A F3A:6C 5244         tcmiy 3         	
3:C:35 F35:6C 5245         tcmiy 3         	
3:C:2B F2B:6C 5246         tcmiy 3         	
3:C:16 F16:60 5247         tcmiy 0         	
3:C:2C F2C:6C 5248         tcmiy 3         	
3:C:18 F18:6C 5249         tcmiy 3         	
3:C:30 F30:60 5250         tcmiy 0         	
3:C:21 F21:6C 5251         tcmiy 3         	
3:C:02 F02:6C 5252         tcmiy 3         	
3:C:05 F05:2D 5253         ldx   5         	
3:C:0B F0B:40 5254         tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0	
3:C:17 F17:60 5255 SF17    tcmiy 0         	
3:C:2E F2E:59 5256         ynec  9         	
3:C:1C F1C:97 5257         br    SF17      	
3:C:38 F38:10 5258         ldp   0         	
3:C:31 F31:C0 5259         call  PLAYBUF      	
              5260 	
3:C:23 F23:12 5261         ldp   4         	
3:C:06 F06:8C 5262         br    LD0C      	
              5263 	
              5264 ;********************************************************************************	
              5265 ; PLYPEGA - Play the Pegasus found sound	
              5266 ;********************************************************************************	
3:C:0D F0D:2B 5267 PLYPEGA ldx   6         	
3:C:1B F1B:40 5268         tcy   0         ; 6/0 - 1 2 2 3 3 4 5 5 6 7	
3:C:36 F36:68 5269         tcmiy 1         	
3:C:2D F2D:64 5270         tcmiy 2         	
3:C:1A F1A:64 5271         tcmiy 2         	
3:C:34 F34:6C 5272         tcmiy 3         	
3:C:29 F29:6C 5273         tcmiy 3         	
3:C:12 F12:62 5274         tcmiy 4         	
3:C:24 F24:6A 5275         tcmiy 5         	
3:C:08 F08:6A 5276         tcmiy 5         	
3:C:11 F11:66 5277         tcmiy 6         	
3:C:22 F22:6E 5278         tcmiy 7         	
3:C:04 F04:2F 5279         ldx   7         	
3:C:09 F09:40 5280         tcy   0         ; 7/0 - 3 1 8 6 13 11 1 15 6 4	
3:C:13 F13:6C 5281         tcmiy 3         	
3:C:26 F26:68 5282         tcmiy 1         	
3:C:0C F0C:61 5283         tcmiy 8         	
3:C:19 F19:66 5284         tcmiy 6         	
3:C:32 F32:6B 5285         tcmiy 13        	
3:C:25 F25:6D 5286         tcmiy 11        	
3:C:0A F0A:68 5287         tcmiy 1         	
3:C:15 F15:6F 5288         tcmiy 15        	
3:C:2A F2A:66 5289         tcmiy 6         	
3:C:14 F14:62 5290         tcmiy 4         	
3:C:28 F28:29 5291         ldx   4         	
3:C:10 F10:1B 5292         ldp   13        	
3:C:20 F20:80 5293         br    LF40      	
              5294 	
              5295 ; *** Chapter 3 page 13	
              5296 	
3:D:00 F40:40 5297 LF40    tcy   0         ; 4/0 - 3 3 2 2 2 1 1 0 0 0	
3:D:01 F41:6C 5298         tcmiy 3         	
3:D:03 F43:6C 5299         tcmiy 3         	
3:D:07 F47:64 5300         tcmiy 2         	
3:D:0F F4F:64 5301         tcmiy 2         	
3:D:1F F5F:64 5302         tcmiy 2         	
3:D:3F F7F:68 5303         tcmiy 1         	
3:D:3E F7E:68 5304         tcmiy 1         	
3:D:3D F7D:60 5305         tcmiy 0         	
3:D:3B F7B:60 5306         tcmiy 0         	
3:D:37 F77:60 5307         tcmiy 0         	
3:D:2F F6F:2D 5308         ldx   5         	
3:D:1E F5E:40 5309         tcy   0         ; 5/0 - 8 0 13 5 2 10 6 15 11 4	
3:D:3C F7C:61 5310         tcmiy 8         	
3:D:39 F79:60 5311         tcmiy 0         	
3:D:33 F73:6B 5312         tcmiy 13        	
3:D:27 F67:6A 5313         tcmiy 5         	
3:D:0E F4E:64 5314         tcmiy 2         	
3:D:1D F5D:65 5315         tcmiy 10        	
3:D:3A F7A:66 5316         tcmiy 6         	
3:D:35 F75:6F 5317         tcmiy 15        	
3:D:2B F6B:6D 5318         tcmiy 11        	
3:D:16 F56:62 5319         tcmiy 4         	
3:D:2C F6C:10 5320         ldp   0         	
3:D:18 F58:C0 5321         call  PLAYBUF      	
              5322 	
3:D:30 F70:2B 5323         ldx   6         	
3:D:21 F61:40 5324         tcy   0         ; 6/0 - 0 0 0 0	
3:D:02 F42:60 5325 SF42    tcmiy 0         	
3:D:05 F45:52 5326         ynec  4         	
3:D:0B F4B:82 5327         br    SF42      	
3:D:17 F57:2F 5328         ldx   7         	
3:D:2E F6E:40 5329         tcy   0         ; 7/0 - 0 2 3 13	
3:D:1C F5C:60 5330         tcmiy 0         	
3:D:38 F78:64 5331         tcmiy 2         	
3:D:31 F71:6C 5332         tcmiy 3         	
3:D:23 F63:6B 5333         tcmiy 13        	
3:D:06 F46:29 5334         ldx   4         	
3:D:0D F4D:40 5335         tcy   0         ; 4/0 - 4 4 4 3	
3:D:1B F5B:62 5336         tcmiy 4         	
3:D:36 F76:62 5337         tcmiy 4         	
3:D:2D F6D:62 5338         tcmiy 4         	
3:D:1A F5A:6C 5339         tcmiy 3         	
3:D:34 F74:2D 5340         ldx   5         	
3:D:29 F69:40 5341         tcy   0         ; 5/0 - 14 7 3 12	
3:D:12 F52:67 5342         tcmiy 14        	
3:D:24 F64:6E 5343         tcmiy 7         	
3:D:08 F48:6C 5344         tcmiy 3         	
3:D:11 F51:63 5345         tcmiy 12        	
3:D:22 F62:10 5346         ldp   0         	
3:D:04 F44:80 5347         br    PLAYBUF      	
              5348 	
              5349 ;********************************************************************************	
              5350 ; PLYBEEP - Play beep when prompting user and during startup	
              5351 ;********************************************************************************	
3:D:09 F49:2F 5352 PLYBEEP ldx   7         ; 7/0 - 0	
3:D:13 F53:40 5353         tcy   0         	
3:D:26 F66:60 5354         tcmiy 0         	
3:D:0C F4C:2B 5355         ldx   6         ; 6/0 - 2	
3:D:19 F59:40 5356         tcy   0         	
3:D:32 F72:64 5357         tcmiy 2         	
3:D:25 F65:2D 5358         ldx   5         ; 5/0 - 0	
3:D:0A F4A:40 5359         tcy   0         	
3:D:15 F55:60 5360         tcmiy 0         	
3:D:2A F6A:29 5361         ldx   4         ; 4/0 - 2	
3:D:14 F54:40 5362         tcy   0         	
3:D:28 F68:64 5363         tcmiy 2         	
3:D:10 F50:10 5364         ldp   0         	
3:D:20 F60:80 5365         br    PLAYBUF      	
              5366 	
              5367 	
              5368 ; *** Chapter 3 page 14	
              5369 	
3:E:00 F80:1B 5370 LF80    ldp   13        	
3:E:01 F81:89 5371         br    PLYBEEP   	
              5372 	
              5373 ;********************************************************************************	
              5374 ; PLWFOOD - Play the Low Food notification at the beginning of a turn	
              5375 ;********************************************************************************	
3:E:03 F83:FE 5376 PLWFOOD call  SFBE      	
3:E:07 F87:FE 5377         call  SFBE      	
3:E:0F F8F:FE 5378         call  SFBE      	
3:E:1F F9F:12 5379         ldp   4         	
3:E:3F FBF:8C 5380         br    LD0C      	
              5381 ;	
              5382 ; One of the three riffs for the low food warning (called three times)	
              5383 ;	
3:E:3E FBE:2B 5384 SFBE    ldx   6         	
3:E:3D FBD:40 5385         tcy   0         ; 6/0 - 0 1 2 3 4 4 5 6 7 8	
3:E:3B FBB:60 5386         tcmiy 0         	
3:E:37 FB7:68 5387         tcmiy 1         	
3:E:2F FAF:64 5388         tcmiy 2         	
3:E:1E F9E:6C 5389         tcmiy 3         	
3:E:3C FBC:62 5390         tcmiy 4         	
3:E:39 FB9:62 5391         tcmiy 4         	
3:E:33 FB3:6A 5392         tcmiy 5         	
3:E:27 FA7:66 5393         tcmiy 6         	
3:E:0E F8E:6E 5394         tcmiy 7         	
3:E:1D F9D:61 5395         tcmiy 8         	
3:E:3A FBA:2F 5396         ldx   7         	
3:E:35 FB5:40 5397         tcy   0         ; 7/0 - 7 5 4 2 1 15 15 13 12 10	
3:E:2B FAB:6E 5398         tcmiy 7         	
3:E:16 F96:6A 5399         tcmiy 5         	
3:E:2C FAC:62 5400         tcmiy 4         	
3:E:18 F98:64 5401         tcmiy 2         	
3:E:30 FB0:68 5402         tcmiy 1         	
3:E:21 FA1:6F 5403         tcmiy 15        	
3:E:02 F82:6F 5404         tcmiy 15        	
3:E:05 F85:6B 5405         tcmiy 13        	
3:E:0B F8B:63 5406         tcmiy 12        	
3:E:17 F97:65 5407         tcmiy 10        	
3:E:2E FAE:29 5408         ldx   4         	
3:E:1C F9C:40 5409         tcy   0         ; 4/0 - 1 1 1 1 1 1 1 1 1 1	
3:E:38 FB8:68 5410 SFB8    tcmiy 1         	
3:E:31 FB1:55 5411         ynec  10        	
3:E:23 FA3:B8 5412         br    SFB8      	
3:E:06 F86:2D 5413         ldx   5         	
3:E:0D F8D:40 5414         tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0 0 0	
3:E:1B F9B:60 5415 SF9B    tcmiy 0         	
3:E:36 FB6:55 5416         ynec  10        	
3:E:2D FAD:9B 5417         br    SF9B      	
3:E:1A F9A:10 5418         ldp   0         	
3:E:34 FB4:80 5419         br    PLAYBUF      	
              5420 	
              5421 ;********************************************************************************	
              5422 ; PLYCLR - Play the hi/lo siren when player presses Clear	
              5423 ;********************************************************************************	
3:E:29 FA9:2B 5424 PLYCLR  ldx   6         	
3:E:12 F92:40 5425         tcy   0         ; 6/0 - 1 3 1 3 1 3 1 3	
3:E:24 FA4:68 5426 SFA4    tcmiy 1         	
3:E:08 F88:6C 5427         tcmiy 3         	
3:E:11 F91:51 5428         ynec  8         	
3:E:22 FA2:A4 5429         br    SFA4      	
3:E:04 F84:2F 5430         ldx   7         	
3:E:09 F89:40 5431         tcy   0         ; 7/0 - 9 15 9 15 9 15 9 15	
3:E:13 F93:69 5432 SF93    tcmiy 9         	
3:E:26 FA6:6F 5433         tcmiy 15        	
3:E:0C F8C:51 5434         ynec  8         	
3:E:19 F99:93 5435         br    SF93      	
3:E:32 FB2:29 5436         ldx   4         	
3:E:25 FA5:40 5437         tcy   0         ; 4/0 - 10 5 10 5 10 5 10 5	
3:E:0A F8A:65 5438 SF8A    tcmiy 10        	
3:E:15 F95:6A 5439         tcmiy 5         	
3:E:2A FAA:51 5440         ynec  8         	
3:E:14 F94:8A 5441         br    SF8A      	
3:E:28 FA8:2D 5442         ldx   5         	
3:E:10 F90:1F 5443         ldp   15        	
3:E:20 FA0:80 5444         br    LFC0      	
              5445 	
              5446 ; *** Chapter 3 page 15	
              5447 	
3:F:00 FC0:40 5448 LFC0    tcy   0         ; 5/0 - 0 0 0 0 0 0 0 0	
3:F:01 FC1:60 5449 SFC1    tcmiy 0         	
3:F:03 FC3:51 5450         ynec  8         	
3:F:07 FC7:81 5451         br    SFC1      	
3:F:0F FCF:10 5452         ldp   0         	
3:F:1F FDF:80 5453         br    PLAYBUF      	
              5454 	
3:F:3F FFF:E5 5455 LFFF    call  SFE5      ; Copy 5 to 4 (Brigand count)	
3:F:3E FFE:18 5456         ldp   1         	
3:F:3D FFD:0B 5457         tpc             	
3:F:3B FFB:1D 5458         ldp   11        	
3:F:37 FF7:C0 5459         call  L6C0      ; Weighted scoring (same as Dragon losses)	
3:F:2F FEF:E6 5460         call  SFE6      ; ADDB10	
3:F:1E FDE:29 5461         ldx   4         	
3:F:3C FFC:68 5462         tcmiy 1         	
3:F:39 FF9:6E 5463         tcmiy 7         	
3:F:33 FF3:66 5464         tcmiy 6         	
3:F:27 FE7:E2 5465         call  SFE2      ; SUMB10	
3:F:0E FCE:10 5466         ldp   0         	
3:F:1D FDD:0B 5467         tpc             	
3:F:3A FFA:15 5468         ldp   10        	
3:F:35 FF5:CC 5469         call  L28C      ; Copy 5/2-0 to 7/2-0	
3:F:2B FEB:18 5470         ldp   1         	
3:F:16 FD6:0B 5471         tpc             	
3:F:2C FEC:17 5472         ldp   14        	
3:F:18 FD8:DB 5473         call  CPYTRNC   ; Pick up the turn count	
3:F:30 FF0:E5 5474         call  SFE5      ; Copy 5 to 4 (Turn count)	
3:F:21 FE1:18 5475         ldp   1         	
3:F:02 FC2:0B 5476         tpc             	
3:F:05 FC5:16 5477         ldp   6         	
3:F:0B FCB:F2 5478         call  CPY2TO5   ; Save current player Warrior count	
3:F:17 FD7:E6 5479         call  SFE6      ; Add 4 to 5	
3:F:2E FEE:E5 5480         call  SFE5      ; Copy 5 to 4	
3:F:1C FDC:E2 5481         call  SFE2      ; Add 4 again	
3:F:38 FF8:E5 5482         call  SFE5      ; Copy 5 to 4	
3:F:31 FF1:E2 5483         call  SFE2      ; Add 4 again	
3:F:23 FE3:E5 5484         call  SFE5      ; Copy 5 to 4	
3:F:06 FC6:10 5485         ldp   0         	
3:F:0D FCD:0B 5486         tpc             	
3:F:1B FDB:1D 5487         ldp   11        	
3:F:36 FF6:F3 5488         call  L2F3      ; Copy 7/2-0 to 5/2-0	
3:F:2D FED:10 5489         ldp   0         	
3:F:1A FDA:0B 5490         tpc             	
3:F:34 FF4:13 5491         ldp   12        	
3:F:29 FE9:FF 5492         call  L33F      ; Subtract 4 from 5	
3:F:12 FD2:14 5493         ldp   2         	
3:F:24 FE4:0B 5494         tpc             	
3:F:08 FC8:17 5495         ldp   14        	
3:F:11 FD1:89 5496         br    LB89      ; Update display with score and end game	
              5497 	
3:F:22 FE2:10 5498 SFE2    ldp   0         	
3:F:04 FC4:0B 5499         tpc             	
3:F:09 FC9:12 5500         ldp   4         	
3:F:13 FD3:BF 5501         br    SUMB10    	
3:F:26 FE6:10 5502 SFE6    ldp   0         	
3:F:0C FCC:0B 5503         tpc             	
3:F:19 FD9:12 5504         ldp   4         	
3:F:32 FF2:80 5505         br    AD2B10    	
3:F:25 FE5:18 5506 SFE5    ldp   1         	
3:F:0A FCA:0B 5507         tpc             	
3:F:15 FD5:13 5508         ldp   12        	
3:F:2A FEA:A7 5509         br    CPY5TO4   	
              5510 ;	
              5511 ; This code looks to be unused...  Odd.  There's also a chunk of code	
              5512 ; like this at S294.	
              5513 ;	
              5514 ; Values are 6A 25 80 94	
              5515 ;	
3:F:14 FD4:6A 5516 SFD4    tcmiy 5         	
3:F:28 FE8:25 5517         tamiyc          	
3:F:10 FD0:80 5518         br    LFC0      	
3:F:20 FE0:94 5519         br    SFD4      	

Cross-reference
---------------

LABEL    VALUE	- (DEF) REF(b = BR, c=CALL)
S000     0x0000	- (7) 36(b) 44(b)
S00A     0x000a	- (76) 70(b) 72(b)
S00F     0x000f	- (11) 48(b)
S011     0x0011	- (66) 60(b)
S018     0x0018	- (37) 35(b)
S01B     0x001b	- (57) 13(b)
S01C     0x001c	- (45) 38(b) 43(b)
S026     0x0026	- (71) 65(b)
S033     0x0033	- (28) 25(b)
S03D     0x003d	- (20) 75(b) 81(b) 822(b)
S03E     0x003e	- (14) 10(b)
ROTONE   0x0040	- (89) 29(c) 1386(c)
S04B     0x004b	- (121) 119(b)
DEBOUNC  0x004e	- (109) 101(b) 128(b)
S055     0x0055	- (155) 141(c) 144(c) 147(c)
S071     0x0071	- (126) 105(b)
S074     0x0074	- (138) 151(b) 316(b)
S075     0x0075	- (112) 113(b) 115(b)
S077     0x0077	- (99) 102(b)
S078     0x0078	- (125) 120(b)
S079     0x0079	- (103) 124(b)
S080     0x0080	- (169) 207(b)
S085     0x0085	- (209) 204(b)
S089     0x0089	- (235) 229(b) 250(b)
S08A     0x008a	- (243) 219(b) 228(b)
S091     0x0091	- (231) 223(b)
S099     0x0099	- (240) 233(b)
S09C     0x009c	- (214) 185(b)
S09F     0x009f	- (174) 172(b)
S0AA     0x00aa	- (246) 242(b)
READKBD  0x00ab	- (201) 718(b)
S0AE     0x00ae	- (213) 182(b)
S0B0     0x00b0	- (205) 203(b)
S0B1     0x00b1	- (216) 191(b) 211(b)
S0B8     0x00b8	- (215) 188(b)
RANDOM   0x00c0	- (282) 403(c) 426(c) 787(c) 1093(c) 2112(c) 2673(c) 4280(b)
S0C9     0x00c9	- (333) 290(b)
S0D5     0x00d5	- (342) 283(c) 285(c)
S0D6     0x00d6	- (304) 325(b)
S0E3     0x00e3	- (318) 301(b)
S0E7     0x00e7	- (298) 332(b)
S0E9     0x00e9	- (326) 294(b)
S0EF     0x00ef	- (293) 340(b)
AD2B10   0x0100	- (369) 413(c) 419(b) 435(c) 449(b) 1103(c) 2610(b) 3320(b) 5505(b)
L107     0x0107	- (372) 2085(c)
ADD16    0x0115	- (444) 1355(c) 1357(c)
S11D     0x011d	- (391) 384(b)
L129     0x0129	- (425) 2791(b)
S12B     0x012b	- (394) 390(b)
L130     0x0130	- (402) 1340(c)
S13A     0x013a	- (392) 386(b)
S13D     0x013d	- (380) 395(b)
SUMB10   0x013f	- (375) 2040(c) 2044(c) 3148(b) 5501(b)
DSPRSLT  0x0140	- (463) 2626(b) 3274(c) 3533(c) 4168(c)
S14C     0x014c	- (531) 529(b)
S152     0x0152	- (519) 504(b) 512(b)
S155     0x0155	- (537) 522(b) 530(b)
S157     0x0157	- (501) 485(b)
S173     0x0173	- (482) 466(b)
S176     0x0176	- (513) 511(b)
S180     0x0180	- (550) 542(b)
S18C     0x018c	- (616) 601(b) 609(b)
S19F     0x019f	- (555) 553(b)
S1A2     0x01a2	- (610) 608(b)
S1B0     0x01b0	- (580) 564(b)
S1B1     0x01b1	- (592) 590(b)
S1B6     0x01b6	- (598) 583(b) 591(b)
L1B7     0x01b7	- (561) 541(b) 554(b)
L1C0     0x01c0	- (633) 627(b)
S1C5     0x01c5	- (671) 664(b)
L1C6     0x01c6	- (694) 244(b)
S1CA     0x01ca	- (720) 704(c)
PROMPT   0x01cb	- (686) 1249(c) 1320(c) 1384(c) 1465(c) 1541(c) 2823(c) 3453(c) 3612(c) 3885(c) 4090(c)
L1D4     0x01d4	- (724) 160(b)
L1DF     0x01df	- (639) 620(b) 628(b)
L1F8     0x01f8	- (690) 3020(c)
S1F9     0x01f9	- (651) 649(b)
S1FA     0x01fa	- (661) 642(b) 650(b)
L200     0x0200	- (736) 761(b) 1498(c) 3762(b)
S205     0x0205	- (771) 774(b)
L20D     0x020d	- (788) 4285(b)
ROTDRUM  0x0215	- (817) 472(c) 491(c) 515(c) 533(c) 557(c) 570(c) 594(c) 612(c) 635(c) 653(c) 668(c) 1167(c) 1399(c) 2443(b) 3729(b)
S218     0x0218	- (763) 760(b)
S21B     0x021b	- (789) 792(b)
S21D     0x021d	- (756) 753(b)
RND0TO2  0x0223	- (786) 1228(c) 1233(c) 3589(c)
BUF2DSP  0x0224	- (800) 478(c) 497(c) 576(c) 1988(c) 3217(b)
S230     0x0230	- (768) 737(c) 738(c) 739(c) 741(c) 742(c) 743(c) 745(c) 746(c) 747(c)
S234     0x0234	- (793) 790(b)
LTTOPCL  0x0240	- (829) 535(c) 596(c) 1173(b) 2149(c) 3434(c)
L241     0x0241	- (830) 480(c) 1405(c) 4256(b)
S248     0x0248	- (900) 830(c) 838(c) 846(c)
CPYBRIG  0x0249	- (908) 3158(b) 3720(c)
LTMIDCL  0x024f	- (837) 559(c) 614(c) 655(c) 1175(b) 2142(c) 2336(c) 3398(c)
S25A     0x025a	- (892) 829(c) 837(c) 845(c)
L25F     0x025f	- (838) 499(c) 1407(c) 4260(b)
L267     0x0267	- (857) 2986(c) 3221(b)
S26C     0x026c	- (867) 873(b) 876(b)
S26F     0x026f	- (852) 832(b) 840(b)
L27B     0x027b	- (846) 578(c) 1409(c) 2978(c) 4275(b)
LTLWRCL  0x027d	- (845) 517(c) 637(c) 670(c) 1176(b) 2329(c)
REFRLED  0x0280	- (932) 695(c) 697(c) 699(c) 869(c) 1023(b)
L28C     0x028c	- (1008) 3770(b) 5469(c)
S294     0x0294	- (1021) 1024(b)
S299     0x0299	- (1009) 1013(b)
S29A     0x029a	- (990) 959(b) 967(b)
S2A1     0x02a1	- (971) 935(b) 961(b)
L2A2     0x02a2	- (1000) 238(b)
S2A9     0x02a9	- (992) 993(b) 995(b)
S2AB     0x02ab	- (963) 944(b) 947(b)
S2AE     0x02ae	- (976) 974(b)
S2B6     0x02b6	- (984) 982(b)
S2BA     0x02ba	- (960) 956(b)
L2C0     0x02c0	- (1032) 4227(b)
L2C3     0x02c3	- (1034) 4220(b)
S2C5     0x02c5	- (1070) 1068(b)
L2CF     0x02cf	- (1036) 4213(b)
L2D6     0x02d6	- (1061) 3753(b)
ROL5     0x02df	- (1038) 1032(c) 1033(c) 1034(c) 1035(c) 1036(c)
L2E5     0x02e5	- (1109) 1346(b)
S2E7     0x02e7	- (1051) 1055(b)
S2EA     0x02ea	- (1112) 
L2ED     0x02ed	- (1088) 3844(c)
S2EE     0x02ee	- (1073) 1072(c)
L2F3     0x02f3	- (1050) 3778(b) 5488(c)
S2F8     0x02f8	- (1075) 1078(b)
S2FD     0x02fd	- (1042) 1045(b)
SU2B10   0x0300	- (1136) 2618(b) 2950(c) 4051(b)
L307     0x0307	- (1139) 1945(c)
S309     0x0309	- (1197) 1204(b) 1288(b)
L30D     0x030d	- (1180) 3307(b)
L316     0x0316	- (1162) 3237(b)
S327     0x0327	- (1152) 1158(b)
S335     0x0335	- (1157) 1148(b)
S33D     0x033d	- (1144) 1153(b)
L33F     0x033f	- (1142) 3116(c) 5492(c)
L340     0x0340	- (1218) 1362(b)
S342     0x0342	- (1248) 1260(b) 1263(b)
S34D     0x034d	- (1258) 1256(b)
S36B     0x036b	- (1239) 1237(b)
L36C     0x036c	- (1244) 1210(b)
S36D     0x036d	- (1262) 1252(b)
L4INIT   0x0372	- (1280) 1338(b)
S379     0x0379	- (1232) 1238(b)
L380     0x0380	- (1295) 1437(b)
S397     0x0397	- (1329) 1327(b)
L2BINIT  0x03a6	- (1351) 1113(b) 1349(b)
BRGDONE  0x03aa	- (1358) 1114(b) 1350(b)
S3B5     0x03b5	- (1319) 1331(b) 1333(b)
S3B8     0x03b8	- (1332) 1323(b)
INIT     0x03c0	- (1369) 
S3C1     0x03c1	- (1370) 1378(b)
S3C4     0x03c4	- (1425) 1429(b)
L3E5     0x03e5	- (1433) 1297(b)
S3E8     0x03e8	- (1438) 1440(b)
L3ED     0x03ed	- (1415) 2910(b)
S3F4     0x03f4	- (1417) 1421(b)
L400     0x0400	- (1447) 2526(b)
ENDTURN  0x040f	- (1455) 1473(b) 1484(b) 1793(b) 1857(b) 2135(b) 2289(b) 2602(b) 2786(b) 2865(b) 3260(b)
L414     0x0414	- (1526) 2151(b)
NEWTURN  0x0417	- (1492) 1276(b) 1590(b)
S418     0x0418	- (1483) 1476(b)
S426     0x0426	- (1517) 1500(b) 1529(b)
S435     0x0435	- (1475) 1467(b)
L440     0x0440	- (1534) 1524(b)
S441     0x0441	- (1538) 1549(b) 1553(b) 1557(b) 1561(b) 1572(b)
DOBUTTN  0x0444	- (1612) 1564(b)
S446     0x0446	- (1594) 1580(c) 1582(c) 1584(c) 3715(c)
S44E     0x044e	- (1563) 1560(b)
DOCLEAR  0x0458	- (1579) 1481(b) 1571(b) 3469(b) 3626(b) 3902(b) 4099(b)
S46F     0x046f	- (1555) 1552(b)
S479     0x0479	- (1559) 1556(b)
S47D     0x047d	- (1551) 1548(b)
L480     0x0480	- (1637) 2346(b)
S48B     0x048b	- (1683) 1668(b)
S48E     0x048e	- (1665) 1679(b)
S494     0x0494	- (1724) 1702(c)
L4B7     0x04b7	- (1654) 1621(b)
L4C0     0x04c0	- (1735) 1712(b)
S4C8     0x04c8	- (1795) 1790(b)
S4CB     0x04cb	- (1771) 1766(b)
S4D3     0x04d3	- (1803) 1779(c) 1781(c) 1783(c)
L4EF     0x04ef	- (1750) 1722(b)
S4F8     0x04f8	- (1778) 1745(b) 1767(b)
L500     0x0500	- (1823) 1799(b)
L505     0x0505	- (1868) 3577(b)
S50F     0x050f	- (1830) 1824(b)
S514     0x0514	- (1915) 1907(b)
S519     0x0519	- (1906) 1898(b)
S523     0x0523	- (1878) 1838(b)
S529     0x0529	- (1889) 1879(b)
S52B     0x052b	- (1858) 1854(b)
KEYMISS  0x052c	- (1863) 3578(b)
S53A     0x053a	- (1856) 1859(b) 1874(b)
S53D     0x053d	- (1837) 1831(b)
SUBWARR  0x0540	- (1925) 1740(c) 2219(c) 2320(c) 3551(b)
SUBGOLD  0x0544	- (1995) 2202(c) 3547(b)
S54A     0x054a	- (2003) 2000(c)
S55D     0x055d	- (1954) 1966(b)
S567     0x0567	- (1949) 1958(b)
L569     0x0569	- (1985) 3312(b)
S56C     0x056c	- (1962) 1947(b)
ADDGOLD  0x0580	- (2017) 2272(c) 2751(c) 3559(b)
S588     0x0588	- (2078) 2051(b)
S58B     0x058b	- (2053) 2086(b)
S5A4     0x05a4	- (2074) 2056(b) 2065(b)
S5A5     0x05a5	- (2094) 2098(b)
CPY2TO5  0x05b2	- (2093) 476(c) 1655(c) 1929(c) 2030(c) 2204(c) 2404(c) 2658(c) 2691(c) 2712(c) 4289(b) 5478(c)
L5BB     0x05bb	- (2029) 1950(b)
DOMOVE   0x05c0	- (2109) 1826(b)
S5C6     0x05c6	- (2155) 2114(b)
S5EC     0x05ec	- (2139) 2124(b)
L600     0x0600	- (2192) 2187(b)
L617     0x0617	- (2225) 2176(b)
L640     0x0640	- (2268) 2264(b)
S652     0x0652	- (2326) 2305(b)
L65D     0x065d	- (2293) 2157(b)
L66A     0x066a	- (2342) 1629(b)
L66F     0x066f	- (2282) 2221(b)
L679     0x0679	- (2285) 2435(b)
SWPDWAR  0x0680	- (2353) 2210(c) 2217(c)
SWP4ND5  0x0682	- (2390) 2070(c) 2183(c) 2206(c) 3143(b)
ADDWARR  0x0686	- (2403) 2250(c) 2430(c) 2719(c) 3555(b)
S688     0x0688	- (2417) 2422(b)
S68B     0x068b	- (2392) 2397(b)
L68C     0x068c	- (2429) 2905(b)
ADDFOOD  0x068e	- (2374) 2776(c) 4154(c)
ROTDRM2  0x0694	- (2440) 1865(c) 1972(c) 2120(c) 2145(c) 2163(c) 2301(c) 2332(c) 2344(c)
CPY5TO1  0x06a4	- (2416) 1704(c) 2382(c)
L6B2     0x06b2	- (2431) 2322(b)
L6C0     0x06c0	- (2458) 2185(c) 2208(c) 3543(b) 5459(c)
S6CB     0x06cb	- (2490) 2476(b)
S6DD     0x06dd	- (2477) 2494(b)
S6E1     0x06e1	- (2485) 2483(b)
L6E5     0x06e5	- (2524) 2295(b)
S6E7     0x06e7	- (2475) 2500(b)
S6EC     0x06ec	- (2482) 2480(b)
S6EF     0x06ef	- (2469) 2467(b)
S6F1     0x06f1	- (2496) 2474(b)
SWPDGLD  0x06f6	- (2504) 2193(c) 2200(c)
S6FD     0x06fd	- (2466) 2464(b)
CPY5TO2  0x0700	- (2541) 1933(c) 2411(b)
S701     0x0701	- (2542) 2547(b)
SUBB10   0x0708	- (2615) 1666(c) 1700(c) 1764(c) 1931(c) 1998(c) 2063(c)
CALLDSP  0x0709	- (2623) 1472(c) 1646(c) 2286(c) 2600(c) 2784(c)
L70D     0x070d	- (2598) 1885(b)
S70E     0x070e	- (2566) 2570(b)
S70F     0x070f	- (2545) 
CPY0TO5  0x0717	- (2587) 574(c) 1996(c) 2018(c) 2061(c) 2181(c) 2730(c) 3539(b)
S718     0x0718	- (2577) 2581(b)
DOSANCT  0x0719	- (2631) 1833(b)
CPY5TO4  0x0727	- (2565) 439(b) 1108(b) 1756(c) 1760(c) 2032(c) 2036(c) 2059(c) 2717(c) 3153(b) 5509(b)
CPY1TO5  0x072c	- (2576) 495(c) 1698(c) 1762(c) 2375(c) 2762(c)
S72E     0x072e	- (2588) 2592(b)
ADDB10   0x0734	- (2607) 1508(c) 1754(c) 1758(c) 2020(c) 2034(c) 2195(c) 2212(c) 2377(c) 2406(c) 2664(c) 2684(c) 2697(c) 2743(c) 2768(c)
S73B     0x073b	- (2554) 2559(b)
CPY5TO0  0x073d	- (2553) 2002(b) 2025(c) 2072(c)
L740     0x0740	- (2647) 2639(b)
L74F     0x074f	- (2657) 2640(b)
S751     0x0751	- (2716) 2685(b)
S757     0x0757	- (2690) 2666(b)
S759     0x0759	- (2729) 2649(b) 2699(b) 2707(b)
S764     0x0764	- (2711) 2706(b)
L780     0x0780	- (2742) 2736(b)
S797     0x0797	- (2788) 2749(c) 2774(c)
CPYTRNC  0x079b	- (2802) 1502(c) 1513(c) 5473(c)
S7A1     0x07a1	- (2783) 2770(b)
LOAD99   0x07b1	- (2793) 1511(c) 2023(c) 2198(c) 2215(c) 2380(c) 2409(c) 2945(c)
L7B2     0x07b2	- (2820) 1990(b)
S7B7     0x07b7	- (2761) 2745(b)
PLYOPEN  0x07c0	- (2835) 3230(c)
S7C2     0x07c2	- (2866) 2858(b)
S7CB     0x07cb	- (2872) 2839(c) 2856(c)
S7CE     0x07ce	- (2856) 2863(b) 2867(b)
S7CF     0x07cf	- (2839) 2847(b)
L7D4     0x07d4	- (2907) 2825(b)
S7E4     0x07e4	- (2888) 2889(b)
L7E5     0x07e5	- (2902) 2340(b)
S7EF     0x07ef	- (2846) 2842(b)
S7F2     0x07f2	- (2898) 2845(b)
S7F4     0x07f4	- (2885) 2892(b) 2894(b)
PLYCLOS  0x07fc	- (2852) 3248(b)
S7FD     0x07fd	- (2843) 2841(b)
L800     0x0800	- (2925) 3253(c)
S80D     0x080d	- (2962) 2946(b) 2955(b) 2958(b)
S816     0x0816	- (2947) 2938(b)
S831     0x0831	- (2959) 2952(b)
L836     0x0836	- (2964) 3690(c)
L840     0x0840	- (2995) 2988(b) 3213(b)
S842     0x0842	- (3028) 3048(b)
S851     0x0851	- (3052) 3022(b)
KILLONE  0x0855	- (3064) 3028(c) 3179(c)
S85B     0x085b	- (3040) 3016(b)
S86B     0x086b	- (3017) 3043(b) 3047(b)
S87B     0x087b	- (3005) 3000(b) 3002(b)
L880     0x0880	- (3079) 3062(b)
LSWP4N5  0x0888	- (3140) 3102(c) 3130(c) 3133(c) 3503(c) 3507(c) 3512(c) 4082(c)
LSUMB10  0x0889	- (3145) 3092(c) 3132(c) 3134(c) 3135(c)
LCPBRIG  0x0895	- (3155) 2969(c) 3099(c) 3194(c)
S898     0x0898	- (3112) 3123(b)
LCP5TO4  0x0899	- (3150) 3088(c) 3098(c) 3131(c) 3481(c) 3500(c) 4037(c) 4043(c) 4078(c) 4084(c) 4140(c) 4159(c) 4185(b)
S8AF     0x08af	- (3090) 3096(b)
S8B9     0x08b9	- (3093) 3089(b)
L8C0     0x08c0	- (3170) 3138(b)
S8C6     0x08c6	- (3208) 3202(b)
S8C8     0x08c8	- (3218) 3187(c) 3196(c)
S8C9     0x08c9	- (3223) 3183(c) 3192(c)
L8D4     0x08d4	- (3234) 3339(c) 3597(c)
L8D9     0x08d9	- (3227) 1902(b)
S8ED     0x08ed	- (3212) 3207(b)
5TODSPB  0x08f4	- (3214) 2971(c) 3186(c) 3195(c) 4086(c) 4234(c)
S8FB     0x08fb	- (3181) 3176(b)
L8FE     0x08fe	- (3178) 3119(b)
L900     0x0900	- (3241) 3232(b)
L913     0x0913	- (3304) 2963(c) 3175(c)
S91A     0x091a	- (3293) 3288(b)
S91D     0x091d	- (3264) 3251(b) 3255(b)
LADDB10  0x092a	- (3317) 2940(c) 3828(c) 4041(c) 4076(c) 4183(c)
L932     0x0932	- (3309) 4192(b)
S936     0x0936	- (3290) 3295(b)
L937     0x0937	- (3252) 2533(b)
S939     0x0939	- (3257) 3291(b) 3341(b) 3535(b) 3684(b) 3694(b) 3983(b) 4170(b)
S93D     0x093d	- (3250) 3244(b)
L940     0x0940	- (3325) 3302(b)
S946     0x0946	- (3382) 3360(b)
S954     0x0954	- (3415) 3410(b)
S959     0x0959	- (3406) 3383(b)
L96F     0x096f	- (3345) 3301(b)
S973     0x0973	- (3352) 3327(b)
L97A     0x097a	- (3359) 3280(b)
S97B     0x097b	- (3340) 3378(b) 3390(b) 3402(b) 3411(b)
S97E     0x097e	- (3338) 3348(b) 3355(b)
L980     0x0980	- (3425) 3418(b)
S98E     0x098e	- (3443) 3440(b)
S998     0x0998	- (3450) 3471(b)
S9A9     0x09a9	- (3470) 3459(b)
S9AE     0x09ae	- (3458) 3455(b)
S9B2     0x09b2	- (3485) 3489(b)
S9B7     0x09b7	- (3435) 3441(b) 3456(b)
S9B8     0x09b8	- (3460) 3465(b)
L9C0     0x09c0	- (3497) 3493(b)
L9D1     0x09d1	- (3544) 3491(c) 4161(c)
L9D3     0x09d3	- (3548) 3069(b) 3508(c)
S9D8     0x09d8	- (3521) 3525(b)
S9E7     0x09e7	- (3513) 3518(b)
L9E9     0x09e9	- (3540) 3483(c) 3501(c)
L9EA     0x09ea	- (3556) 3267(c) 3526(c)
S9F2     0x09f2	- (3552) 3519(c) 4149(c)
L9F6     0x09f6	- (3536) 3479(c) 4057(c)
LA00     0x0a00	- (3567) 3789(b)
SA09     0x0a09	- (3636) 3590(b) 3643(b)
SA0B     0x0a0b	- (3609) 3646(b)
SA0C     0x0a0c	- (3639) 3637(b)
SA0E     0x0a0e	- (3594) 3642(b)
SA15     0x0a15	- (3645) 3629(b)
LA1E     0x0a1e	- (3586) 3675(b)
SA24     0x0a24	- (3628) 3622(b)
SA36     0x0a36	- (3621) 3615(b)
SA3A     0x0a3a	- (3596) 3619(b)
SA3D     0x0a3d	- (3582) 3568(b)
LA40     0x0a40	- (3658) 3650(b)
ROTDRM3  0x0a44	- (3726) 2974(c) 3366(c) 3394(c) 3430(c) 3699(c) 3973(c) 4244(c) 4264(c)
SA4C     0x0a4c	- (3731) 3688(c) 3716(c)
SA5D     0x0a5d	- (3688) 3667(b)
SA5E     0x0a5e	- (3679) 3662(b)
SA70     0x0a70	- (3698) 3692(b)
SA72     0x0a72	- (3733) 3738(b)
ROT7LFT  0x0a80	- (3750) 3830(c) 3837(c) 3846(c) 3910(c)
SA89     0x0a89	- (3841) 3850(b)
ROTPLYR  0x0a8f	- (3759) 3436(c) 3461(c) 3514(c)
LA94     0x0a94	- (3855) 3916(b)
LA98     0x0a98	- (3803) 1911(b)
CPY7TO5  0x0a9e	- (3775) 3510(c) 3855(c)
LAA7     0x0aa7	- (3782) 1918(b)
CPY5TO7  0x0abd	- (3767) 3505(c) 3829(c) 3845(c)
LAC0     0x0ac0	- (3865) 3857(b)
SAC4     0x0ac4	- (3945) 3905(b)
SAC8     0x0ac8	- (3941) 3936(b)
SAD8     0x0ad8	- (3904) 3895(b)
SADA     0x0ada	- (3935) 3930(b)
SADC     0x0adc	- (3915) 3933(b) 3939(b) 3943(b)
SADD     0x0add	- (3894) 3888(b)
SADF     0x0adf	- (3873) 3892(b) 4018(b)
SAE1     0x0ae1	- (3909) 3932(b) 3938(b) 3942(b)
SAF1     0x0af1	- (3926) 3914(b)
SAFC     0x0afc	- (3884) 
LAFE     0x0afe	- (3875) 4024(b)
SB00     0x0b00	- (3971) 3962(b) 3997(b) 4004(b) 4062(b)
LB06     0x0b06	- (4022) 3947(b)
SB16     0x0b16	- (4002) 3995(b)
LB24     0x0b24	- (4034) 4107(b)
SB2A     0x0b2a	- (4048) 4014(c) 4059(c)
SB30     0x0b30	- (4008) 3998(b)
SB34     0x0b34	- (4031) 4033(b)
LB3C     0x0b3c	- (3990) 3957(b) 3961(b)
LB40     0x0b40	- (4056) 4047(b)
SB50     0x0b50	- (4129) 4125(b) 4127(b)
SB53     0x0b53	- (4118) 4068(b)
SB5A     0x0b5a	- (4101) 4092(b)
SB64     0x0b64	- (4111) 4102(b)
SB68     0x0b68	- (4128) 4121(b)
SB6A     0x0b6a	- (4126) 4123(b)
SB70     0x0b70	- (4081) 4116(b) 4136(b)
LB80     0x0b80	- (4134) 4113(b)
LB86     0x0b86	- (4172) 3265(c)
LB89     0x0b89	- (4187) 5496(b)
SB8E     0x0b8e	- (4151) 4147(b)
SB94     0x0b94	- (4199) 4188(c)
SBA5     0x0ba5	- (4194) 4190(c)
LBAB     0x0bab	- (4156) 4130(b) 4150(b)
ROL5BY2  0x0bc0	- (4210) 4013(c) 4035(c) 4039(c) 4080(c) 4142(c) 4232(c)
ROL5BY4  0x0bcf	- (4217) 4045(c) 4157(c)
LBD4     0x0bd4	- (4286) 2934(c) 3085(c) 3185(c) 3498(c)
DSPWARE  0x0bde	- (4232) 3874(c) 4115(c)
SBE2     0x0be2	- (4272) 4250(b)
SBE3     0x0be3	- (4257) 4252(b) 4270(b)
LBE5     0x0be5	- (4282) 2928(c)
LRANDOM  0x0be6	- (4277) 2926(c) 3053(c) 3060(c) 3242(c) 3277(c) 3814(c) 3991(c) 4173(c)
SBEE     0x0bee	- (4253) 4271(b)
SBF6     0x0bf6	- (4262) 4241(b)
ROL5BY6  0x0bfd	- (4224) 3866(c) 4016(c) 4070(c) 4138(c) 4235(c)
PLAYBUF  0x0c00	- (4303) 4440(b) 4494(c) 4557(c) 4607(b) 4638(b) 4677(c) 4697(b) 4743(b) 4778(b) 4819(c) 4862(c) 4899(c) 4928(c) 4952(c) 4989(b) 5034(b) 5072(b) 5116(b) 5180(b) 5213(c) 5259(c) 5321(c) 5347(b) 5365(b) 5419(b) 5453(b)
LC08     0x0c08	- (4366) 4422(b)
PLYTHEM  0x0c0c	- (4378) 1272(c) 3705(c)
SC0F     0x0c0f	- (4307) 4369(b)
LC13     0x0c13	- (4372) 1642(c)
SC1C     0x0c1c	- (4343) 4344(b) 4346(b)
SC1D     0x0c1d	- (4323) 4362(b)
SC39     0x0c39	- (4319) 4358(b)
SC3A     0x0c3a	- (4325) 4311(b) 4315(b)
SC40     0x0c40	- (4396) 4416(b)
LC4D     0x0c4d	- (4445) 4388(b)
SC4F     0x0c4f	- (4400) 4420(b)
LC5F     0x0c5f	- (4405) 4317(b)
PLYTICK  0x0c6c	- (4427) 249(c)
SC7E     0x0c7e	- (4407) 4413(b)
LC80     0x0c80	- (4475) 4471(b)
LCC0     0x0cc0	- (4546) 4542(b)
PLAYEOT  0x0cd5	- (4612) 1488(c)
LD00     0x0d00	- (4621) 4617(b)
LD0C     0x0d0c	- (4679) 4713(b) 4865(b) 4901(b) 4930(b) 4954(b) 4962(b) 5262(b) 5380(b)
PLYBAZR  0x0d1d	- (4643) 3806(c)
SD22     0x0d22	- (4673) 4675(b)
SD29     0x0d29	- (4668) 4670(b)
LD40     0x0d40	- (4693) 4689(b)
SD4E     0x0d4e	- (4718) 4702(c) 4703(c) 4704(c) 4705(c) 4706(c)
SD5B     0x0d5b	- (4739) 4741(b)
PLYSANC  0x0d5f	- (4702) 2634(c)
SD61     0x0d61	- (4727) 4731(b)
SD64     0x0d64	- (4750) 4754(b)
SD66     0x0d66	- (4757) 4761(b)
SD69     0x0d69	- (4748) 4707(c) 4708(c) 4709(c) 4710(c) 4711(c)
SD6A     0x0d6a	- (4764) 4766(b)
SD78     0x0d78	- (4734) 4736(b)
SD7A     0x0d7a	- (4720) 4724(b)
LD80     0x0d80	- (4772) 4768(b)
SD83     0x0d83	- (4774) 4776(b)
SDB6     0x0db6	- (4815) 4817(b)
SDB8     0x0db8	- (4809) 4812(b)
PLYATTK  0x0dbe	- (4783) 3785(c)
LDC0     0x0dc0	- (4844) 4840(b)
PLYWINR  0x0dcc	- (4906) 3211(c)
PLYBUGL  0x0deb	- (4870) 2967(c)
SDEF     0x0def	- (4855) 4857(b)
LE00     0x0e00	- (4920) 4916(b)
SE0D     0x0e0d	- (4966) 4970(b)
SE12     0x0e12	- (4973) 4977(b)
SE13     0x0e13	- (4980) 4982(b)
SE23     0x0e23	- (4964) 4959(c) 4960(c)
SE25     0x0e25	- (4985) 4987(b)
PLYFRNT  0x0e2e	- (4959) 1842(c)
PLYLOSR  0x0e2f	- (4935) 3206(c) 4373(b)
PLYDRGN  0x0e40	- (5001) 2169(c)
SE42     0x0e42	- (5029) 5032(b)
SE59     0x0e59	- (5063) 5065(b)
SE6A     0x0e6a	- (5068) 5070(b)
SE6B     0x0e6b	- (5023) 5026(b)
SE73     0x0e73	- (5017) 5020(b)
PLYDSWD  0x0e78	- (5039) 2231(c)
SE7B     0x0e7b	- (5011) 5014(b)
SE7E     0x0e7e	- (5009) 5001(c) 5002(c) 5003(c) 5004(c) 5005(c) 5006(c) 5007(c)
LE80     0x0e80	- (5079) 5040(c)
SE98     0x0e98	- (5103) 5144(b)
LE9B     0x0e9b	- (5120) 5042(c)
SE9C     0x0e9c	- (5111) 5114(b)
SEA1     0x0ea1	- (5105) 5108(b)
PLYFAIL  0x0ec0	- (5153) 1871(c) 2131(c) 3682(c) 3979(c)
PLYDETH  0x0ec5	- (5185) 1744(c) 1978(c) 2312(c) 3034(c)
SEC6     0x0ec6	- (5193) 5196(b)
SED7     0x0ed7	- (5187) 5190(b)
SEDD     0x0edd	- (5171) 5173(b)
SEE6     0x0ee6	- (5209) 5211(b)
SEEC     0x0eec	- (5176) 5178(b)
SEFC     0x0efc	- (5166) 5168(b)
LF00     0x0f00	- (5225) 5221(b)
PLYPEGA  0x0f0d	- (5267) 3372(c)
SF17     0x0f17	- (5255) 5257(b)
LF40     0x0f40	- (5297) 5293(b)
SF42     0x0f42	- (5325) 5327(b)
PLYBEEP  0x0f49	- (5352) 856(c) 1450(c) 5371(b)
LF80     0x0f80	- (5370) 3226(b)
PLWFOOD  0x0f83	- (5376) 1774(c)
SF8A     0x0f8a	- (5438) 5441(b)
SF93     0x0f93	- (5432) 5435(b)
SF9B     0x0f9b	- (5415) 5417(b)
SFA4     0x0fa4	- (5426) 5429(b)
PLYCLR   0x0fa9	- (5424) 1588(c)
SFB8     0x0fb8	- (5410) 5412(b)
SFBE     0x0fbe	- (5384) 5376(c) 5377(c) 5378(c)
LFC0     0x0fc0	- (5448) 5444(b) 5518(b)
SFC1     0x0fc1	- (5449) 5451(b)
SFD4     0x0fd4	- (5516) 5519(b)
SFE2     0x0fe2	- (5498) 5465(c) 5481(c) 5483(c)
SFE5     0x0fe5	- (5506) 5455(c) 5474(c) 5480(c) 5482(c) 5484(c)
SFE6     0x0fe6	- (5502) 5460(c) 5479(c)
LFFF     0x0fff	- (5455) 3724(b)
